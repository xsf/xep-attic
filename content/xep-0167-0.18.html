<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0167: Jingle Audio via RTP</title><link rel="stylesheet" type="text/css" href="/xmpp.css" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><meta name="DC.Title" content="Jingle Audio via RTP" /><meta name="DC.Creator" content="Scott Ludwig" /><meta name="DC.Creator" content="Peter Saint-Andre" /><meta name="DC.Creator" content="Sean Egan" /><meta name="DC.Creator" content="Robert McQueen" /><meta name="DC.Description" content="This specification defines a Jingle application type for negotiating a voice chat or other audio session. The application type uses the Real-time Transport Protocol (RTP) for the underlying media exchange and provides a straightforward mapping to Session Description Protocol (SDP) for interworking with SIP media endpoints." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2008-05-28" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0167" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF)." /></head><body><h1>XEP-0167: Jingle Audio via RTP</h1><p>This specification defines a Jingle application type for negotiating a voice chat or other audio session. The application type uses the Real-time Transport Protocol (RTP) for the underlying media exchange and provides a straightforward mapping to Session Description Protocol (SDP) for interworking with SIP media endpoints.</p><hr /><p style="color:red">NOTICE: This document is currently within Last Call or under consideration by the XMPP Council for advancement to the next stage in the XSF standards process.</p><hr /><h2>Document Information</h2><p class="indent">
            Series: <a href="http://www.xmpp.org/extensions/">XEP</a><br />
            Number: 0167<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status: 
            <a href="http://www.xmpp.org/extensions/xep-0001.html#states-Proposed">Proposed</a><br />
            Type:
            <a href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.18<br />
            Last Updated: 2008-05-28<br />
                Approving Body: <a href="http://www.xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XEP-0166<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: NOT_YET_ASSIGNED<br />
              Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Jingle Audio via RTP (XEP-0167)">http://wiki.jabber.org/index.php/Jingle Audio via RTP (XEP-0167)</a>&gt;
            </p><hr /><h2>Author Information</h2><div class="indent"><h3>Scott Ludwig</h3><p class="indent">
        Email:
        <a href="mailto:scottlu@google.com">scottlu@google.com</a><br />
        JabberID: 
        <a href="xmpp:scottlu@google.com">scottlu@google.com</a><br /></p><h3>Peter Saint-Andre</h3><p class="indent">
        JabberID: 
        <a href="xmpp:stpeter@jabber.org">stpeter@jabber.org</a><br />
        URI: 
        <a href="https://stpeter.im/">https://stpeter.im/</a><br /></p><h3>Sean Egan</h3><p class="indent">
        Email:
        <a href="mailto:seanegan@google.com">seanegan@google.com</a><br />
        JabberID: 
        <a href="xmpp:seanegan@google.com">seanegan@google.com</a><br /></p><h3>Robert McQueen</h3><p class="indent">
        Email:
        <a href="mailto:robert.mcqueen@collabora.co.uk">robert.mcqueen@collabora.co.uk</a><br />
        JabberID: 
        <a href="xmpp:robert.mcqueen@collabora.co.uk">robert.mcqueen@collabora.co.uk</a><br /></p></div><hr /><h2>Legal Notices</h2><div class="indent"><h3>Copyright</h3>This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF).<h3>Permissions</h3>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h3>Disclaimer of Warranty</h3><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. In no event shall the XMPP Standards Foundation or the authors of this Specification be liable for any claim, damages, or other liability, whether in an action of contract, tort, or otherwise, arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification. ##</span><h3>Limitation of Liability</h3>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising out of the use or inability to use the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h3>IPR Conformance</h3>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which may be found at &lt;<a href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt; or obtained by writing to XSF, P.O. Box 1641, Denver, CO 80201 USA).</div><hr /><h2>Discussion Venue</h2><p class="indent">The preferred venue for discussion of this document is the Standards discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">http://mail.jabber.org/mailman/listinfo/standards</a>&gt;.</p><p class="indent">Errata may be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><h2>Relation to XMPP</h2><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><h2>Conformance Terms</h2><p class="indent">The following keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#intro">Introduction</a><br />2.  <a href="#reqs">Requirements</a><br />3.  <a href="#conformance">Jingle Conformance</a><br />4.  <a href="#format">Application Format</a><br />5.  <a href="#negotiation">Negotiating a Jingle Audio Session</a><br />6.  <a href="#sdp">Mapping to Session Description Protocol</a><br />7.  <a href="#info">Informational Messages</a><br />   
      7.1.  <a href="#info-format">Format</a><br />   
      7.2.  <a href="#info-examples">Examples</a><br />8.  <a href="#support">Determining Support</a><br />9.  <a href="#scenarios">Scenarios</a><br />   
      9.1.  <a href="#scenarios-busy">Responder is Busy</a><br />   
      9.2.  <a href="#scenarios-voicechat">Jingle Audio via RTP/AVP, Negotiated with ICE-UDP</a><br />   
      9.3.  <a href="#scenarios-audiovideo">Jingle Audio and Video via RTP/AVP, Negotiated with ICE-UDP</a><br />   
      9.4.  <a href="#scenarios-secure">Secure Jingle Audio via UDP/TLS/RTP/SAVP, Negotiated with ICE-UDP</a><br />10.  <a href="#impl">Implementation Notes</a><br />   
      10.1.  <a href="#impl-codecs">Codecs</a><br />   
      10.2.  <a href="#impl-dtmf">DTMF</a><br />   
      10.3.  <a href="#impl-listen">When to Listen</a><br />11.  <a href="#security">Security Considerations</a><br />12.  <a href="#iana">IANA Considerations</a><br />13.  <a href="#registrar">XMPP Registrar Considerations</a><br />   
      13.1.  <a href="#ns">Protocol Namespaces</a><br />   
      13.2.  <a href="#registrar-content">Jingle Application Formats</a><br />14.  <a href="#schema">XML Schemas</a><br />   
      14.1.  <a href="#schema-content">Application Format</a><br />   
      14.2.  <a href="#schema-info">Informational Messages</a><br /><a href="#notes">Notes</a><br /><a href="#revs">Revision History</a></p></div><hr /><h2>1.
       <a name="intro" id="intro">Introduction</a></h2>
  <p class="" style=""><span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0166.html">Jingle</a></span>  [<a href="#nt-id2251655">1</a>] can be used to initiate and negotiate a wide range of peer-to-peer sessions. One session type of interest is audio chat. This document specifies an application format for negotiating Jingle audio sessions, where the media is exchanged over the Realtime Transport Protocol (RTP; see <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc3550">RFC 3550</a></span>  [<a href="#nt-id2251687">2</a>]).</p>
<h2>2.
       <a name="reqs" id="reqs">Requirements</a></h2>
  <p class="" style="">The Jingle application format defined herein is designed to meet the following requirements:</p>
  <ol start="" class="" style="">
    <li class="" style="">Enable negotiation of parameters necessary for audio chat over Realtime Transport Protocol (RTP).</li>
    <li class="" style="">Map these parameters to Session Description Protocol (SDP; see <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc4566">RFC 4566</a></span>  [<a href="#nt-id2251734">3</a>]) to enable interoperability.</li>
    <li class="" style="">Define informational messages related to audio chat (e.g., ringing, on hold, on mute).</li>
  </ol>
<h2>3.
       <a name="conformance" id="conformance">Jingle Conformance</a></h2>
   <p class="" style="">In accordance with Section 8 of <span class="ref">XEP-0166</span>, this document specifies the following information related to the Jingle Audio via RTP application type:</p>
   <ol start="" class="" style="">
     <li class="" style=""><p class="" style="">The application format negotiation process is defined in the <a href="#negotiation">Negotiating a Jingle Audio Session</a> section of this document.</p></li>
     <li class="" style=""><p class="" style="">The semantics of the &lt;description/&gt; element are defined in the <a href="#format">Application Format</a> section of this document.</p></li>
     <li class="" style=""><p class="" style="">A mapping of Jingle semantics to the Session Description Protocol is provided in the <a href="#sdp">Mapping to Session Description Protocol</a> section of this document.</p></li>
     <li class="" style=""><p class="" style="">A Jingle audio session SHOULD use a lossy transport method such as <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0177.html">Jingle Raw UDP Transport Method </a></span>  [<a href="#nt-id2261721">4</a>] or the "ice-udp" method specified in <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0176.html">Jingle ICE-UDP Transport Method</a></span>  [<a href="#nt-id2261748">5</a>], but MAY use a reliable transport such as "ice-tcp" if a low-bandwidth codec is employed.</p></li>
     <li class="" style="">
       <p class="" style="">Content is to be sent and received as follows:</p>
       <ul class="" style="">
         <li class="" style=""><p class="" style="">For lossy transports, outbound audio content shall be encoded into RTP packets and each packet shall be sent individually over the transport. Each inbound packet received over the transport is an RTP packet.</p></li>
         <li class="" style=""><p class="" style="">For reliable transports, outbound audio content shall be encoded into RTP packets and each packet data shall be sent in succession over the transport. Incoming data received over the transport shall be processed as a stream of RTP packets, where each RTP packet boundary marks the location of the next packet.</p></li>
       </ul>
     </li>
   </ol>
<h2>4.
       <a name="format" id="format">Application Format</a></h2>
  <p class="" style="">A Jingle audio session is described by a content type that contains one application format and one transport method. The application format consists of one or more encodings contained within a wrapper &lt;description/&gt; element qualified by the 'urn:xmpp:tmp:jingle:apps:audio-rtp' namespace (see <a href="#ns">Protocol Namespaces</a> regarding issuance of one or more permanent namespaces). In the language of <span class="ref">RFC 4566</span> each encoding is a payload-type; therefore, each &lt;payload-type/&gt; element specifies an encoding that can be used for the audio stream, as illustrated in the following example.</p>
  <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Audio description format</p><div class="indent"><pre>
    &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp'&gt;
      &lt;payload-type id='96' name='speex' clockrate='16000'/&gt;
      &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
      &lt;payload-type id='18' name='G729'/&gt;
      &lt;payload-type id='103' name='L16' clockrate='16000' channels='2'/&gt;
      &lt;payload-type id='98' name='x-ISAC' clockrate='8000'/&gt;
      &lt;payload-type id='102' name='iLBC'/&gt;
      &lt;payload-type id='4' name='G723'/&gt;
      &lt;payload-type id='0' name='PCMU' clockrate='16000'/&gt;
      &lt;payload-type id='8' name='PCMA'/&gt;
      &lt;payload-type id='13' name='CN'/&gt;
    &lt;/description&gt;
  </pre></div>
  <p class="" style="">The &lt;description/&gt; element is intended to be a child of a &lt;content/&gt; element as specified in <span class="ref">XEP-0166</span>.</p>
  <p class="" style="">The &lt;description/&gt; element SHOULD possess a 'profile' attribute that specifies the profile of RTP in use as would be encapsulated in SDP (e.g., "RTP/AVP" or "UDP/TLS/RTP/SAVP").</p>
  <p class="" style="">The encodings SHOULD be provided in order of preference by placing the most-preferred &lt;payload-type/&gt; element as the first child of the &lt;description/&gt; element (etc.).</p>
  <p class="" style="">The allowable attributes of the &lt;payload-type/&gt; element are as follows:</p>
  <p class="caption"><a name="table-1" id="table-1"></a>Table 1: Payload-Type Attributes</p><table border="1" cellpadding="3" cellspacing="0">
    <tr class="body">
      <th colspan="" rowspan="">Attribute</th>
      <th colspan="" rowspan="">Description</th>
      <th colspan="" rowspan="">Datatype</th>
      <th colspan="" rowspan="">Inclusion</th>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">channels</td>
      <td colspan="" rowspan="">The number of channels; if omitted, it MUST be assumed to contain one channel</td>
      <td colspan="" rowspan="">positiveInteger (defaults to 1)</td>
      <td colspan="" rowspan="">RECOMMENDED</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">clockrate</td>
      <td colspan="" rowspan="">The sampling frequency in Hertz</td>
      <td colspan="" rowspan="">positiveInteger</td>
      <td colspan="" rowspan="">RECOMMENDED</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">id</td>
      <td colspan="" rowspan="">The payload identifier</td>
      <td colspan="" rowspan="">positiveInteger</td>
      <td colspan="" rowspan="">REQUIRED</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">maxptime</td>
      <td colspan="" rowspan="">Maximum packet time as specified in RFC 4566</td>
      <td colspan="" rowspan="">positiveInteger</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">name</td>
      <td colspan="" rowspan="">The appropriate subtype of the audio MIME type</td>
      <td colspan="" rowspan="">string</td>
      <td colspan="" rowspan="">RECOMMENDED for static payload types, REQUIRED for dynamic payload types</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">ptime</td>
      <td colspan="" rowspan="">Packet time as specified in RFC 4566</td>
      <td colspan="" rowspan="">positiveInteger</td>
      <td colspan="" rowspan="">OPTIONAL</td>
    </tr>
  </table>
  <p class="" style="">In Jingle Audio, the encodings are used in the context of RTP. The most common encodings for the Audio/Video Profile (AVP) of RTP are listed in <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc3551">RFC 3551</a></span>  [<a href="#nt-id2262172">6</a>] (these "static" types are reserved from payload ID 0 through payload ID 95), although other encodings are allowed (these "dynamic" types use payload IDs 96 to 127) in accordance with the dynamic assignment rules described in Section 3 of <span class="ref">RFC 3551</span>. The payload IDs are represented in the 'id' attribute.</p>
  <p class="" style="">Each &lt;payload-type/&gt; element MAY contain one or more child elements that specify particular parameters related to the payload. For example, as described in <span class="ref" style=""><a href="http://tools.ietf.org/html/draft-ietf-avt-rtp-speex">RTP Payload Format for the Speex Codec</a></span>  [<a href="#nt-id2262226">7</a>], the "cng", "mode", and "vbr" parameters may be specified in relation to usage of the Speex  [<a href="#nt-id2262160">8</a>] codec. Where such parameters are encoded via the "fmtp" SDP attribute, they shall be represented in Jingle via the following format:</p>
  <p class="caption"></p><div class="indent"><pre>
&lt;parameter name='foo' value='bar'/&gt;
  </pre></div>
  <p class="" style="">Note: The parameter names are effectively guaranteed to be unique, since the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-id2262274">9</a>] maintains a registry of SDP parameters (see &lt;<a href="http://www.iana.org/assignments/sdp-parameters">http://www.iana.org/assignments/sdp-parameters</a>&gt;).</p>
<h2>5.
       <a name="negotiation" id="negotiation">Negotiating a Jingle Audio Session</a></h2>
  <p class="" style="">When the initiator sends a session-initiate stanza to the responder, the &lt;description/&gt; element includes all of the payload types that the initiator can receive for Jingle audio (each one encapsulated in a separate &lt;payload-type/&gt; element):</p>
  <p class="caption"><a name="example-2" id="example-2"></a>Example 2. Initiation</p><div class="indent"><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='jingleaudio1'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'&gt;
          action='session-initiate'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='96' name='speex' clockrate='16000'/&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='103' name='L16' clockrate='16000' channels='2'/&gt;
        &lt;payload-type id='98' name='x-ISAC' clockrate='8000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="" style="">Upon receiving the session-initiate stanza, the responder determines whether it can proceed with the negotiation. The general Jingle error cases are specified in <span class="ref">XEP-0166</span> and illustrated in the <a href="#scenarios">Scenarios</a> section of this document.</p>
  <p class="" style="">If there is no error, the responder acknowledges the session initiation request.</p>
  <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Responder acknowledges session-initiate</p><div class="indent"><pre>
  &lt;iq from='juliet@capulet.com/balcony'
      id='jingleaudio1'
      to='romeo@montague.net/orchard'
      type='result'/&gt;
  </pre></div>
  <p class="" style="">If the responder wishes to accept the session, it MUST send a content-accept action to the initiator, which SHOULD include a list of the payload types that it can receive. The list that the responder sends MAY include any payload types (not a subset of the payload types sent by the initiator) but SHOULD retain the ID numbers specified by the initiator. The order of the &lt;payload-type/&gt; elements indicates the responder's preferences, with the most-preferred types first.</p>
  <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Responder accepts content type</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='jingleaudio2'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'&gt;
          action='content-accept'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp'&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='0' name='PCMU' /&gt;
        &lt;payload-type id='102' name='iLBC'/&gt;
        &lt;payload-type id='4' name='G723'/&gt;
        &lt;payload-type id='8' name='PCMA'/&gt;
        &lt;payload-type id='13' name='CN'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="" style="">The initiator acknowledges the content-accept action:</p>
  <p class="caption"><a name="example-5" id="example-5"></a>Example 5. Initiator acknowledges modified application format</p><div class="indent"><pre>
  &lt;iq from='romeo@montegue.net/orchard'
      id='jingleaudio2'
      to='juliet@capulet.com/balcony'
      type='result'/&gt;
  </pre></div>
  <p class="" style="">After successful transport negotiation (not shown here), the responder then accepts the session:</p>
  <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Responder definitively accepts the session</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='accept1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-accept'
          initiator='romeo@montague.net/orchard'
          responder='juliet@capulet.com/balcony'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='0' name='PCMU' /&gt;
        &lt;payload-type id='102' name='iLBC'/&gt;
        &lt;payload-type id='4' name='G723'/&gt;
        &lt;payload-type id='8' name='PCMA'/&gt;
        &lt;payload-type id='13' name='CN'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'&gt;
        &lt;candidate component='1'
                   foundation='1'
                   generation='0'
                   ip='192.0.2.3'
                   network='1'
                   port='45664'
                   priority='1678246398'
                   protocol='udp'
                   pwd='asd88fgpdd777uzjYhagZg'
                   type='srflx'
                   ufrag='8hhy'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="" style="">And the initiator acknowledges session acceptance:</p>
  <p class="caption"><a name="example-7" id="example-7"></a>Example 7. Initiator acknowledges session acceptance</p><div class="indent"><pre>
  &lt;iq from='romeo@montague.net/orchard'
      id='accept1'
      to='juliet@capulet.com/balcony'
      type='result'/&gt;
  </pre></div>
<h2>6.
       <a name="sdp" id="sdp">Mapping to Session Description Protocol</a></h2>
  <p class="" style="">The SDP media type for Jingle Audio via RTP is "audio" (see Section 8.2.1 of <span class="ref">RFC 4566</span>).</p>
  <p class="" style="">If the payload type is static (payload-type IDs 0 through 95 inclusive), it MUST be mapped to a media field defined in <span class="ref">RFC 4566</span>. The generic format for the media field is as follows:</p>
  <p class="caption"></p><div class="indent"><pre>
m=&lt;media&gt; &lt;port&gt; &lt;transport&gt; &lt;fmt list&gt;
  </pre></div>
  <p class="" style="">In the context of Jingle audio sessions, the &lt;media&gt; is "audio", the &lt;port&gt; is the preferred port for such communications (which may be determined dynamically), the &lt;transport&gt; is whatever profile is negotiated via the 'profile' attribute of the &lt;content/&gt; element in the Jingle negotiation (e.g., "RTP/AVP"), and the &lt;fmt list&gt; is the payload-type ID.</p>
  <p class="" style="">For example, consider the following static payload-type:</p>
  <p class="caption"><a name="example-8" id="example-8"></a>Example 8. Jingle format for static payload-type</p><div class="indent"><pre>
&lt;payload-type id="13" name="CN"/&gt;
  </pre></div>
  <p class="" style="">That Jingle-formatted information would be mapped to SDP as follows:</p>
  <p class="caption"><a name="example-9" id="example-9"></a>Example 9. SDP mapping of static payload-type</p><div class="indent"><pre>
m=audio 9999 RTP/AVP 13
  </pre></div>
  <p class="" style="">If the payload type is dynamic (payload-type IDs 96 through 127 inclusive), it SHOULD be mapped to an SDP media field plus an SDP attribute field named "rtpmap".</p>
  <p class="" style="">For example, consider a payload of 16-bit linear-encoded stereo audio sampled at 16KHz associated with dynamic payload-type 96:</p>
  <p class="caption"><a name="example-10" id="example-10"></a>Example 10. Jingle format for dynamic payload-type</p><div class="indent"><pre>
&lt;payload-type id='96' name='speex' clockrate='16000'/&gt;
  </pre></div>
  <p class="" style="">That Jingle-formatted information would be mapped to SDP as follows:</p>
  <p class="caption"><a name="example-11" id="example-11"></a>Example 11. SDP mapping of dynamic payload-type</p><div class="indent"><pre>
m=audio 9999 RTP/AVP 96
a=rtpmap:96 speex/16000
  </pre></div>
  <p class="" style="">As noted, if additional parameters are to be specified, they shall be represented as attributes of the &lt;parameter/&gt; child of the &lt;payload-type/&gt; element, as in the following example.</p>
  <p class="caption"><a name="example-12" id="example-12"></a>Example 12. Jingle format for dynamic payload-type with parameters</p><div class="indent"><pre>
&lt;payload-type id='96' name='speex' clockrate='16000' ptime='40'&gt;
  &lt;parameter name='vbr' value='on'/&gt;
  &lt;parameter name='cng' value='on'/&gt;
&lt;/payload-type&gt;
  </pre></div>
  <p class="" style="">That Jingle-formatted information would be mapped to SDP as follows:</p>
  <p class="caption"><a name="example-13" id="example-13"></a>Example 13. SDP mapping of dynamic payload-type with parameters</p><div class="indent"><pre>
m=audio 9999 RTP/AVP 96
a=rtpmap:96 speex/16000
a=ptime:40
a=fmtp:96 vbr=on;cng=on
  </pre></div>
<h2>7.
       <a name="info" id="info">Informational Messages</a></h2>
  <div class="indent"><h3>7.1 <a name="info-format" id="info-format">Format</a></h3>
    <p class="" style="">Informational messages may be sent by either party within the context of Jingle to communicate the status of a Jingle audio session, device, or principal. The informational message MUST be an IQ-set containing a &lt;jingle/&gt; element of type "session-info", where the informational message is a payload  element qualified by the 'urn:xmpp:tmp:jingle:apps:audio-rtp:info' namespace; the following payload elements are defined:  [<a href="#nt-id2262812">10</a>]</p>
    <p class="caption"><a name="table-2" id="table-2"></a>Table 2: Information Payload Elements</p><table border="1" cellpadding="3" cellspacing="0">
      <tr class="body">
        <th colspan="" rowspan="">Element</th>
        <th colspan="" rowspan="">Meaning</th>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">&lt;active/&gt;</td>
        <td colspan="" rowspan="">The principal or device is again actively participating in the session after having been on hold or on mute.</td>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">&lt;hold/&gt;</td>
        <td colspan="" rowspan="">The principal is temporarily pausing the chat (i.e., putting the other party on hold).</td>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">&lt;mute/&gt;</td>
        <td colspan="" rowspan="">The principal is temporarily stopping audio output but continues to accept audio input.</td>
      </tr>
      <tr class="body">
        <td colspan="" rowspan="">&lt;ringing/&gt;</td>
        <td colspan="" rowspan="">The device is ringing but the principal has not yet interacted with it to answer (this maps to the SIP 180 response code).</td>
      </tr>
    </table>
    <p class="" style="">Note: Because the informational message is sent in an IQ-set, the receiving party MUST return either an IQ-result or an IQ-error (normally only an IQ-result to acknowledge receipt; no error flows are defined or envisioned at this time).</p>
  </div>
  <div class="indent"><h3>7.2 <a name="info-examples" id="info-examples">Examples</a></h3>
    <p class="caption"><a name="example-14" id="example-14"></a>Example 14. Responder sends active message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='active1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'&gt;
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;active xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-15" id="example-15"></a>Example 15. Responder sends hold message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hold1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;hold xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-16" id="example-16"></a>Example 16. Responder sends mute message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='mute1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;mute xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-17" id="example-17"></a>Example 17. Responder sends ringing message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='ringing1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;ringing xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
<h2>8.
       <a name="support" id="support">Determining Support</a></h2>
  <p class="" style="">If an entity supports Jingle audio exchanges via RTP, it MUST advertise that fact by returning a feature of "urn:xmpp:tmp:jingle:apps:audio-rtp" (see <a href="#ns">Protocol Namespaces</a> regarding issuance of one or more permanent namespaces) in response to <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0030.html">Service Discovery</a></span>  [<a href="#nt-id2263046">11</a>] information requests.</p>
  <p class="caption"><a name="example-18" id="example-18"></a>Example 18. Service discovery information request</p><div class="indent"><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='disco1'
    to='juliet@capulet.com/balcony'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="caption"><a name="example-19" id="example-19"></a>Example 19. Service discovery information response</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='disco1'
    to='romeo@montague.net/orchard'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    ...
    &lt;feature var='urn:xmpp:tmp:jingle'/&gt;
    &lt;feature var='urn:xmpp:tmp:jingle:apps:audio-rtp'/&gt;
    ...
  &lt;/query&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="" style="">Naturally, support MAY also be determined via the dynamic, presence-based profile of Service Discovery defined in <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0115.html">Entity Capabilities</a></span>  [<a href="#nt-id2263101">12</a>].</p>
<h2>9.
       <a name="scenarios" id="scenarios">Scenarios</a></h2>
  <p class="" style="">The following sections show a number of Jingle audio scenarios, in relative order of complexity.</p>
  <div class="indent"><h3>9.1 <a name="scenarios-busy" id="scenarios-busy">Responder is Busy</a></h3>
    <p class="" style="">In this scenario, Romeo initiates a voice chat with Juliet but she is otherwise engaged.</p>
    <p class="" style="">The session flow is as follows:</p>
    <p class="caption"></p><div class="indent"><pre>
Romeo                         Juliet
  |                             |
  |   session-initiate          |
  |----------------------------&gt;|
  |   ack                       |
  |&lt;----------------------------|
  |   session-info (ringing)    |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   terminate                 |
  |   (reason = busy)           |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |                             |
    </pre></div>
    <p class="" style="">The protocol flow is as follows.</p>
    <p class="caption"><a name="example-20" id="example-20"></a>Example 20. Initiator sends session-initiate</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='jingle1'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-initiate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='96' name='speex' clockrate='16000'/&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='103' name='L16' clockrate='16000' channels='2'/&gt;
        &lt;payload-type id='98' name='x-ISAC' clockrate='8000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-21" id="example-21"></a>Example 21. Responder sends provisional acceptance</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='accept1'
    to='romeo@montague.lit/orchard'
    type='result'/&gt;
    </pre></div>
    <p class="caption"><a name="example-22" id="example-22"></a>Example 22. Responder sends ringing message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='ringing1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;ringing xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-23" id="example-23"></a>Example 23. Initiator acknowledges ringing message</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='ringing1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="caption"><a name="example-24" id="example-24"></a>Example 24. Responder terminates the session</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='term1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;
      &lt;condition&gt;&lt;busy/&gt;&lt;/condition&gt;
      &lt;text&gt;No time to chat right now!&lt;/text&gt;
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The other party then acknowledges termination of the session:</p>
    <p class="caption"><a name="example-25" id="example-25"></a>Example 25. Initiator acknowledges termination</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='term1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>9.2 <a name="scenarios-voicechat" id="scenarios-voicechat">Jingle Audio via RTP/AVP, Negotiated with ICE-UDP</a></h3>
    <p class="" style="">In this scenario, Romeo initiates a voice chat with Juliet using a transport method of ICE-UDP. The parties also exchange informational messages.</p>
    <p class="" style="">The session flow is as follows:</p>
    <p class="caption"></p><div class="indent"><pre>
Romeo                         Juliet
  |                             |
  |   session-initiate          |
  |----------------------------&gt;|
  |   ack                       |
  |&lt;----------------------------|
  |   session-info (ringing)    |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   transport-info (X times)  |
  |   (with acks)               |
  |&lt;---------------------------&gt;|
  |   STUN connectivity checks  |
  |&lt;---------------------------&gt;|
  |   session-accept            |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   AUDIO (RTP)               |
  |&lt;===========================&gt;|
  |   session-terminate         |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |                             |
    </pre></div>
    <p class="" style="">The protocol flow is as follows.</p>
    <p class="caption"><a name="example-26" id="example-26"></a>Example 26. Initiator sends session-initiate</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='jingle1'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-initiate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='96' name='speex' clockrate='16000'/&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='103' name='L16' clockrate='16000' channels='2'/&gt;
        &lt;payload-type id='98' name='x-ISAC' clockrate='8000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-27" id="example-27"></a>Example 27. Responder sends provisional acceptance</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='accept1'
    to='romeo@montague.lit/orchard'
    type='result'/&gt;
    </pre></div>
    <p class="caption"><a name="example-28" id="example-28"></a>Example 28. Responder sends ringing message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='ringing1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;ringing xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-29" id="example-29"></a>Example 29. Initiator acknowledges ringing message</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='ringing1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">Because the parties have chosen the Jingle ICE-UDP Transport Method, the initiator and responder exchange an open-ended number of possible candidate transports, perform connectivity checks, and agree upon a candidate transport as explained in <span class="ref">XEP-0176</span>. Once ICE negotiation is completed, the responder sends a session-accept action to the initiator.</p>
    <p class="caption"><a name="example-30" id="example-30"></a>Example 30. Responder sends session-accept</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='accept1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-accept'
          initiator='romeo@montague.lit/orchard'
          responder='juliet@capulet.lit/balcony'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='0' name='PCMU' /&gt;
        &lt;payload-type id='102' name='iLBC'/&gt;
        &lt;payload-type id='4' name='G723'/&gt;
        &lt;payload-type id='8' name='PCMA'/&gt;
        &lt;payload-type id='13' name='CN'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'&gt;
        &lt;candidate component='1'
                   foundation='1'
                   generation='0'
                   ip='192.0.2.3'
                   network='1'
                   port='45664'
                   priority='1694498815'
                   protocol='udp'
                   pwd='asd88fgpdd777uzjYhagZg'
                   rel-addr='10.0.1.1'
                   rel-port='8998'
                   rem-addr='192.0.2.1'
                   rem-port='3478'
                   type='srflx'
                   ufrag='8hhy'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If the payload types and transport candidate can be successfully used by both parties, then the initiator acknowledges the session-accept action.</p>
    <p class="caption"><a name="example-31" id="example-31"></a>Example 31. Initiator acknowledges session-accept</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='accept1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">The parties now begin to exchange media. In this case they would exchange audio using the Speex codec at a clockrate of 8000 since that is the highest-priority codec for the responder (as determined by the XML order of the &lt;payload-type/&gt; children).</p>
    <p class="" style="">The parties may continue the session as long as desired.</p>
    <p class="" style="">Eventually, one of the parties terminates the session.</p>
    <p class="caption"><a name="example-32" id="example-32"></a>Example 32. Responder terminates the session</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='term1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;
      &lt;condition&gt;&lt;no-error/&gt;&lt;/condition&gt;
      &lt;text&gt;Sorry, gotta go!&lt;/text&gt;
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The other party then acknowledges termination of the session:</p>
    <p class="caption"><a name="example-33" id="example-33"></a>Example 33. Initiator acknowledges termination</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='term1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>9.3 <a name="scenarios-audiovideo" id="scenarios-audiovideo">Jingle Audio and Video via RTP/AVP, Negotiated with ICE-UDP</a></h3>
    <p class="" style="">In this scenario, Romeo initiates a combined audio and video chat with Juliet using a transport method of ICE-UDP. Juliet at first refuses the video portion, then later offers to add video, which Romeo accepts. The parties also exchange various informational messages</p>
    <p class="" style="">The session flow is as follows:</p>
    <p class="caption"></p><div class="indent"><pre>
Romeo                         Juliet
  |                             |
  |   session-initiate          |
  |----------------------------&gt;|
  |   ack                       |
  |&lt;----------------------------|
  |   session-info (ringing)    |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   content-remove            |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   transport-info (X times)  |
  |   (with acks)               |
  |&lt;---------------------------&gt;|
  |   STUN connectivity checks  |
  |&lt;---------------------------&gt;|
  |   session-accept            |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   AUDIO (RTP)               |
  |&lt;===========================&gt;|
  |   session-info (hold)       |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   session-info (active)     |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   content-add               |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   content-accept            |
  |----------------------------&gt;|
  |   ack                       |
  |&lt;----------------------------|
  |   AUDIO + VIDEO (RTP)       |
  |&lt;===========================&gt;|
  |   session-terminate         |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |                             |
    </pre></div>
    <p class="" style="">The protocol flow is as follows.</p>
    <p class="caption"><a name="example-34" id="example-34"></a>Example 34. Initiation</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='jingle1'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-initiate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='96' name='speex' clockrate='16000'/&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='103' name='L16' clockrate='16000' channels='2'/&gt;
        &lt;payload-type id='98' name='x-ISAC' clockrate='8000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
    &lt;content creator='initiator' name='this-is-the-video-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:video-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='96' name='theora' clockrate='90000' height='720' width='1280'&gt;
          &lt;parameter name='delivery-method' value='inline'/&gt;
          &lt;parameter name='configuration' value='somebase16string'/&gt;
          &lt;parameter name='sampling' value='YCbCr-4:2:2'/&gt;
        &lt;/payload-type&gt;
        &lt;payload-type id='28' name='nv' clockrate='90000'/&gt;
        &lt;payload-type id='25' name='CelB' clockrate='90000'/&gt;
        &lt;payload-type id='32' name='MPV' clockrate='90000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-35" id="example-35"></a>Example 35. Responder acknowledges session-initiate request</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='jingle1'
    to='romeo@montague.lit/orchard'
    type='result'/&gt;
    </pre></div>
    <p class="caption"><a name="example-36" id="example-36"></a>Example 36. Responder sends ringing message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='ringing1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;ringing xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-37" id="example-37"></a>Example 37. Initiator acknowledges ringing message</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='ringing1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">However, Juliet doesn't want to do video because she is having a bad hair day, so she sends a "content-remove" request to Romeo.</p>
    <p class="caption"><a name="example-38" id="example-38"></a>Example 38. Responder requests content-remove</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='remove1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='content-remove'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-video-content'&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">Romeo then acknowledges the content-remove request:</p>
    <p class="caption"><a name="example-39" id="example-39"></a>Example 39. Initiator acknowledges content-remove</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='remove1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">Because the parties have chosen the Jingle ICE-UDP Transport Method, the initiator and responder exchange an open-ended number of possible candidate transports, perform connectivity checks, and agree upon a candidate transport as explained in <span class="ref">XEP-0176</span>. Once ICE negotiation is completed, the responder sends a session-accept action to the initiator.</p>
    <p class="caption"><a name="example-40" id="example-40"></a>Example 40. Responder sends session-accept</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='accept1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-accept'
          initiator='romeo@montague.lit/orchard'
          responder='juliet@capulet.lit/balcony'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='0' name='PCMU' /&gt;
        &lt;payload-type id='102' name='iLBC'/&gt;
        &lt;payload-type id='4' name='G723'/&gt;
        &lt;payload-type id='8' name='PCMA'/&gt;
        &lt;payload-type id='13' name='CN'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'&gt;
        &lt;candidate component='1'
                   foundation='1'
                   generation='0'
                   ip='192.0.2.3'
                   network='1'
                   port='45664'
                   priority='1694498815'
                   protocol='udp'
                   pwd='asd88fgpdd777uzjYhagZg'
                   rel-addr='10.0.1.1'
                   rel-port='8998'
                   rem-addr='192.0.2.1'
                   rem-port='3478'
                   type='srflx'
                   ufrag='8hhy'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As above, if the payload types and transport candidate can be successfully used by both parties, then the initiator acknowledges the session-accept action.</p>
    <p class="caption"><a name="example-41" id="example-41"></a>Example 41. Initiator acknowledges session-accept</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='accept1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">The parties now begin to exchange media. In this case they would exchange audio using the Speex codec at a clockrate of 8000 since that is the highest-priority codec for the responder (as determined by the XML order of the &lt;payload-type/&gt; children).</p>
    <p class="" style="">The parties chat for a while. Eventually Juliet wants to get her hair in order so she puts Romeo on hold.</p>
    <p class="caption"><a name="example-42" id="example-42"></a>Example 42. Responder sends hold message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hold1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;hold xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-43" id="example-43"></a>Example 43. Initiator acknowledges hold message</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='hold1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">Juliet returns so she informs Romeo that she is actively engaged in the call again.</p>
    <p class="caption"><a name="example-44" id="example-44"></a>Example 44. Responder sends active message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='active1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;active xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-45" id="example-45"></a>Example 45. Initiator acknowledges active message</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='active1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">The parties now continue the audio chat.</p>
    <p class="" style="">Finally Juliet decides that she is presentable for a video chat so she sends a content-add request to Romeo.</p>
    <p class="caption"><a name="example-46" id="example-46"></a>Example 46. Responder sends a content-add</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='add1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='content-add'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='responder' name='video-is-back'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:video-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='96' name='theora' height='720' width='1280'&gt;
          &lt;parameter name='delivery-method' value='inline'/&gt;
          &lt;parameter name='configuration' value='somebase16string'/&gt;
          &lt;parameter name='sampling' value='YCbCr-4:2:2'/&gt;
        &lt;/payload-type&gt;
        &lt;payload-type id='32' name='MPV' clockrate='90000'/&gt;
        &lt;payload-type id='33' name='MP2T' clockrate='90000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The entity receiving the content-add request then acknowledges the request and, if it is acceptable, returns a content-accept action:</p>
    <p class="caption"><a name="example-47" id="example-47"></a>Example 47. Initiator acknowledges content-add</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='add1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="caption"><a name="example-48" id="example-48"></a>Example 48. Initiator accepts new content definition</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='add2'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='content-accept'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='responder' name='video-is-back'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:video-rtp' profile='RTP/AVP'&gt;
        &lt;payload-type id='96' name='theora' height='720' width='1280'&gt;
          &lt;parameter name='delivery-method' value='inline'/&gt;
          &lt;parameter name='configuration' value='somebase16string'/&gt;
          &lt;parameter name='sampling' value='YCbCr-4:2:2'/&gt;
        &lt;/payload-type&gt;
        &lt;payload-type id='32' name='MPV' clockrate='90000'/&gt;
        &lt;payload-type id='33' name='MP2T' clockrate='90000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The other party then acknowledges the acceptance.</p>
    <p class="caption"><a name="example-49" id="example-49"></a>Example 49. Responder acknowledges content-accept</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='add2'
    to='romeo@montague.lit/orchard'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">The media session proceeds. Now they would exchange both audio and video, where the audio is exchanged the Speex codec at a clockrate of 8000 and the video is exchanged using the Theora codec with a height of 720 pixels, a width of 1280 pixels, and so on.</p>
    <p class="" style="">The parties may continue the session as long as desired.</p>
    <p class="" style="">Eventually, one of the parties terminates the session.</p>
    <p class="caption"><a name="example-50" id="example-50"></a>Example 50. Initiator sends session-terminate</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='term1'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;
      &lt;condition&gt;&lt;busy/&gt;&lt;/condition&gt;
      &lt;text&gt;I&amp;apos;m outta here!&lt;/text&gt;
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-51" id="example-51"></a>Example 51. Responder acknowledges session-terminate</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='term1'
    to='romeo@montague.lit/orchard'
    type='result'/&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>9.4 <a name="scenarios-secure" id="scenarios-secure">Secure Jingle Audio via UDP/TLS/RTP/SAVP, Negotiated with ICE-UDP</a></h3>
    <p class="" style="">In this scenario, Romeo initiates a voice chat with Juliet using a secure transport as specified in <span class="ref" style=""><a href="http://tools.ietf.org/html/draft-fischl-mmusic-sdp-dtls">RTP Over DTLS</a></span>  [<a href="#nt-id2263968">13</a>] (via a profile of "UDP/TLS/RTP/SAVP").</p>
    <p class="" style="">The session flow is as follows:</p>
    <p class="caption"></p><div class="indent"><pre>
Romeo                         Juliet
  |                             |
  |   session-initiate          |
  |----------------------------&gt;|
  |   ack                       |
  |&lt;----------------------------|
  |   session-info (ringing)    |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   transport-info (X times)  |
  |   (with acks)               |
  |&lt;---------------------------&gt;|
  |   STUN connectivity checks  |
  |&lt;---------------------------&gt;|
  |   session-accept            |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |   AUDIO (RTP)               |
  |&lt;===========================&gt;|
  |   session-terminate         |
  |&lt;----------------------------|
  |   ack                       |
  |----------------------------&gt;|
  |                             |
    </pre></div>
    <p class="" style="">The protocol flow is as follows.</p>
    <p class="caption"><a name="example-52" id="example-52"></a>Example 52. Initiator sends session-initiate</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='jingle1'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-initiate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='UDP/TLS/RTP/SAVP'/&gt;
        &lt;payload-type id='96' name='speex' clockrate='16000'/&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='103' name='L16' clockrate='16000' channels='2'/&gt;
        &lt;payload-type id='98' name='x-ISAC' clockrate='8000'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-53" id="example-53"></a>Example 53. Responder acknowledges session-initiate</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='jingle1'
    to='romeo@montague.lit/orchard'
    type='result'/&gt;
    </pre></div>
    <p class="caption"><a name="example-54" id="example-54"></a>Example 54. Responder sends ringing message</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='ringing1'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;ringing xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'/&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-55" id="example-55"></a>Example 55. Initiator acknowledges ringing message</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='ringing1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">Because the parties have chosen the Jingle ICE-UDP Transport Method, the initiator and responder exchange an open-ended number of possible candidate transports, perform connectivity checks, and agree upon a candidate transport as explained in <span class="ref">XEP-0176</span>. Once ICE negotiation is completed, the responder sends a session-accept action to the initiator.</p>
    <p class="caption"><a name="example-56" id="example-56"></a>Example 56. Responder sends session-accept</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='accept1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-accept'
          initiator='romeo@montague.lit/orchard'
          responder='juliet@capulet.lit/balcony'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='this-is-the-audio-content'&gt;
      &lt;description xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp' profile='UDP/TLS/RTP/SAVP'&gt;
        &lt;payload-type id='97' name='speex' clockrate='8000'/&gt;
        &lt;payload-type id='18' name='G729'/&gt;
        &lt;payload-type id='0' name='PCMU' /&gt;
        &lt;payload-type id='102' name='iLBC'/&gt;
        &lt;payload-type id='4' name='G723'/&gt;
        &lt;payload-type id='8' name='PCMA'/&gt;
        &lt;payload-type id='13' name='CN'/&gt;
      &lt;/description&gt;
      &lt;transport xmlns='urn:xmpp:tmp:jingle:transports:ice-udp'&gt;
        &lt;candidate component='1'
                   foundation='1'
                   generation='0'
                   ip='192.0.2.3'
                   network='1'
                   port='45664'
                   priority='1694498815'
                   protocol='udp'
                   pwd='asd88fgpdd777uzjYhagZg'
                   rel-addr='10.0.1.1'
                   rel-port='8998'
                   rem-addr='192.0.2.1'
                   rem-port='3478'
                   type='srflx'
                   ufrag='8hhy'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If the payload types and transport candidate can be successfully used by both parties, then the initiator acknowledges the session-accept action.</p>
    <p class="caption"><a name="example-57" id="example-57"></a>Example 57. Initiator acknowledges session-accept</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='accept1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
    <p class="" style="">The parties now begin to exchange media. In this case they would exchange audio using the Speex codec at a clockrate of 8000 since that is the highest-priority codec for the responder (as determined by the XML order of the &lt;payload-type/&gt; children).</p>
    <p class="" style="">The parties may continue the session as long as desired.</p>
    <p class="" style="">Eventually, one of the parties terminates the session.</p>
  <p class="caption"><a name="example-58" id="example-58"></a>Example 58. Responder terminates the session</p><div class="indent"><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='term1'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:tmp:jingle'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;
      &lt;condition&gt;&lt;no-error/&gt;&lt;/condition&gt;
      &lt;text&gt;Sorry, gotta go!&lt;/text&gt;
    &lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The other party then acknowledges termination of the session:</p>
    <p class="caption"><a name="example-59" id="example-59"></a>Example 59. Initiator acknowledges termination</p><div class="indent"><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='term1'
    to='juliet@capulet.lit/balcony'
    type='result'/&gt;
    </pre></div>
  </div>
<h2>10.
       <a name="impl" id="impl">Implementation Notes</a></h2>
  <div class="indent"><h3>10.1 <a name="impl-codecs" id="impl-codecs">Codecs</a></h3>
    <p class="" style="">Support for the Speex codec is RECOMMENDED.</p>
  </div>
  <div class="indent"><h3>10.2 <a name="impl-dtmf" id="impl-dtmf">DTMF</a></h3>
    <p class="" style="">If it is necessary to send Dual Tone Multi-Frequency (DTMF) tones, it is REQUIRED to use the XML format specified <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0181.html">Jingle DTMF </a></span>  [<a href="#nt-id2264248">14</a>].</p>
  </div>
  <div class="indent"><h3>10.3 <a name="impl-listen" id="impl-listen">When to Listen</a></h3>
    <p class="" style="">When the Jingle Audio content type is accepted via a content-accept action, both initiator and responder SHOULD start listening for audio as defined by the negotiated transport method and audio application format. For interoperability with telephony systems, after the responder acknowledges the session initiation request, the responder SHOULD send a "ringing" message and both parties SHOULD play any audio received.</p>
  </div>
<h2>11.
       <a name="security" id="security">Security Considerations</a></h2>
  <p class="" style="">In order to secure the data stream, implementations SHOULD use encryption methods appropriate to the transport method and media being exchanged; for example, in the case of UDP, that would include Datagram Transport Layer Security (DTLS) as specified in <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc4347">RFC 4347</a></span>  [<a href="#nt-id2264324">15</a>]. The work-in-progress <span class="ref">draft-fishl-mmusic-sdp-dtls</span> defines such methods for the Session Description Protocol; the relevant RTP profile (e.g., "UDP/TLS/RTP/SAVP" for transporting the RTP stream over DTLS with UDP) shall be specified as the value of the &lt;content/&gt; element's 'profile' attribute.</p>
<h2>12.
       <a name="iana" id="iana">IANA Considerations</a></h2>
  <p class="" style="">This document requires no interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-id2264355">16</a>].</p>
<h2>13.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
  <div class="indent"><h3>13.1 <a name="ns" id="ns">Protocol Namespaces</a></h3>
    <p class="" style="">Until this specification advances to a status of Draft, its associated namespaces shall be:</p>
    <ul class="" style="">
      <li class="" style="">urn:xmpp:tmp:jingle:apps:audio-rtp</li>
      <li class="" style="">urn:xmpp:tmp:jingle:apps:audio-rtp:errors</li>
      <li class="" style="">urn:xmpp:tmp:jingle:apps:audio-rtp-info</li>
    </ul>
    <p class="" style="">Upon advancement of this specification, the <span class="ref" style=""><a href="http://www.xmpp.org/registrar/">XMPP Registrar</a></span>  [<a href="#nt-id2264458">17</a>] shall issue permanent namespaces in accordance with the process defined in Section 4 of <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0053.html">XMPP Registrar Function</a></span>  [<a href="#nt-id2264490">18</a>].</p>
    <p class="" style="">The following namespaces are requested, and are thought to be unique per the XMPP Registrar's requirements:</p>
    <ul class="" style="">
      <li class="" style="">urn:xmpp:jingle:app:audio-rtp</li>
      <li class="" style="">urn:xmpp:jingle:app:audio-rtp:errors</li>
      <li class="" style="">urn:xmpp:jingle:app:audio-rtp:info</li>
    </ul>
  </div>
  <div class="indent"><h3>13.2 <a name="registrar-content" id="registrar-content">Jingle Application Formats</a></h3>
    <p class="" style="">The XMPP Registrar shall include "audio-rtp" in its registry of Jingle application formats. The registry submission is as follows:</p>
    <p class="caption"></p><div class="indent"><pre>
&lt;application&gt;
  &lt;name&gt;audio-rtp&lt;/name&gt;
  &lt;desc&gt;Jingle sessions that support audio exchange via the Real-time Transport Protocol&lt;/desc&gt;
  &lt;transport&gt;lossy&lt;/transport&gt;
  &lt;doc&gt;XEP-0167&lt;/doc&gt;
&lt;/application&gt;
    </pre></div>
  </div>
<h2>14.
       <a name="schema" id="schema">XML Schemas</a></h2>
  <div class="indent"><h3>14.1 <a name="schema-content" id="schema-content">Application Format</a></h3>
    <p class="caption"></p><div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:tmp:jingle:apps:audio-rtp'
    xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp'
    elementFormDefault='qualified'&gt;

  &lt;xs:element name='description'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence minOccurs='0' maxOccurs='unbounded'/&gt;
        &lt;xs:element ref='payload-type'/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name='profile' use='optional' type='xs:string'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='payload-type'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence minOccurs='0' maxOccurs='unbounded'&gt;
        &lt;xs:element ref='parameter'/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name='channels' type='xs:byte' use='optional' default='1'/&gt;
      &lt;xs:attribute name='clockrate' type='xs:short' use='optional'/&gt;
      &lt;xs:attribute name='id' type='xs:unsignedByte' use='required'/&gt;
      &lt;xs:attribute name='maxptime' type='xs:short' use='optional'/&gt;
      &lt;xs:attribute name='name' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='ptime' type='xs:short' use='optional'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='parameter'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:simpleContent&gt;
        &lt;xs:extension base='empty'&gt;
          &lt;xs:attribute name='name' type='xs:string' use='required'/&gt;
          &lt;xs:attribute name='value' type='xs:string' use='required'/&gt;
        &lt;/xs:extension&gt;
      &lt;/xs:simpleContent&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:simpleType name='empty'&gt;
    &lt;xs:restriction base='xs:string'&gt;
      &lt;xs:enumeration value=''/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>14.2 <a name="schema-info" id="schema-info">Informational Messages</a></h3>
    <p class="caption"></p><div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:tmp:jingle:apps:audio-rtp:info'
    xmlns='urn:xmpp:tmp:jingle:apps:audio-rtp:info'
    elementFormDefault='qualified'&gt;

  &lt;xs:element name='active' type='empty'/&gt;
  &lt;xs:element name='hold' type='empty'/&gt;
  &lt;xs:element name='mute' type='empty'/&gt;
  &lt;xs:element name='ringing' type='empty'/&gt;

  &lt;xs:simpleType name='empty'&gt;
    &lt;xs:restriction base='xs:string'&gt;
      &lt;xs:enumeration value=''/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
    </pre></div>
  </div>
<hr /><h2><a name="notes" id="notes"></a>Notes</h2><div class="indent"><p><a name="nt-id2251655" id="nt-id2251655">1</a>. XEP-0166: Jingle &lt;<a href="http://www.xmpp.org/extensions/xep-0166.html">http://www.xmpp.org/extensions/xep-0166.html</a>&gt;.</p><p><a name="nt-id2251687" id="nt-id2251687">2</a>. RFC 3550: RTP: A Transport Protocol for Real-Time Applications &lt;<a href="http://tools.ietf.org/html/rfc3550">http://tools.ietf.org/html/rfc3550</a>&gt;.</p><p><a name="nt-id2251734" id="nt-id2251734">3</a>. RFC 4566: SDP: Session Description Protocol &lt;<a href="http://tools.ietf.org/html/rfc4566">http://tools.ietf.org/html/rfc4566</a>&gt;.</p><p><a name="nt-id2261721" id="nt-id2261721">4</a>. XEP-0177: Jingle Raw UDP Transport Method &lt;<a href="http://www.xmpp.org/extensions/xep-0177.html">http://www.xmpp.org/extensions/xep-0177.html</a>&gt;.</p><p><a name="nt-id2261748" id="nt-id2261748">5</a>. XEP-0176: Jingle ICE-UDP Transport Method &lt;<a href="http://www.xmpp.org/extensions/xep-0176.html">http://www.xmpp.org/extensions/xep-0176.html</a>&gt;.</p><p><a name="nt-id2262172" id="nt-id2262172">6</a>. RFC 3551: RTP Profile for Audio and Video Conferences with Minimal Control &lt;<a href="http://tools.ietf.org/html/rfc3551">http://tools.ietf.org/html/rfc3551</a>&gt;.</p><p><a name="nt-id2262226" id="nt-id2262226">7</a>. RTP Payload Format for the Speex Codec &lt;<a href="http://tools.ietf.org/html/draft-ietf-avt-rtp-speex">http://tools.ietf.org/html/draft-ietf-avt-rtp-speex</a>&gt;. Work in progress.</p><p><a name="nt-id2262160" id="nt-id2262160">8</a>. See &lt;<a href="http://www.speex.org/">http://www.speex.org/</a>&gt;.</p><p><a name="nt-id2262274" id="nt-id2262274">9</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-id2262812" id="nt-id2262812">10</a>. A &lt;trying/&gt; element (equivalent to the SIP 100 Trying response code) is not necessary, since each session-level action is acknowledged via XMPP IQ semantics.</p><p><a name="nt-id2263046" id="nt-id2263046">11</a>. XEP-0030: Service Discovery &lt;<a href="http://www.xmpp.org/extensions/xep-0030.html">http://www.xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-id2263101" id="nt-id2263101">12</a>. XEP-0115: Entity Capabilities &lt;<a href="http://www.xmpp.org/extensions/xep-0115.html">http://www.xmpp.org/extensions/xep-0115.html</a>&gt;.</p><p><a name="nt-id2263968" id="nt-id2263968">13</a>. Real-Time Transport Protocol (RTP) over Datagram Transport Layer Security (DTLS) &lt;<a href="http://tools.ietf.org/html/draft-fischl-mmusic-sdp-dtls">http://tools.ietf.org/html/draft-fischl-mmusic-sdp-dtls</a>&gt;. Work in progress.</p><p><a name="nt-id2264248" id="nt-id2264248">14</a>. XEP-0181: Jingle DTMF &lt;<a href="http://www.xmpp.org/extensions/xep-0181.html">http://www.xmpp.org/extensions/xep-0181.html</a>&gt;.</p><p><a name="nt-id2264324" id="nt-id2264324">15</a>. RFC 4347: Datagram Transport Layer Security &lt;<a href="http://tools.ietf.org/html/rfc4347">http://tools.ietf.org/html/rfc4347</a>&gt;.</p><p><a name="nt-id2264355" id="nt-id2264355">16</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-id2264458" id="nt-id2264458">17</a>. The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see &lt;<a href="http://www.xmpp.org/registrar/">http://www.xmpp.org/registrar/</a>&gt;.</p><p><a name="nt-id2264490" id="nt-id2264490">18</a>. XEP-0053: XMPP Registrar Function &lt;<a href="http://www.xmpp.org/extensions/xep-0053.html">http://www.xmpp.org/extensions/xep-0053.html</a>&gt;.</p></div><hr /><h2><a name="revs" id="revs"></a>Revision History</h2><div class="indent"><h4>Version 0.18 (2008-05-28)</h4><div class="indent"><p class="" style="">Removed content-replace from ICE-UDP examples per XEP-0176.</p> (psa)
    </div><h4>Version 0.17 (2008-02-29)</h4><div class="indent"><p class="" style="">Corrected use of content-replace action per XEP-0166.</p> (psa)
    </div><h4>Version 0.16 (2008-02-28)</h4><div class="indent"><p class="" style="">Moved profile attribute from XEP-0166 to this specification.</p> (psa)
    </div><h4>Version 0.15 (2008-01-11)</h4><div class="indent"><p class="" style="">Removed content-accept after content-remove per XEP-0166.</p> (psa)
    </div><h4>Version 0.14 (2008-01-03)</h4><div class="indent"><p class="" style="">Modified examples to track changes to XEP-0176.</p> (psa)
    </div><h4>Version 0.13 (2007-12-06)</h4><div class="indent"><p class="" style="">To track changes to XEP-0166, modified busy scenario and removed unsupported-codecs error.</p> (psa)
    </div><h4>Version 0.12 (2007-11-27)</h4><div class="indent"><p class="" style="">Further editorial review.</p> (psa)
    </div><h4>Version 0.11 (2007-11-15)</h4><div class="indent"><p class="" style="">Editorial review and consistency check; moved voice chat scenarios from XEP-0166 to this specification.</p> (psa)
    </div><h4>Version 0.10 (2007-11-13)</h4><div class="indent"><p class="" style="">Removed info message for busy since it is now a Jingle-specific error condition defined in XEP-0166; defined info message for active.</p> (psa)
    </div><h4>Version 0.9 (2007-04-17)</h4><div class="indent"><p class="" style="">Specified Jingle conformance, including the preference for lossy transports over reliable transports and the process of sending and receiving audio content over each transport type.</p> (psa)
    </div><h4>Version 0.8 (2007-03-23)</h4><div class="indent"><p class="" style="">Renamed to mention RTP as the associated transport; corrected negotiation flow to be consistent with SIP/SDP (each party specifies a list of the payload types it can receive); added profile attribute to content element in order to specify RTP profile in use.</p> (psa/ram)
    </div><h4>Version 0.7 (2006-12-21)</h4><div class="indent"><p class="" style="">Modified spec to use provisional namespace before advancement to Draft (per XEP-0053).</p> (psa)
    </div><h4>Version 0.6 (2006-10-31)</h4><div class="indent"><p class="" style="">Specified how to include SDP parameters and codec-specific parameters; clarified negotiation process; added Speex examples; removed queued info message.</p> (psa/se)
    </div><h4>Version 0.5 (2006-08-23)</h4><div class="indent"><p class="" style="">Modified namespace to track XEP-0166.</p> (psa)
    </div><h4>Version 0.4 (2006-07-12)</h4><div class="indent"><p class="" style="">Specified when to play received audio (early media); specified that DTMF must use in-band signalling (XEP-0181).</p> (se/psa)
    </div><h4>Version 0.3 (2006-03-20)</h4><div class="indent"><p class="" style="">Defined info messages for hold and mute.</p> (psa)
    </div><h4>Version 0.2 (2006-02-13)</h4><div class="indent"><p class="" style="">Defined info message for busy; added info message examples; recommended use of Speex; updated schema and XMPP Registrar considerations.</p> (psa)
    </div><h4>Version 0.1 (2005-12-15)</h4><div class="indent"><p class="" style="">Initial version.</p> (psa)
    </div><h4>Version 0.0.3 (2005-12-05)</h4><div class="indent"><p class="" style="">Described service discovery usage; defined initial informational messages.</p> (psa)
    </div><h4>Version 0.0.2 (2005-10-27)</h4><div class="indent"><p class="" style="">Added SDP mapping, security considerations, IANA considerations, XMPP Registrar considerations, and XML schema.</p> (psa)
    </div><h4>Version 0.0.1 (2005-10-21)</h4><div class="indent"><p class="" style="">First draft.</p> (psa/sl)
    </div></div><hr /><p>END</p></body></html>
