<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>XEP-0016: Privacy Lists</title>
<link rel="stylesheet" type="text/css" href="/xmpp.css">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<meta name="DC.Title" content="Privacy Lists">
<meta name="DC.Creator" content="Peter Millard">
<meta name="DC.Creator" content="Peter Saint-Andre">
<meta name="DC.Description" content="The main body of this document has been copied without modification from Section 10 of RFC 3921.">
<meta name="DC.Publisher" content="Jabber Software Foundation">
<meta name="DC.Contributor" content="XMPP Extensions Editor">
<meta name="DC.Date" content="2006-10-04">
<meta name="DC.Type" content="XMPP Extension Protocol">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="XEP-0016">
<meta name="DC.Language" content="en">
<meta name="DC.Rights" content="This XMPP Extension Protocol is copyright 1999 - 2006 by the Jabber Software Foundation (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;http://www.xmpp.org/extensions/ipr-policy.shtml&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;http://creativecommons.org/licenses/by/2.5/&gt;).">
</head>
<body>
<h1>XEP-0016: Privacy Lists</h1>
<p>The main body of this document has been copied without modification from Section 10 of RFC 3921.</p>
<p><hr></p>
<p style="color:green">NOTICE: The protocol defined herein is a Draft Standard of the Jabber Software Foundation. Implementations are encouraged and the protocol is appropriate for deployment in production systems, but some changes to the protocol are possible before it becomes a Final Standard.</p>
<p><hr></p>
<h2>XEP Information</h2>
<p class="indent">
            Status: 
            <a href="http://www.xmpp.org/extensions/xep-0001.html#states-Draft">Draft</a><br>
            Type:
            <a href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards%20Track">Standards Track</a><br>
            Number: 0016<br>
            Version: 1.4<br>
            Last Updated: 2006-10-04<br>
            Publishing Organization: <a href="http://www.jabber.org/jsf/">Jabber Software Foundation</a><br>
                Approving Body: <a href="http://www.jabber.org/council/">XMPP Council</a><br>Dependencies: XMPP Core<br>
                Supersedes: None<br>
                Superseded By: None<br>
            Short Name: privacy<br>
              Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Privacy%20Lists%20(XEP-0016)">http://wiki.jabber.org/index.php/Privacy Lists (XEP-0016)</a>&gt;
            </p>
<h2>Author Information</h2>
<div class="indent">
<h3>Peter Millard</h3>
<p class="indent">
        See <a href="#authornote">Author Note</a><br></p>
<h3>Peter Saint-Andre</h3>
<p class="indent">
        Email:
        <a href="mailto:stpeter@jabber.org">stpeter@jabber.org</a><br>
        JID: 
        <a href="xmpp:stpeter@jabber.org">stpeter@jabber.org</a></p>
</div>
<h2>Legal Notice</h2>
<p class="indent">This XMPP Extension Protocol is copyright 1999 - 2006 by the <a href="http://www.jabber.org/jsf/">Jabber Software Foundation</a> (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;<a href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;<a href="http://creativecommons.org/licenses/by/2.5/">http://creativecommons.org/licenses/by/2.5/</a>&gt;).</p>
<h2>Discussion Venue</h2>
<p class="indent">The preferred venue for discussion of this document is the Standards-JIG discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards-jig">http://mail.jabber.org/mailman/listinfo/standards-jig</a>&gt;.</p>
<h2>Relation to XMPP</h2>
<p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the Jabber Software Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p>
<h2>Conformance Terms</h2>
<p class="indent">The following keywords as used in this document are to be interpreted as described in RFC 2119: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p>
<p><hr></p>
<h2>Table of Contents</h2>
<div class="indent"><dl>
<dt>1.  <a href="#sect-id2259988">Introduction</a>
</dt>
<dt>2.  <a href="#protocol">Protocol</a>
</dt>
<dl>
<dt>2.1.  <a href="#protocol-syntax">Syntax and Semantics</a>
</dt>
<dt>2.2.  <a href="#protocol-rules">Business Rules</a>
</dt>
<dt>2.3.  <a href="#protocol-retrieve">Retrieving One's Privacy Lists</a>
</dt>
<dt>2.4.  <a href="#protocol-active">Managing Active Lists</a>
</dt>
<dt>2.5.  <a href="#protocol-default">Managing the Default List</a>
</dt>
<dt>2.6.  <a href="#protocol-edit">Editing a Privacy List</a>
</dt>
<dt>2.7.  <a href="#protocol-add">Adding a New Privacy List</a>
</dt>
<dt>2.8.  <a href="#protocol-remove">Removing a Privacy List</a>
</dt>
<dt>2.9.  <a href="#protocol-message">Blocking Messages</a>
</dt>
<dt>2.10.  <a href="#protocol-presencein">Blocking Inbound Presence Notifications</a>
</dt>
<dt>2.11.  <a href="#protocol-presenceout">Blocking Outbound Presence Notifications</a>
</dt>
<dt>2.12.  <a href="#protocol-iq">Blocking IQ Stanzas</a>
</dt>
<dt>2.13.  <a href="#protocol-all">Blocking All Communication</a>
</dt>
<dt>2.14.  <a href="#protocol-error">Blocked Entity Attempts to Communicate with User</a>
</dt>
<dt>2.15.  <a href="#protocol-heuristics">Higher-Level Heuristics</a>
</dt>
</dl>
<dt>3.  <a href="#schema">XML Schema</a>
</dt>
<dt>4.  <a href="#authornote">Author Note</a>
</dt>
<dt><a href="#notes">Notes</a></dt>
<dt><a href="#revs">Revision History</a></dt>
</dl></div>
<p><hr></p>
<h2>1.
       <a name="sect-id2259988">Introduction</a>
</h2>
  <p class="" style="">Almost all types of Instant Messaging (IM) applications have found it necessary to develop some method for a user to block the receipt of messages and packets from other users (the rationale for such blockage depends on the needs of the individual user). This document defines a flexible method for communications blocking.</p>
  <p class="" style="">Note: The protocol specified herein MAY be used in conjunction with <span class="ref" style="">Simple Communications Blocking</span>  [<a href="#nt-id2260037">1</a>]; see <span style="font-weight: bold">XEP-0191</span> for details.</p>
  <p class="" style=""><span style="font-style: italic">The remainder of this document has been copied without modification from Section 10 of <span class="ref" style="">RFC 3921</span>  [<a href="#nt-id2260072">2</a>].</span></p>
<h2>2.
       <a name="protocol">Protocol</a>
</h2>
  <p class="" style="">Most instant messaging systems have found it necessary to implement some method for users to block communications from particular other users (this is also required by sections 5.1.5, 5.1.15, 5.3.2, and 5.4.10 of <span class="ref" style="">RFC 2779</span>  [<a href="#nt-id2260118">3</a>].  In XMPP this is done by managing one's privacy lists using the 'jabber:iq:privacy' namespace.</p>
  <p class="" style="">Server-side privacy lists enable successful completion of the following use cases:</p>
  <ul>
    <li>Retrieving one's privacy lists.</li>
    <li>Adding, removing, and editing one's privacy lists.</li>
    <li>Setting, changing, or declining active lists.</li>
    <li>Setting, changing, or declining the default list (i.e., the list that is active by default).</li>
    <li>Allowing or blocking messages based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking inbound presence notifications based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking outbound presence notifications based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking IQ stanzas based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking all communications based on JID, group, or subscription type (or globally).</li>
  </ul>
  <p class="" style="">Note: Presence notifications do not include presence subscriptions, only presence information that is broadcasted to entities that are subscribed to a user's presence information.  Thus this includes presence stanzas with no 'type' attribute or of type='unavailable' only.</p>
  <div class="indent">
<h3>2.1 <a name="protocol-syntax">Syntax and Semantics</a>
</h3>
    <p class="" style="">A user MAY define one or more privacy lists, which are stored by the user's server.  Each &lt;list/&gt; element contains one or more rules in the form of &lt;item/&gt; elements, and each &lt;item/&gt; element uses attributes to define a privacy rule type, a specific value to which the rule applies, the relevant action, and the place of the item in the processing order.</p>
    <p class="" style="">The syntax is as follows:</p>
    <p class="caption"></p>
<div class="indent"><pre>
&lt;iq&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='foo'&gt;
      &lt;item
          type='[jid|group|subscription]'
          value='bar'
          action='[allow|deny]'
          order='unsignedInt'&gt;
        [&lt;message/&gt;]
        [&lt;presence-in/&gt;]
        [&lt;presence-out/&gt;]
        [&lt;iq/&gt;]
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If the type is "jid", then the 'value' attribute MUST contain a valid Jabber ID.  JIDs SHOULD be matched in the following order:</p>
    <ol start="" type="">
      <li>&lt;user@domain/resource&gt; (only that resource matches)</li>
      <li>&lt;user@domain&gt; (any resource matches)</li>
      <li>&lt;domain/resource&gt; (only that resource matches)</li>
      <li>&lt;domain&gt; (the domain itself matches, as does any user@domain, domain/resource, or address containing a subdomain)</li>
    </ol>
    <p class="" style="">If the type is "group", then the 'value' attribute SHOULD contain the name of a group in the user's roster.  (If a client attempts to update, create, or delete a list item with a group that is not in the user's roster, the server SHOULD return to the client an &lt;item-not-found/&gt; stanza error.)</p>
    <p class="" style="">If the type is "subscription", then the 'value' attribute MUST be one of "both", "to", "from", or "none" as defined <span style="font-weight: bold">RFC 3921</span>, where "none" includes entities that are totally unknown to the user and therefore not in the user's roster at all.</p>
    <p class="" style="">If no 'type' attribute is included, the rule provides the "fall-through" case.</p>
    <p class="" style="">The 'action' attribute MUST be included and its value MUST be either "allow" or "deny".</p>
    <p class="" style="">The 'order' attribute MUST be included and its value MUST be a non-negative integer that is unique among all items in the list.  (If a client attempts to create or update a list with non-unique order values, the server MUST return to the client a &lt;bad-request/&gt; stanza error.)</p>
    <p class="" style="">The &lt;item/&gt; element MAY contain one or more child elements that enable an entity to specify more granular control over which kinds of stanzas are to be blocked (i.e., rather than blocking all stanzas).  The allowable child elements are:</p>
    <ul>
      <li>&lt;message/&gt; -- blocks incoming message stanzas</li>
      <li>&lt;iq/&gt; -- blocks incoming IQ stanzas</li>
      <li>&lt;presence-in/&gt; -- blocks incoming presence notifications</li>
      <li>&lt;presence-out/&gt; -- blocks outgoing presence notifications</li>
    </ul>
    <p class="" style="">Within the 'jabber:iq:privacy' namespace, the &lt;query/&gt; child of an IQ stanza of type "set" MUST NOT include more than one child element (i.e., the stanza MUST contain only one &lt;active/&gt; element, one &lt;default/&gt; element, or one &lt;list/&gt; element); if a sending entity violates this rule, the receiving entity MUST return a &lt;bad-request/&gt; stanza error.</p>
    <p class="" style="">When a client adds or updates a privacy list, the &lt;list/&gt; element SHOULD contain at least one &lt;item/&gt; child element; when a client removes a privacy list, the &lt;list/&gt; element MUST NOT contain any &lt;item/&gt; child elements.</p>
    <p class="" style="">When a client updates a privacy list, it must include all of the desired items (i.e., not a "delta").</p>
  </div>
  <div class="indent">
<h3>2.2 <a name="protocol-rules">Business Rules</a>
</h3>
    <ol start="" type="">
      <li><p class="" style="">If there is an active list set for a session, it affects only the session(s) for which it is activated, and only for the duration of the session(s); the server MUST apply the active list only and MUST NOT apply the default list (i.e., there is no "layering" of lists).</p></li>
      <li><p class="" style="">The default list applies to the user as a whole, and is processed if there is no active list set for the target session/resource to which a stanza is addressed, or if there are no current sessions for the user.</p></li>
      <li><p class="" style="">If there is no active list set for a session (or there are no current sessions for the user), and there is no default list, then all stanzas SHOULD BE accepted or appropriately processed by the server on behalf of the user in accordance with the server rules for handling XML stanzas defined in <span style="font-weight: bold">RFC 3921</span>.</p></li>
      <li><p class="" style="">Privacy lists MUST be the first delivery rule applied by a server, superseding (1) the routing and delivery rules specified in server rules for handling XML stanzas defined in <span style="font-weight: bold">RFC 3921</span> and (2) the handling of subscription-related presence stanzas (and corresponding generation of roster pushes) specified in <span style="font-weight: bold">RFC 3921</span>.</p></li>
      <li><p class="" style="">The order in which privacy list items are processed by the server is important.  List items MUST be processed in ascending order determined by the integer values of the 'order' attribute for each &lt;item/&gt;.</p></li>
      <li><p class="" style="">As soon as a stanza is matched against a privacy list rule, the server MUST appropriately handle the stanza in accordance with the rule and cease processing.</p></li>
      <li><p class="" style="">If no fall-through item is provided in a list, the fall-through action is assumed to be "allow".</p></li>
      <li><p class="" style="">If a user updates the definition for an active list, subsequent processing based on that active list MUST use the updated definition (for all resources to which that active list currently applies).</p></li>
      <li><p class="" style="">If a change to the subscription state or roster group of a roster item defined in an active or default list occurs during a user's session, subsequent processing based on that list MUST take into account the changed state or group (for all resources to which that list currently applies).</p></li>
      <li><p class="" style="">When the definition for a rule is modified, the server MUST send an IQ stanza of type "set" to all connected resources, containing a &lt;query/&gt; element with only one &lt;list/&gt; child element, where the 'name' attribute is set to the name of the modified privacy list.  These "privacy list pushes" adhere to the same semantics as the "roster pushes" used in roster management, except that only the list name itself (not the full list definition or the "delta") is pushed to the connected resources.  It is up to the receiving resource to determine whether to retrieve the modified list definition, although a connected resource SHOULD do so if the list currently applies to it.</p></li>
      <li><p class="" style="">When a resource attempts to remove a list or specify a new default list while that list applies to a connected resource other than the sending resource, the server MUST return a &lt;conflict/&gt; error to the sending resource and MUST NOT make the requested change.</p></li>
    </ol>
  </div>
  <div class="indent">
<h3>2.3 <a name="protocol-retrieve">Retrieving One's Privacy Lists</a>
</h3>
    <a name="example-1"></a><p class="caption">Example 1. Client requests names of privacy lists from server</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist1'&gt;
&lt;query xmlns='jabber:iq:privacy'/&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-2"></a><p class="caption">Example 2. Server sends names of privacy lists to client, preceded by active list and default list</p>
<div class="indent"><pre>
&lt;iq type='result' id='getlist1' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active name='private'/&gt;
  &lt;default name='public'/&gt;
  &lt;list name='public'/&gt;
  &lt;list name='private'/&gt;
  &lt;list name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-3"></a><p class="caption">Example 3. Client requests a privacy list from server</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-4"></a><p class="caption">Example 4. Server sends a privacy list to client</p>
<div class="indent"><pre>
&lt;iq type='result' id='getlist2' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='1'/&gt;
    &lt;item action='allow' order='2'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-5"></a><p class="caption">Example 5. Client requests another privacy list from server</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='private'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-6"></a><p class="caption">Example 6. Server sends another privacy list to client</p>
<div class="indent"><pre>
&lt;iq type='result' id='getlist3' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='private'&gt;
    &lt;item type='subscription'
          value='both'
          action='allow'
          order='10'/&gt;
    &lt;item action='deny' order='15'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-7"></a><p class="caption">Example 7. Client requests yet another privacy list from server</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-8"></a><p class="caption">Example 8. Server sends yet another privacy list to client</p>
<div class="indent"><pre>
&lt;iq type='result' id='getlist4' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='special'&gt;
    &lt;item type='jid'
          value='juliet@example.com'
          action='allow'
          order='6'/&gt;
    &lt;item type='jid'
          value='benvolio@example.org'
          action='allow'
          order='7'/&gt;
    &lt;item type='jid'
          value='mercutio@example.org'
          action='allow'
          order='42'/&gt;
    &lt;item action='deny' order='666'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">In this example, the user has three lists: (1) 'public', which allows communications from everyone except one specific entity (this is the default list); (2) 'private', which allows communications only with contacts who have a bidirectional subscription with the user (this is the active list); and (3) 'special', which allows communications only with three specific entities.</p>
    <p class="" style="">If the user attempts to retrieve a list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user:</p>
    <a name="example-9"></a><p class="caption">Example 9. Client attempts to retrieve non-existent list</p>
<div class="indent"><pre>
&lt;iq to='romeo@example.net/orchard' type='error' id='getlist5'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='The Empty Set'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;item-not-found
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The user is allowed to retrieve only one list at a time.  If the user attempts to retrieve more than one list in the same request, the server MUST return a &lt;bad request/&gt; stanza error to the user:</p>
    <a name="example-10"></a><p class="caption">Example 10. Client attempts to retrieve more than one list</p>
<div class="indent"><pre>
&lt;iq to='romeo@example.net/orchard' type='error' id='getlist6'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
  &lt;list name='private'/&gt;
  &lt;list name='special'/&gt;
&lt;/query&gt;
&lt;error type='modify'&gt;
  &lt;bad-request
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>2.4 <a name="protocol-active">Managing Active Lists</a>
</h3>
    <p class="" style="">In order to set or change the active list currently being applied by the server, the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains an empty &lt;active/&gt; child element possessing a 'name' attribute whose value is set to the desired list name.</p>
    <a name="example-11"></a><p class="caption">Example 11. Client requests change of active list</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='active1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The server MUST activate and apply the requested list before sending the result back to the client.</p>
    <a name="example-12"></a><p class="caption">Example 12. Server acknowledges success of active list change</p>
<div class="indent"><pre>
&lt;iq type='result' id='active1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p class="" style="">If the user attempts to set an active list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user:</p>
    <a name="example-13"></a><p class="caption">Example 13. Client attempts to set a non-existent list as active</p>
<div class="indent"><pre>
&lt;iq to='romeo@example.net/orchard' type='error' id='active2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active name='The Empty Set'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;item-not-found
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">In order to decline the use of any active list, the connected resource MUST send an empty &lt;active/&gt; element with no 'name' attribute.</p>
    <a name="example-14"></a><p class="caption">Example 14. Client declines the use of active lists</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='active3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-15"></a><p class="caption">Example 15. Server acknowledges success of declining any active list</p>
<div class="indent"><pre>
&lt;iq type='result' id='active3' to='romeo@example.net/orchard'/&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>2.5 <a name="protocol-default">Managing the Default List</a>
</h3>
    <p class="" style="">In order to change its default list (which applies to the user as a whole, not only the sending resource), the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains an empty &lt;default/&gt; child element possessing a 'name' attribute whose value is set to the desired list name.</p>
    <a name="example-16"></a><p class="caption">Example 16. User requests change of default list</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='default1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-17"></a><p class="caption">Example 17. Server acknowledges success of default list change</p>
<div class="indent"><pre>
&lt;iq type='result' id='default1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p class="" style="">If the user attempts to change which list is the default list but the default list is in use by at least one connected resource other than the sending resource, the server MUST return a &lt;conflict/&gt; stanza error to the sending resource:</p>
    <a name="example-18"></a><p class="caption">Example 18. Client attempts to change the default list but that list is in use by another resource</p>
<div class="indent"><pre>
&lt;iq to='romeo@example.net/orchard' type='error' id='default1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default name='special'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;conflict
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If the user attempts to set a default list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user:</p>
    <a name="example-19"></a><p class="caption">Example 19. Client attempts to set a non-existent list as default</p>
<div class="indent"><pre>
&lt;iq to='romeo@example.net/orchard' type='error' id='default1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default name='The Empty Set'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;item-not-found
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">In order to decline the use of a default list (i.e., to use the domain's stanza routing rules at all times), the user MUST send an empty &lt;default/&gt; element with no 'name' attribute.</p>
    <a name="example-20"></a><p class="caption">Example 20. Client declines the use of the default list</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='default2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-21"></a><p class="caption">Example 21. Server acknowledges success of declining any default list</p>
<div class="indent"><pre>
&lt;iq type='result' id='default2' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p class="" style="">If one connected resource attempts to decline the use of a default list for the user as a whole but the default list currently applies to at least one other connected resource, the server MUST return a &lt;conflict/&gt; error to the sending resource:</p>
    <a name="example-22"></a><p class="caption">Example 22. Client attempts to decline a default list but that list is in use by another resource</p>
<div class="indent"><pre>
&lt;iq to='romeo@example.net/orchard' type='error' id='default3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;conflict
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>2.6 <a name="protocol-edit">Editing a Privacy List</a>
</h3>
    <p class="" style="">In order to edit a privacy list, the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains one &lt;list/&gt; child element possessing a 'name' attribute whose value is set to the list name the user would like to edit.  The &lt;list/&gt; element MUST contain one or more &lt;item/&gt; elements, which specify the user's desired changes to the list by including all elements in the list (not the "delta").</p>
    <a name="example-23"></a><p class="caption">Example 23. Client edits a privacy list</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='edit1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='3'/&gt;
    &lt;item type='jid'
          value='paris@example.org'
          action='deny'
          order='5'/&gt;
    &lt;item action='allow' order='68'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-24"></a><p class="caption">Example 24. Server acknowledges success of list edit</p>
<div class="indent"><pre>
&lt;iq type='result' id='edit1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p class="" style="">Note: The value of the 'order' attribute for any given item is not fixed.  Thus in the foregoing example if the user would like to add 4 items between the "tybalt@example.com" item and the "paris@example.org" item, the user's client MUST renumber the relevant items before submitting the list to the server.</p>
    <p class="" style="">The server MUST now send a "privacy list push" to all connected resources:</p>
    <a name="example-25"></a><p class="caption">Example 25. Privacy list push on list edit</p>
<div class="indent"><pre>
&lt;iq to='romeo@example.net/orchard' type='set' id='push1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
&lt;/query&gt;
&lt;/iq&gt;

&lt;iq to='romeo@example.net/home' type='set' id='push2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">In accordance with the semantics of IQ stanzas defined in <span class="ref" style="">RFC 3920</span>  [<a href="#nt-id2261114">4</a>], each connected resource MUST return an IQ result to the server as well:</p>
    <a name="example-26"></a><p class="caption">Example 26. Acknowledging receipt of privacy list pushes</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard'
  type='result'
  id='push1'/&gt;

&lt;iq from='romeo@example.net/home'
  type='result'
  id='push2'/&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>2.7 <a name="protocol-add">Adding a New Privacy List</a>
</h3>
    <p class="" style="">The same protocol used to edit an existing list is used to create a new list.  If the list name matches that of an existing list, the request to add a new list will overwrite the old one.  As with list edits, the server MUST also send a "privacy list push" to all connected resources.</p>
  </div>
  <div class="indent">
<h3>2.8 <a name="protocol-remove">Removing a Privacy List</a>
</h3>
    <p class="" style="">In order to remove a privacy list, the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains one empty &lt;list/&gt; child element possessing a 'name' attribute whose value is set to the list name the user would like to remove.</p>
    <a name="example-27"></a><p class="caption">Example 27. Client removes a privacy list</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='remove1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='private'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-28"></a><p class="caption">Example 28. Server acknowledges success of list removal</p>
<div class="indent"><pre>
&lt;iq type='result' id='remove1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p class="" style="">If a user attempts to remove a list that is currently being applied to at least one resource other than the sending resource, the server MUST return a &lt;conflict/&gt; stanza error to the user; i.e., the user MUST first set another list to active or default before attempting to remove it.  If the user attempts to remove a list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user.  If the user attempts to remove more than one list in the same request, the server MUST return a &lt;bad request/&gt; stanza error to the user.</p>
  </div>
  <div class="indent">
<h3>2.9 <a name="protocol-message">Blocking Messages</a>
</h3>
    <p class="" style="">Server-side privacy lists enable a user to block incoming messages from other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.  (Note: For the sake of brevity, IQ stanzas of type "result" are not shown in the following examples, nor are "privacy list pushes".)</p>
    <a name="example-29"></a><p class="caption">Example 29. User blocks based on JID</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='msg1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='3'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive messages from the entity with the specified JID.</p>
    <a name="example-30"></a><p class="caption">Example 30. User blocks based on roster group</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='msg2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='4'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive messages from any entities in the specified roster group.</p>
    <a name="example-31"></a><p class="caption">Example 31. User blocks based on subscription type</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='msg3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-sub-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='5'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive messages from any entities with the specified subscription type.</p>
    <a name="example-32"></a><p class="caption">Example 32. User blocks globally</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='msg4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-global-example'&gt;
    &lt;item action='deny' order='6'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive messages from any other users.</p>
  </div>
  <div class="indent">
<h3>2.10 <a name="protocol-presencein">Blocking Inbound Presence Notifications</a>
</h3>
    <p class="" style="">Server-side privacy lists enable a user to block incoming presence notifications from other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.</p>
  <p class="" style="">Note: Presence notifications do not include presence subscriptions, only presence information that is broadcasted to the user because the user is currently subscribed to a contact's presence information.  Thus this includes presence stanzas with no 'type' attribute or of type='unavailable' only.</p>
    <a name="example-33"></a><p class="caption">Example 33. User blocks based on JID</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presin1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='7'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive presence notifications from the entity with the specified JID.</p>
    <a name="example-34"></a><p class="caption">Example 34. User blocks based on roster group</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presin2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='8'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive presence notifications from any entities in the specified roster group.</p>
    <a name="example-35"></a><p class="caption">Example 35. User blocks based on subscription type</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presin3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-sub-example'&gt;
    &lt;item type='subscription'
          value='to'
          action='deny'
          order='9'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive presence notifications from any entities with the specified subscription type.</p>
    <a name="example-36"></a><p class="caption">Example 36. User blocks globally</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presin4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-global-example'&gt;
    &lt;item action='deny' order='11'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive presence notifications from any other users.</p>
  </div>
  <div class="indent">
<h3>2.11 <a name="protocol-presenceout">Blocking Outbound Presence Notifications</a>
</h3>
    <p class="" style="">Server-side privacy lists enable a user to block outgoing presence notifications to other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.</p>
  <p class="" style="">Note: Presence notifications do not include presence subscriptions, only presence information that is broadcasted to contacts because those contacts are currently subscribed to the user's presence information.  Thus this includes presence stanzas with no 'type' attribute or of type='unavailable' only.</p>
    <a name="example-37"></a><p class="caption">Example 37. User blocks based on JID</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presout1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='13'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not send presence notifications to the entity with the specified JID.</p>
    <a name="example-38"></a><p class="caption">Example 38. User blocks based on roster group</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presout2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='15'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not send presence notifications to any entities in the specified roster group.</p>
    <a name="example-39"></a><p class="caption">Example 39. User blocks based on subscription type</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presout3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-sub-example'&gt;
    &lt;item type='subscription'
          value='from'
          action='deny'
          order='17'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not send presence notifications to any entities with the specified subscription type.</p>
    <a name="example-40"></a><p class="caption">Example 40. User blocks globally</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='presout4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-global-example'&gt;
    &lt;item action='deny' order='23'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not send presence notifications to any other users.</p>
  </div>
  <div class="indent">
<h3>2.12 <a name="protocol-iq">Blocking IQ Stanzas</a>
</h3>
    <p class="" style="">Server-side privacy lists enable a user to block incoming IQ stanzas from other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.</p>
    <a name="example-41"></a><p class="caption">Example 41. User blocks based on JID</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='iq1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='29'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from the entity with the specified JID.</p>
    <a name="example-42"></a><p class="caption">Example 42. User blocks based on roster group</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='iq2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='31'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from any entities in the specified roster group.</p>
    <a name="example-43"></a><p class="caption">Example 43. User blocks based on subscription type</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='iq3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-sub-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='17'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from any entities with the specified subscription type.</p>
    <a name="example-44"></a><p class="caption">Example 44. User blocks globally</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='iq4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-global-example'&gt;
    &lt;item action='deny' order='1'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from any other users.</p>
  </div>
  <div class="indent">
<h3>2.13 <a name="protocol-all">Blocking All Communication</a>
</h3>
    <p class="" style="">Server-side privacy lists enable a user to block all stanzas from and to other entities based on the entity's JID, roster group, or subscription status (or globally).  Note that this includes subscription-related presence stanzas, which are excluded by <a href="protocol-presencein">Blocking Inbound Presence Notifications</a>.  The following examples illustrate the protocol.</p>
    <a name="example-45"></a><p class="caption">Example 45. User blocks based on JID</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='all1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='23'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, the entity with the specified JID.</p>
    <a name="example-46"></a><p class="caption">Example 46. User blocks based on roster group</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='all2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='13'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, any entities in the specified roster group.</p>
    <a name="example-47"></a><p class="caption">Example 47. User blocks based on subscription type</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='all3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-sub-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='11'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, any entities with the specified subscription type.</p>
    <a name="example-48"></a><p class="caption">Example 48. User blocks globally</p>
<div class="indent"><pre>
&lt;iq from='romeo@example.net/orchard' type='set' id='all4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-global-example'&gt;
    &lt;item action='deny' order='7'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, any other users.</p>
  </div>
  <div class="indent">
<h3>2.14 <a name="protocol-error">Blocked Entity Attempts to Communicate with User</a>
</h3>
    <p class="" style="">If a blocked entity attempts to send message or presence stanzas to the user, the user's server SHOULD silently drop the stanza and MUST NOT return an error to the sending entity.</p>
    <p class="" style="">If a blocked entity attempts to send an IQ stanza of type "get" or "set" to the user, the user's server MUST return to the sending entity a &lt;service-unavailable/&gt; stanza error, since this is the standard error code sent from a client that does not understand the namespace of an IQ get or set.  IQ stanzas of other types SHOULD be silently dropped by the server.</p>
    <a name="example-49"></a><p class="caption">Example 49. Blocked entity attempts to send IQ get</p>
<div class="indent"><pre>
&lt;iq type='get'
  to='romeo@example.net'
  from='tybalt@example.com/pda'
  id='probing1'&gt;
&lt;query xmlns='jabber:iq:version'/&gt;
&lt;/iq&gt;
    </pre></div>
    <a name="example-50"></a><p class="caption">Example 50. Server returns error to blocked entity</p>
<div class="indent"><pre>
&lt;iq type='error'
  from='romeo@example.net'
  to='tybalt@example.com/pda'
  id='probing1'&gt;
&lt;query xmlns='jabber:iq:version'/&gt;
&lt;error type='cancel'&gt;
  &lt;service-unavailable
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>2.15 <a name="protocol-heuristics">Higher-Level Heuristics</a>
</h3>
    <p class="" style="">When building a representation of a higher-level privacy heuristic, a client SHOULD use the simplest possible representation.</p>
    <p class="" style="">For example, the heuristic "block all communications with any user not in my roster" could be constructed in any of the following ways:</p>
    <ul>
      <li>allow communications from all JIDs in my roster (i.e., listing each JID as a separate list item), but block communications with everyone else</li>
      <li>allow communications from any user who is in one of the groups that make up my roster (i.e., listing each group as a separate list item), but block communications from everyone else</li>
      <li>allow communications from any user with whom I have a subscription of 'both' or 'to' or 'from' (i.e., listing each subscription value separately), but block communications from everyone else</li>
      <li>block communications from anyone whose subscription state is 'none'</li>
    </ul>
    <p class="" style="">The final representation is the simplest and SHOULD be used; here is the XML that would be sent in this case:</p>
    <p class="caption"></p>
<div class="indent"><pre>
&lt;iq type='set' id='heuristic1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='heuristic-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='437'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
<h2>3.
       <a name="schema">XML Schema</a>
</h2>
  <p class="caption"></p>
<div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
  xmlns:xs='http://www.w3.org/2001/XMLSchema'
  targetNamespace='jabber:iq:privacy'
  xmlns='jabber:iq:privacy'
  elementFormDefault='qualified'&gt;

&lt;xs:element name='query'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref='active'
                  minOccurs='0'/&gt;
      &lt;xs:element ref='default'
                  minOccurs='0'/&gt;
      &lt;xs:element ref='list'
                  minOccurs='0'
                  maxOccurs='unbounded'/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='active'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base='xs:NMTOKEN'&gt;
        &lt;xs:attribute name='name'
                      type='xs:string'
                      use='optional'/&gt;
      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='default'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base='xs:NMTOKEN'&gt;
        &lt;xs:attribute name='name'
                      type='xs:string'
                      use='optional'/&gt;
      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='list'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref='item'
                  minOccurs='0'
                  maxOccurs='unbounded'/&gt;
    &lt;/xs:sequence&gt;
    &lt;xs:attribute name='name'
                  type='xs:string'
                  use='required'/&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='item'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name='iq'
                  minOccurs='0'
                  type='empty'/&gt;
      &lt;xs:element name='message'
                  minOccurs='0'
                  type='empty'/&gt;
      &lt;xs:element name='presence-in'
                  minOccurs='0'
                  type='empty'/&gt;
      &lt;xs:element name='presence-out'
                  minOccurs='0'
                  type='empty'/&gt;
    &lt;/xs:sequence&gt;
    &lt;xs:attribute name='action' use='required'&gt;
      &lt;xs:simpleType&gt;
        &lt;xs:restriction base='xs:NCName'&gt;
          &lt;xs:enumeration value='allow'/&gt;
          &lt;xs:enumeration value='deny'/&gt;
        &lt;/xs:restriction&gt;
      &lt;/xs:simpleType&gt;
    &lt;/xs:attribute&gt;
    &lt;xs:attribute name='order'
                  type='xs:unsignedInt'
                  use='required'/&gt;
    &lt;xs:attribute name='type' use='optional'&gt;
      &lt;xs:simpleType&gt;
        &lt;xs:restriction base='xs:NCName'&gt;
          &lt;xs:enumeration value='group'/&gt;
          &lt;xs:enumeration value='jid'/&gt;
          &lt;xs:enumeration value='subscription'/&gt;
        &lt;/xs:restriction&gt;
      &lt;/xs:simpleType&gt;
    &lt;/xs:attribute&gt;
    &lt;xs:attribute name='value'
                  type='xs:string'
                  use='optional'/&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:simpleType name='empty'&gt;
  &lt;xs:restriction base='xs:string'&gt;
    &lt;xs:enumeration value=''/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
  </pre></div>
<h2>4.
       <a name="authornote">Author Note</a>
</h2>
<p class="" style="">Peter Millard, the author of this specification from version 0.1 through version 0.3, died on April 26, 2006.</p>
<p><hr></p>
<a name="notes"></a><h2>Notes</h2>
<div class="indent">
<p><a name="nt-id2260037">1</a>. XEP-0191: Simple Communications Blocking &lt;<a href="http://www.xmpp.org/extensions/xep-0191.html">http://www.xmpp.org/extensions/xep-0191.html</a>&gt;.</p>
<p><a name="nt-id2260072">2</a>. RFC 3921: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence &lt;<a href="http://www.ietf.org/rfc/rfc3921.txt">http://www.ietf.org/rfc/rfc3921.txt</a>&gt;.</p>
<p><a name="nt-id2260118">3</a>. RFC 2779: A Model for Presence and Instant Messaging &lt;<a href="http://www.ietf.org/rfc/rfc2779.txt">http://www.ietf.org/rfc/rfc2779.txt</a>&gt;.</p>
<p><a name="nt-id2261114">4</a>. RFC 3920: Extensible Messaging and Presence Protocol (XMPP): Core &lt;<a href="http://www.ietf.org/rfc/rfc3920.txt">http://www.ietf.org/rfc/rfc3920.txt</a>&gt;.</p>
</div>
<p><hr></p>
<a name="revs"></a><h2>Revision History</h2>
<div class="indent">
<h4>Version 1.4 (2006-10-04)</h4>
<div class="indent">
<p class="" style="">Copied Section 10 of RFC 3921.</p> (psa)
    </div>
<h4>Version 1.3 (2004-07-26)</h4>
<div class="indent">
<p class="" style="">Formally retracted this proposal in favor of XMPP IM.</p> (psa)
    </div>
<h4>Version 1.2 (2003-03-12)</h4>
<div class="indent">
<p class="" style="">Changed status to Deprecated since this protocol is now included in the XMPP IM Internet-Draft.</p> (psa)
    </div>
<h4>Version 1.1 (2002-11-17)</h4>
<div class="indent">
<p class="" style="">Added remarks about default handling, and where list processing should take place.</p> (pgm)
    </div>
<h4>Version 1.0 (2002-10-22)</h4>
<div class="indent">
<p class="" style="">Changed status to Draft.</p> (psa)
    </div>
<h4>Version 0.4 (2002-10-03)</h4>
<div class="indent">
<p class="" style="">Elaborated on various JID possibilities.</p> (pgm)
    </div>
<h4>Version 0.3 (2002-07-31)</h4>
<div class="indent">
<p class="" style="">Added info describing current session issues</p> (pgm)
    </div>
<h4>Version 0.2 (2002-07-30)</h4>
<div class="indent">
<p class="" style="">Added whitelists, subscription filtering, and multiple list capabilities. Changed block to deny.</p> (pgm)
    </div>
<h4>Version 0.1 (2002-01-18)</h4>
<div class="indent">
<p class="" style="">Initial version.</p> (pgm)
    </div>
</div>
<p><hr></p>
<p>END</p>
</body>
</html>
