<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<title>JEP-0124: HTTP Binding</title>
<link rel="stylesheet" type="text/css" href="jep.css">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<meta name="DC.Title" content="HTTP Binding">
<meta name="DC.Creator" content="Dave Smith">
<meta name="DC.Creator" content="Peter Saint-Andre">
<meta name="DC.Creator" content="Ian Paterson">
<meta name="DC.Description" content="This JEP defines a binding of Jabber/XMPP communications to a transport layer of HTTP rather than TCP.">
<meta name="DC.Publisher" content="Jabber Software Foundation">
<meta name="DC.Contributor" content="JEP Editor">
<meta name="DC.Date" content="2004-10-26">
<meta name="DC.Type" content="Jabber Enhancement Proposal">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="JEP-0124">
<meta name="DC.Language" content="en">
<meta name="DC.Rights" content="This Jabber Enhancement Proposal is copyright 1999 - 2004 by the Jabber Software Foundation (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;http://www.jabber.org/jsf/ipr-policy.php&gt;. This material may be distributed only subject to the terms and conditions set forth in the Open Publication License, v1.0 or later (the latest version is presently available at &lt;http://www.opencontent.org/openpub/&gt;).">
</head>
<body bgcolor="#FFFFFF">
<h1>JEP-0124: HTTP Binding</h1>
<p>This JEP defines a binding of Jabber/XMPP communications to a transport layer of HTTP rather than TCP.</p>
<p><hr></p>
<p style="color:red">WARNING: This Standards-Track JEP is Experimental. Publication as a Jabber Enhancement Proposal does not imply approval of this proposal by the Jabber Software Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems should not deploy implementations of this protocol until it advances to a status of Draft.</p>
<p><hr></p>
<h2>JEP Information</h2>
<p class="indent">
            Status: Experimental<br>
            Type: Standards Track<br>
            Number: 0124<br>
            Version: 0.8<br>
            Last Updated: 2004-10-26<br>
            JIG: Standards JIG<br>
                Approving Body: Jabber Council<br>Dependencies: XMPP Core, RFC 1945, RFC 2068, RFC 3174<br>
                Supersedes: None<br>
                Superseded By: None<br>
            Short Name: httpbind<br>
</p>
<h2>Author Information</h2>
<h3>Dave Smith</h3>
<p class="indent">
        Email: dizzyd@jabber.org<br>
        JID: dizzyd@jabber.org</p>
<h3>Peter Saint-Andre</h3>
<p class="indent">
        Email: stpeter@jabber.org<br>
        JID: stpeter@jabber.org</p>
<h3>Ian Paterson</h3>
<p class="indent">
        Email: ian.paterson@clientside.co.uk<br>
        JID: ian@zoofy.com</p>
<h2>Legal Notice</h2>
<p class="indent">This Jabber Enhancement Proposal is copyright 1999 - 2004 by the Jabber Software Foundation (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;<a href="http://www.jabber.org/jsf/ipr-policy.php">http://www.jabber.org/jsf/ipr-policy.php</a>&gt;. This material may be distributed only subject to the terms and conditions set forth in the Open Publication License, v1.0 or later (the latest version is presently available at &lt;<a href="http://www.opencontent.org/openpub/">http://www.opencontent.org/openpub/</a>&gt;).</p>
<h2>Discussion Venue</h2>
<p class="indent">The preferred venue for discussion of this document is the Standards-JIG discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards-jig">http://mail.jabber.org/mailman/listinfo/standards-jig</a>&gt;.</p>
<p class="indent">Given that this JEP normatively references IETF technologies, discussion on the JSF-IETF list may also be appropriate (see &lt;<a href="http://mail.jabber.org/mailman/listinfo/jsf-ietf">http://mail.jabber.org/mailman/listinfo/jsf-ietf</a>&gt; for details).</p>
<h2>Relation to XMPP</h2>
<p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core and XMPP IM specifications contributed by the Jabber Software Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocols defined in this JEP have been developed outside the Internet Standards Process and are to be understood as extensions to XMPP rather than as an evolution, development, or modification of XMPP itself.</p>
<h2>Conformance Terms</h2>
<p class="indent">The keywords &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be interpreted as described in RFC 2119.</p>
<p><hr></p>
<h2>Table of Contents</h2>
<dl>
<dt>1.  <a href="#intro">Introduction</a>
</dt>
<dt>2.  <a href="#terms">Terminology</a>
</dt>
<dl><dt>2.1.  <a href="#terms-http">HTTP Terms</a>
</dt></dl>
<dt>3.  <a href="#reqs">Requirements</a>
</dt>
<dt>4.  <a href="#arch">Architectural Assumptions</a>
</dt>
<dt>5.  <a href="#http">HTTP Version and HTTP Headers</a>
</dt>
<dt>6.  <a href="#wrapper">&lt;body/&gt; Wrapper Element</a>
</dt>
<dt>7.  <a href="#session">Initiating an HTTP Session</a>
</dt>
<dl>
<dt>7.1.  <a href="#session-request">Requesting a Session</a>
</dt>
<dt>7.2.  <a href="#session-create">Session Creation</a>
</dt>
<dt>7.3.  <a href="#session-features">Communication of Stream Features</a>
</dt>
</dl>
<dt>8.  <a href="#preconditions">Additional Preconditions</a>
</dt>
<dl>
<dt>8.1.  <a href="#preconditions-xmpp">XMPP Methods</a>
</dt>
<dt>8.2.  <a href="#preconditions-iqauth">jabber:iq:auth</a>
</dt>
</dl>
<dt>9.  <a href="#stanzas">Sending and Receiving XML Stanzas</a>
</dt>
<dt>10.  <a href="#terminate">Terminating the HTTP Session</a>
</dt>
<dt>11.  <a href="#rids">Request IDs</a>
</dt>
<dl>
<dt>11.1.  <a href="#rids-order">In-Order Message Forwarding</a>
</dt>
<dt>11.2.  <a href="#rids-broken">Broken Connections</a>
</dt>
</dl>
<dt>12.  <a href="#keys">Protecting Insecure Sessions</a>
</dt>
<dl>
<dt>12.1.  <a href="#keys-applic">Applicability</a>
</dt>
<dt>12.2.  <a href="#keys-intro">Introduction</a>
</dt>
<dt>12.3.  <a href="#keys-generate">Generating the Key Sequence</a>
</dt>
<dt>12.4.  <a href="#keys-use">Use of Keys</a>
</dt>
<dt>12.5.  <a href="#keys-switch">Switching to Another Key Sequence</a>
</dt>
</dl>
<dt>13.  <a href="#errorstatus">Error and Status Codes</a>
</dt>
<dl>
<dt>13.1.  <a href="#errorstatus-http">HTTP Conditions</a>
</dt>
<dt>13.2.  <a href="#errorstatus-terminal">Terminal Binding Conditions</a>
</dt>
<dt>13.3.  <a href="#errorstatus-recover">Recoverable Binding Conditions</a>
</dt>
<dt>13.4.  <a href="#errorstatus-stanza">XMPP Stanza Conditions</a>
</dt>
</dl>
<dt>14.  <a href="#security">Security Considerations</a>
</dt>
<dt>15.  <a href="#iana">IANA Considerations</a>
</dt>
<dt>16.  <a href="#registrar">Jabber Registrar Considerations</a>
</dt>
<dl><dt>16.1.  <a href="#registrar-ns">Protocol Namespaces</a>
</dt></dl>
<dt>17.  <a href="#schema">XML Schema</a>
</dt>
<dt><a href="#notes">Notes</a></dt>
<dt><a href="#revs">Revision History</a></dt>
</dl>
<p><hr></p>
<h2>1.
       <a name="intro">Introduction</a>
</h2>
    <p class="" style="">
<span class="ref">XMPP Core</span>  [<a href="#nt-id2596359">1</a>] defines XML streams bound to TCP (see <span class="ref">RFC 793</span>  [<a href="#nt-id2596381">2</a>]) as the standard transport layer for Jabber/XMPP communications. However, the binding of XMPP to TCP is not always feasible because of client runtime environment and/or network constraints. This JEP describes the usage of the Hypertext Transfer Protocol (HTTP, see <span class="ref">RFC 2068</span>  [<a href="#nt-id2596396">3</a>] and <span class="ref">RFC 1945</span>  [<a href="#nt-id2596296">4</a>]) as an alternative transport binding that supports such constrained environments, normally via deployment of a specialized server-side connection manager that communicates with clients via HTTP rather than TCP.</p>
    <p class="" style="">Before the authors pursued publication of this JEP, other approaches were explored. One possible approach might have been to apply state to a series of HTTP transactions via HTTP &quot;cookies&quot; as specified in <span class="ref">RFC 2965</span>  [<a href="#nt-id2596329">5</a>]. However, there are several significant computing platforms which provide only limited access to underlying HTTP requests/responses; worse, some platforms hide or remove cookie-related headers. Therefore the cookie approach was rejected.</p>
    <p class="" style="">Another approach might have been to modify or extend <span class="ref">Jabber HTTP Polling</span>  [<a href="#nt-id2601972">6</a>]. This informational protocol has been used by Jabber clients without runtime constraints to access XMPP servers from behind firewalls. Unfortunately, the method defined in JEP-0025 also depends on cookies, does not meet most of the requirements described below, and cannot be extended without breaking all existing implementations.</p>
    <p class="" style="">Therefore, this JEP specifies a new way of transporting XMPP via HTTP. All information is encoded in the body of standard HTTP POST requests and responses. Each HTTP body contains a single &lt;body/&gt; XML wrapper element (not to be confused with the &lt;body/&gt; child of the &lt;message/&gt; stanza as defined in <span class="ref">XMPP IM</span>  [<a href="#nt-id2601912">7</a>]), which encapsulates zero or more XML stanzas.</p>
    <p class="" style="">Although this JEP documents some XMPP-specific features, the binding is not part of XMPP. In fact, the protocol is extensible and could be used to implement any bidirectional stream of XML stanzas.</p>
  <h2>2.
       <a name="terms">Terminology</a>
</h2>
    <div class="indent">
<h3>2.1 <a name="terms-http">HTTP Terms</a>
</h3>
      <p class="" style="">This document inherits terminology regarding the Hypertext Transport Protocol from RFCs 1945 and 2068.</p>
    </div>
  <h2>3.
       <a name="reqs">Requirements</a>
</h2>
    <p class="" style="">Platform limitiations, security restrictions, and other constraints imply that many clients can connect to Internet resources (e.g., Jabber servers) only via HTTP. The following design requirements reflect the need to offer performance as close as possible to a standard TCP connection.</p>
    <ol start="" type="">
      <li>Compatible with constrained runtime environments (e.g., mobile and browser-based clients).</li>
      <li>Compatible with restricted network connections (e.g., firewalls, proxies, and gateways).</li>
      <li>Fault tolerant (e.g., session recovers after an underlying TCP connection breaks during an HTTP request).</li>
      <li>Extensible (based on XML).</li>
      <li>Consume significantly less bandwidth than polling-based solutions.</li>
      <li>Significantly more responsive than polling-based solutions.</li>
      <li>Support for polling (for clients that are limited to one HTTP connection at a time).</li>
      <li>XML stanzas should arrive at the server in the order they were sent by the client.</li>
      <li>Protect against unauthorized users interjecting HTTP requests into a session.</li>
    </ol>
    <p class="" style="">Compatibility with constrained runtime environments implies the following restrictions:</p>
    <ul>
      <li>Clients should not be required to have programmatic access to the headers of each HTTP request and response (e.g., cookies or status codes).</li>
      <li>The body of each HTTP request and response should be parsable XML with a single root element.</li>
      <li>Clients should be able to specify the Content-Type of the HTTP responses they receive.</li>
    </ul>
  <h2>4.
       <a name="arch">Architectural Assumptions</a>
</h2>
    <p class="" style="">The binding of XMPP to HTTP assumes a different architecture from that described for the binding of XMPP to TCP as defined in <span style="font-weight: bold">XMPP Core</span>. In particular, because HTTP is not the native binding for XMPP, we assume that most XMPP implementations will utilize a specialized &quot;connection manager&quot; to handle HTTP connections rather than the usual TCP connections. Effectively, such a connection manager will be a specialized HTTP server that translates between the HTTP requests and responses defined herein and the XML streams (or a server API) implemented by the XMPP server or servers with which it communicates, thus enabling an HTTP client to connect to an XMPP server. We can illustrate this graphically as follows:</p>
    <p class="caption"></p>
<div class="indent"><pre>
  XMPP Server
      |
      |  [XML streams or server API]
      |
Connection Manager
      |
      |  [HTTP + &lt;body/&gt; wrapper]
      |
  HTTP Client
    </pre></div>
    <p class="" style="">This JEP addresses communications between an HTTP client and the connection manager only. It does not address communications between the connection manager and the XMPP server, since such communications are implementation-specific (e.g., the connection manager and the XMPP server may use <span class="ref">Jabber Component Protocol</span>  [<a href="#nt-id2602267">8</a>] or an API defined by the XMPP server implementation in order to communicate; alternatively, the XMPP server may natively support the HTTP binding, in which case the connection manager will be a logical entity rather than a physical entity).</p>
    <p class="" style="">Furthermore, no aspect of the HTTP binding limits its use to client-to-server communications; i.e., it could be used for server-to-server or component-to-server communications as well (probably through a slight change to the XML schema). However, this document focuses exclusively on use of the HTTP binding by clients that cannot maintain persistent TCP connections to a server and that therefore cannot use the TCP binding defined in <span style="font-weight: bold">XMPP Core</span>. We assume that servers and components are under no such restrictions and thus would use the TCP binding.</p>
  <h2>5.
       <a name="http">HTTP Version and HTTP Headers</a>
</h2>
    <p class="" style="">Clients SHOULD send HTTP requests over persistent HTTP/1.1 connections. However, a constrained client MAY open a new HTTP/1.0 connection (as defined in RFC 1945) to send each request.</p>
    <p class="" style="">Requests and responses MAY include HTTP headers not specified herein. The receiver SHOULD ignore any such headers.</p>
  <h2>6.
       <a name="wrapper">&lt;body/&gt; Wrapper Element</a>
</h2>
    <p class="" style="">The body of each HTTP request and response contains a single &lt;body/&gt; wrapper element. The &lt;body/&gt; element MUST contain zero or more complete XML elements. It MUST NOT contain partial XML elements.</p>
    <p class="" style="">If the &lt;body/&gt; wrapper element is not empty, then it MUST contain one of the following:</p>
    <ul>
      <li>One or more complete XMPP stanzas (&lt;message/&gt;, &lt;presence/&gt;, and/or &lt;iq/&gt;).</li>
      <li>A complete &lt;stream:features/&gt; element qualified by the 'http://etherx.jabber.org/streams' namespace.</li>
      <li>A complete element used for SASL negotiation and qualified by the 'urn:ietf:params:xml:ns:xmpp-sasl' namespace.</li>
      <li>XML elements associated with a binding error condition. For details, refer to the <a href="#errorstatus-binding">Binding Conditions</a> section below.</li>
    </ul>
    <p class="" style="">Note: Inclusion of TLS negotiation elements is allowed but is NOT RECOMMENDED (see below).</p>
    <p class="" style="">The &lt;body/&gt; wrapper element SHOULD be qualified by the 'http://jabber.org/protocol/httpbind' namespace, and child elements SHOULD be qualified by their respective namespaces (e.g., 'http://etherx.jabber.org/streams' for stream features, 'urn:ietf:params:xml:ns:xmpp-sasl' for SASL negotiation, and 'jabber:client' for XML stanzas). However, even if the client does not specify the namespaces, the connection manager MUST ensure that the XMPP it provides to the XMPP server or other entities on the network meets the namespacing requirements of <span style="font-weight: bold">XMPP Core</span>.</p>
    <p class="" style="">The &lt;body/&gt; element of every client request MUST possess a sequential request ID encapsulated via the 'rid' attribute. The client MUST generate a large positive non-zero random integer for the first 'rid' and then increment that value by one for each subsequent request. For details, refer to the <a href="#rids">Request IDs</a> section below.</p>
  <h2>7.
       <a name="session">Initiating an HTTP Session</a>
</h2>
    <div class="indent">
<h3>7.1 <a name="session-request">Requesting a Session</a>
</h3>
      <p class="" style="">The first request from the client to the connection manager creates a new session.</p>
      <p class="" style="">The &lt;body/&gt; element of the first request SHOULD possess the following attributes:</p>
      <ul>
        <li>
<span style="font-weight: bold">'to'</span> -- This attribute specifies the target domain (this attribute SHOULD NOT be included on any request but the first request).</li>
        <li>
<span style="font-weight: bold">'xml:lang'</span> -- This attribute (as defined in Section 2.12 of <span class="ref">XML 1.0</span>  [<a href="#nt-id2602565">9</a>]) specifies the default language of any human-readable XML character data sent or received during the session (this attribute SHOULD NOT be included on any request but the first request).</li>
        <li>
<span style="font-weight: bold">'wait'</span> -- This attribute specifies the longest time (in seconds) that the connection manager is allowed to wait before responding to any request during the session. This enables the client to prevent its TCP connection from expiring due to inactivity, as well as to limit the delay before it discovers any network failure.</li>
        <li>
<span style="font-weight: bold">'hold'</span> -- This attribute specifies the maximum number of requests the connection manager is allowed to keep waiting at any one time during the session. (For example, if a constrained client is unable to keep open more than two HTTP connections to the same HTTP server simultaneously, then it SHOULD specify a value of &quot;1&quot;.)</li>
      </ul>
      <p class="" style="">Note: Clients that only support polling behavior MAY prevent the connection manager from waiting by setting 'wait' or 'hold' to &quot;0&quot;. However, polling is NOT RECOMMENDED since the associated increase in bandwidth consumption and the decrease in responsiveness are typically one or two orders of magnitude!</p>
      <p class="" style="">Some clients are constrained to only accept HTTP responses with specific Content-Types (e.g., &quot;text/html&quot;). The &lt;body/&gt; element of the first request MAY possess a 'content' attribute. This specifies the value of the HTTP Content-Type header that MUST appear in all the connection manager's responses during the session. If the client request does not possess a 'content' attribute, then the HTTP Content-Type of responses MUST be &quot;text/xml; charset=utf-8&quot;.</p>
      <p class="" style="">Note: The HTTP Content-Type of client requests SHOULD also be &quot;text/xml; charset=utf-8&quot;. Clients MAY specify another value if they are constrained to do so (e.g., &quot;application/x-www-form-urlencoded&quot; or &quot;text/plain&quot;). The client and connection manager SHOULD ignore all HTTP Content-Type headers they receive. The connection manager is not required to convert between UTF-8 and other character encodings. For both requests and responses, the &lt;body/&gt; element and its content SHOULD be UTF-8 encoded, even if the HTTP Content-Type header specifies a different charset.</p>
      <p class="caption">Example 1. Requesting an HTTP session</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 104

&lt;body content='text/xml; charset=utf-8'
      hold='1'
      rid='3197423130'
      to='jabber.org'
      wait='60'
      xml:lang='en'
      xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
      <p class="" style="">Note: Unlike the protocol defined in JEP-0025, an opening &lt;stream:stream&gt; tag is not sent. The protocol defined herein abstracts from XML streams between the connection manager and the client. Any XML streams between the connection manager and an XMPP server are the responsibility of the connection manager.</p>
      <p class="" style="">Note: All requests after the first one MUST include a valid 'sid' attribue (provided by the connection manager in the session creation response below). The initialization request is unique in that the &lt;body/&gt; element MUST NOT possess a 'sid' attribute.</p>
    </div>
    <div class="indent">
<h3>7.2 <a name="session-create">Session Creation</a>
</h3>
      <p class="" style="">After receiving a new session request, the connection manager MUST generate an opaque, unpredictable session identifier (or SID). The SID MUST be unique within the context of the connection manager application. The connection manager then returns that SID to the client in a response &lt;body/&gt; element.</p>
      <p class="" style="">The connection manager MUST specify a 'wait' attribute. This is the longest time (in seconds) that it will wait before responding to any request during the session. The time MUST be less than or equal to the value specified in the session request.</p>
      <p class="" style="">The connection manager MAY limit the number of simultaneous requests the client makes with the 'requests' attribute. The RECOMMENDED value is &quot;2&quot;. Servers that only support polling behavior MUST prevent clients from making simultaneous requests by setting the 'requests' attribute to a value of &quot;1&quot; (however, polling is NOT RECOMMENDED). In any case, clients MUST NOT make more simultaneous requests than specified by the connection manager.</p>
      <p class="" style="">The connection manager SHOULD include two additional attributes in the session creation response element, specifying the shortest allowable polling interval and the longest allowable inactivity period (both in seconds). Communication of these parameters enables the client to engage in appropriate behavior (e.g., not sending empty request elements more often than desired, and ensuring that the periods with no requests pending are never too long).</p>
      <p class="caption">Example 2. Session creation response</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 128

&lt;body authid='ServerStreamID'
      wait='60'
      inactivity='30'
      polling='5'
      requests='2'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
    <p class="" style="">Note: The 'authid' attribute contains the value of the XMPP stream ID generated by the XMPP server. The connection manager MUST retrieve the stream ID and pass it unmodified to the client. This value is needed by the client to successfully complete digest authentication using <span class="ref">Non-SASL Authentication</span>  [<a href="#nt-id2602849">10</a>] (see the <a href="#preconditions-iqauth">jabber:iq:auth</a> section below).</p>
    <p class="" style="">Note: If the 'authid' attribute is not included in the connection manager's response to the session creation request (e.g., because the connection manager has not yet received a stream ID from the XMPP server), then the client SHOULD send empty request elements (see the &quot;Requesting XML Stanzas&quot; example below) until it receives a response with an 'authid' attribute. In any case, the connection manager MUST return the 'authid' in a response to the client as soon as possible after it receives the stream ID from the XMPP server.</p>
    <p class="" style="">Separate 'sid' and 'authid' attributes are required because the connection manager is not necessarily part of a single XMPP server (e.g., it may handle HTTP connections on behalf of multiple XMPP servers).</p>
    </div>
    <div class="indent">
<h3>7.3 <a name="session-features">Communication of Stream Features</a>
</h3>
      <p class="" style="">As an immediate child of the session creation response, the connection manager MAY include a stream features element, as defined by <span style="font-weight: bold">XMPP Core</span>.</p>
      <p class="caption">Example 3. Session creation response with stream features</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 417

&lt;body wait='60'
      inactivity='60'
      polling='5'
      requests='2'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;stream:features xmlns='http://etherx.jabber.org/streams'&gt;
    &lt;mechanisms xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
      &lt;mechanism&gt;DIGEST-MD5&lt;/mechanism&gt;
      &lt;mechanism&gt;PLAIN&lt;/mechanism&gt;
    &lt;/mechanisms&gt;
    &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'&gt;
    &lt;session xmlns='urn:ietf:params:xml:ns:xmpp-session'&gt;
  &lt;/stream:features&gt;
&lt;/body&gt;</pre></div>
      <p class="" style="">The stream features SHOULD NOT include a feature for Transport Layer Security (TLS), since channel encryption SHOULD be negotiated at the HTTP layer (see the <a href="#security">Security Considerations</a> section below).</p>
    </div>
  <h2>8.
       <a name="preconditions">Additional Preconditions</a>
</h2>
    <p class="" style="">Initializing an HTTP session is the first precondition to sending XML message, presence, and IQ stanzas. However, before processing XML stanzas from the client, the connection manager MUST require completion of additional preconditions using either of the following methods:</p>
    <ul>
      <li>
        <p class="" style="">XMPP authentication, resource binding, and IM session creation, in the following order:</p>
        <ol start="" type="">
          <li>Optionally, TLS negotiation as defined in Section 5 of <span style="font-weight: bold">XMPP Core</span> (this is NOT RECOMMENDED since channel encryption SHOULD be negotiated at the HTTP layer; see the <a href="#security">Security Considerations</a> section below)</li>
          <li>SASL authentication as defined in Section 6 of <span style="font-weight: bold">XMPP Core</span>
</li>
          <li>Resource Binding as defined in Section 7 of <span style="font-weight: bold">XMPP Core</span>
</li>
          <li>IM Session Establishment as defined in Section 3 of <span style="font-weight: bold">XMPP IM</span>, if appropriate</li>
        </ol>
      </li>
      <li>
        <p class="" style="">Simultaneous authentication and resource binding as defined in <span style="font-weight: bold">Non-SASL Authentication</span>, upon which a Jabber server will also establish an IM session on behalf of the connected resource.</p>
      </li>
    </ul>
    <p class="" style="">It is RECOMMENDED to use the XMPP methods as defined in <span style="font-weight: bold">XMPP Core</span> and <span style="font-weight: bold">XMPP IM</span>, rather than using older non-SASL authentication.</p>

    <div class="indent">
<h3>8.1 <a name="preconditions-xmpp">XMPP Methods</a>
</h3>
      <p class="" style="">A success case for authentication, resource binding, and IM session establishment using the XMPP protocols is shown below. For detailed specification of these protocols (including error cases) and for specification of TLS negotiation, refer to <span style="font-weight: bold">XMPP Core</span> and <span style="font-weight: bold">XMPP IM</span>.</p>
      <p class="caption">Example 4. SASL authentication step 1</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 172

&lt;body rid='3197423131'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='DIGEST-MD5'/&gt;
&lt;/body&gt;</pre></div>



      <p class="caption">Example 5. SASL authentication step 2</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 250

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;challenge xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
    cmVhbG09InNvbWVyZWFsbSIsbm9uY2U9Ik9BNk1HOXRFUUdtMmhoIixxb3A9
    ImF1dGgiLGNoYXJzZXQ9dXRmLTgsYWxnb3JpdGhtPW1kNS1zZXNzCg==
  &lt;/challenge&gt;
&lt;/body&gt;</pre></div>


      <p class="caption">Example 6. SASL authentication step 3</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 418

&lt;body rid='3197423132'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
    dXNlcm5hbWU9InNvbWVub2RlIixyZWFsbT0ic29tZXJlYWxtIixub25jZT0i
    T0E2TUc5dEVRR20yaGgiLGNub25jZT0iT0E2TUhYaDZWcVRyUmsiLG5jPTAw
    MDAwMDAxLHFvcD1hdXRoLGRpZ2VzdC11cmk9InhtcHAvZXhhbXBsZS5jb20i
    LHJlc3BvbnNlPWQzODhkYWQ5MGQ0YmJkNzYwYTE1MjMyMWYyMTQzYWY3LGNo
    YXJzZXQ9dXRmLTgK
&lt;/response&gt;
&lt;/body&gt;</pre></div>


      <p class="caption">Example 7. SASL authentication step 4</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 190

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;challenge xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;
    cnNwYXV0aD1lYTQwZjYwMzM1YzQyN2I1NTI3Yjg0ZGJhYmNkZmZmZAo=
  &lt;/challenge&gt;
&lt;/body&gt;</pre></div>


      <p class="caption">Example 8. SASL authentication step 5</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 152

&lt;body rid='3197423133'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/&gt;
&lt;/body&gt;</pre></div>

      <p class="caption">Example 9. SASL authentication step 6</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 121

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;success xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/&gt;
&lt;/body&gt;</pre></div>

      <p class="" style="">Note: Because the context for a client's communication with a connection manager in the HTTP transport binding is HTTP rather than XML streams (as in the TCP binding), there is no need to re-start communications (e.g., by generating a new SID) at this point.</p>

      <p class="caption">Example 10. Resource binding request</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Content-Type: text/xml; charset=utf-8
Content-Length: 240

&lt;body rid='3197423134'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;iq id='bind_1'
      type='set'
      xmlns='jabber:client'&gt;
    &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'&gt;
      &lt;resource&gt;httpclient&lt;/resource&gt;
    &lt;/bind&gt;
  &lt;/iq&gt;
&lt;/body&gt;</pre></div>

      <p class="caption">Example 11. Resource binding result</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 221

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;iq id='bind_1'
      type='result'
      xmlns='jabber:client'&gt;
    &lt;bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'&gt;
      &lt;jid&gt;stpeter@jabber.org/httpclient&lt;/jid&gt;
    &lt;/bind&gt;
  &lt;/iq&gt;
&lt;/body&gt;</pre></div>

      <p class="caption">Example 12. IM session request</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Content-Type: text/xml; charset=utf-8
Content-Length: 261

&lt;body rid='3197423135'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;iq from='stpeter@jabber.org/httpclient'
      id='sess_1'
      to='jabber.org'
      type='set'
      xmlns='jabber:client'&gt;
    &lt;session xmlns='urn:ietf:params:xml:ns:xmpp-session'/&gt;
  &lt;/iq&gt;
&lt;/body&gt;</pre></div>

      <p class="caption">Example 13. IM session result</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 175

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;iq from='jabber.org'
      id='sess_1'
      to='stpeter@jabber.org/httpclient'
      type='result'
      xmlns='jabber:client'/&gt;
&lt;/body&gt;</pre></div>

    </div>

    <div class="indent">
<h3>8.2 <a name="preconditions-iqauth">jabber:iq:auth</a>
</h3>
      <p class="" style="">A success case for simultaneous authentication, resource binding, and IM session creation using the original &quot;jabber:iq:auth&quot; protocol is shown below. For further details regarding use of this protocol, refer to JEP-0078. If digest authentication is used, then the stream ID value used to compute the hashed password MUST be the value of the 'authid' attribute provided by the connection manager in the response to the initialization element or in a subsequent response (see the <a href="#session-create">Session Creation</a> section above).</p>
      <p class="caption">Example 14. Non-SASL authentication request</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 281

&lt;body rid='2842791421'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;iq id='A01'
      type='set'
      xmlns='jabber:client'&gt;
    &lt;query xmlns='jabber:iq:auth'&gt;
      &lt;username&gt;stpeter&lt;/username&gt;
      &lt;resource&gt;httpclient&lt;/resource&gt;
      &lt;password&gt;jabber-rocks&lt;/password&gt;
    &lt;/query&gt;
  &lt;/iq&gt;
&lt;/body&gt;</pre></div>
      <p class="caption">Example 15. Authentication result (success)</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 144

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;iq id='A01'
      type='result'
      xmlns='jabber:client'/&gt;
&lt;/body&gt;</pre></div>
      <p class="caption">Example 16. Authentication result (failure)</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 226

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;iq id='A01'
      type='error'
      xmlns='jabber:client'&gt;
    &lt;error code='401' type='auth'&gt;
      &lt;not-authorized xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;/error&gt;
  &lt;/iq&gt;
&lt;/body&gt;</pre></div>
    </div>
  <h2>9.
       <a name="stanzas">Sending and Receiving XML Stanzas</a>
</h2>
    <p class="" style="">After the client has successfully completed all required preconditions, it can send and receive XML stanzas via the HTTP binding.</p>
    <p class="caption">Example 17. Transmitting stanzas</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 188

&lt;body rid='2842791422'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;message to='contact@example.com'
           xmlns='jabber:client'&gt;
    &lt;body&gt;Hi there!&lt;/body&gt;
  &lt;/message&gt;
  &lt;message to='friend@example.com'
           xmlns='jabber:client'&gt;
    &lt;body&gt;Hi there!&lt;/body&gt;
  &lt;/message&gt;
&lt;/body&gt;</pre></div>
    <p class="" style="">Upon receipt of a request, the connection manager MUST forward the content of the &lt;body/&gt; element to the XMPP server as soon as possible. However, it must forward the content from different requests in the order specified by their 'rid' attributes.</p>
    <p class="" style="">The connection manager MUST also return an HTTP 200 OK response with a &lt;body/&gt; element to the client. Note: This does not indicate that the stanzas have been successfully delivered to the destination Jabber endpoint.</p>
    <p class="" style="">It is RECOMMENDED that the connection manager not return an HTTP result until a stanza has arrived from the XMPP server for delivery to the client. However, the connection manager SHOULD NOT wait longer than the time specified by the client in the 'wait' attribute of its session creation request, and it SHOULD NOT keep more HTTP requests waiting at a time than the number specified in the 'hold' attribute of the session creation request. In any case it MUST respond to requests in the order specified by their 'rid' attributes.</p>
    <p class="" style="">If there are no stanzas waiting or ready to be delivered within the waiting period, then the connection manager SHOULD include an empty &lt;body/&gt; element in the HTTP result:</p>
    <p class="caption">Example 18. Empty response</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 64

&lt;body xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
    <p class="" style="">If the connection manager has received one or more stanzas from the XMPP server for delivery to the client, then it SHOULD return the stanzas in the body of its response as soon as possible after receiving them from the XMPP server.</p>
    <p class="caption">Example 19. Response with queued stanza</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 185

&lt;body xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;message from='contact@example.com'
           to='user@example.com'
           xmlns='jabber:client'&gt;
    &lt;body&gt;Hi yourself!&lt;/body&gt;
  &lt;/message&gt;
  &lt;message from='friend@example.com'
           to='user@example.com'
           xmlns='jabber:client'&gt;
    &lt;body&gt;Hi yourself!&lt;/body&gt;
  &lt;/message&gt;
&lt;/body&gt;</pre></div>
    <p class="" style="">The client MAY poll the connection manager for incoming stanzas by sending an empty &lt;body/&gt; element.</p>
    <p class="caption">Example 20. Requesting XML Stanzas</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 88

&lt;body rid='2842791423'
      sid='SomeSID'
      xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
    <p class="" style="">The connection manager MUST wait and respond in the same way as it does after receiving stanzas from the client.</p>
    <p class="" style="">If the client sends two consecutive empty requests within a period shorter than that specified by the 'polling' attribute in the session creation response, then the connection manager SHOULD terminate the HTTP session and return an HTTP 403 (Forbidden) error to the client.</p>
    <p class="caption">Example 21. Too frequent polling response</p>
<div class="indent"><pre>
HTTP/1.1 403 Forbidden
Content-Type: text/xml; charset=utf-8
Content-Length: 0</pre></div>
    <p class="" style="">If the connection manager did not specify a shortest allowable polling interval in the session creation response, then it MUST allow the client to poll as frequently as it chooses.</p>
    <p class="" style="">After receiving a response from the connection manager, if no other requests are pending and the client did not specify polling behavior in the session creation request (by setting 'wait' or 'hold' to &quot;0&quot;), it SHOULD make a new request as soon as possible. In any case, if no requests are pending, the client MUST make a new request before the maximum inactivity period has expired. This period is specified by the 'inactivity' attribute in the session creation response.</p>
    <p class="" style="">If the connection manager has responded to all the requests it has received and the time since its last response is longer than the maximum inactivity period, then it SHOULD terminate the session without informing the client (if the client makes another request, the connection manager SHOULD respond as if the session does not exist).</p>
    <p class="" style="">If the connection manager did not specify a maximum inactivity period in the session creation response, then it MUST allow the client to be inactive for as long as it chooses.</p>
  <h2>10.
       <a name="terminate">Terminating the HTTP Session</a>
</h2>
    <p class="" style="">At any time, the client MAY gracefully terminate the session by sending a &lt;body/&gt; element with a 'type' attribute set to &quot;terminate&quot;. The termination request SHOULD include an XMPP presence stanza of type &quot;unavailable&quot; to ensure graceful logoff with the XMPP server.</p>
    <p class="caption">Example 22. Session termination by client</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 153

&lt;body rid='2842791424'
      sid='SomeSID'
      type='terminate'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;presence type='unavailable'
            xmlns='jabber:client'/&gt;
&lt;/body&gt;</pre></div>
    <p class="" style="">The connection manager SHOULD return an HTTP 200 OK response with an empty &lt;body/&gt; element. Upon receiving the response, the client MUST consider the HTTP session to have been terminated.</p>
  <h2>11.
       <a name="rids">Request IDs</a>
</h2>
    <div class="indent">
<h3>11.1 <a name="rids-order">In-Order Message Forwarding</a>
</h3>
      <p class="" style="">When a client makes simultaneous requests, the connection manager may receive them out of order. The connection manager MUST forward the stanzas to the XMPP server and respond to the client requests in the order specified by the 'rid' attributes. The client MUST process responses received from the connection manager in the order the requests were made.</p>
      <p class="" style="">The connection manager SHOULD expect the 'rid' attribute to be within a window of values greater than the 'rid' of the previous request. The size of the window is equal to the maximum number of simultaneous requests allowed by the connection manager. If it receives a request with a 'rid' greater than the values in the window, then the connection manager MUST terminate the session with an error:</p>
      <p class="caption">Example 23. Unexpected rid error</p>
<div class="indent"><pre>
HTTP/1.1 401 Unauthorized
Content-Type: text/xml; charset=utf-8
Content-Length: 0</pre></div>
    </div>
    <div class="indent">
<h3>11.2 <a name="rids-broken">Broken Connections</a>
</h3>
      <p class="" style="">Unreliable network communications or client constraints can result in broken connections. The connection manager SHOULD remember the 'rid' and the associated HTTP response body of the client's most recent requests which did not result in an HTTP or binding error. The number of responses kept in the buffer should be the same as the maximum number of simultaneous requests allowed by the connection manager.</p>
      <p class="" style="">If the network connection is broken or closed before the client receives a response to a request from the connection manager, then the client MAY resend an exact copy of the original request. Whenever the connection manager receives a request with a 'rid' that it has already received, it SHOULD return an HTTP 200 (OK) response that includes the buffered copy of the original XML response to the client (i.e., a &lt;body/&gt; wrapper element possessing appropriate attributes and optionally containing one or more XML stanzas or other allowable XML elements). If the original response is not available (e.g., it is no longer in the buffer), then the connection manager MUST return an HTTP 401 (Unauthorized) error:</p>
      <p class="caption">Example 24. Response not in buffer error</p>
<div class="indent"><pre>
HTTP/1.1 401 Unauthorized
Content-Type: text/xml; charset=utf-8
Content-Length: 0</pre></div>
      <p class="" style="">Note: The error is the same whether the 'rid' is too large or too small. This makes it more difficult for an attacker to discover an acceptable value.</p>
    </div>
  <h2>12.
       <a name="keys">Protecting Insecure Sessions</a>
</h2>
    <div class="indent">
<h3>12.1 <a name="keys-applic">Applicability</a>
</h3>
      <p class="" style="">The OPTIONAL key sequencing mechanism described here MAY be used if the client's session with the connection manager is not secure. The session should be considered secure only if all client requests are made via TLS/SSL HTTP connections and the connection manager generates an unpredictable session ID. If the session is secure, it is not necessary to use this key sequencing mechanism.</p>
      <p class="" style="">Even if the session is not secure, the unpredictable session and request IDs specified in the preceding sections of this document already provide a level of protection similar to that provided by a standard XMPP connection bound to a single pair of persistent TCP/IP connections, and thus provide sufficient protection against a 'blind' attacker. However, in some circumstances, the key sequencing mechanism defined below helps to protect against a more determined and knowledgeable attacker.</p>
      <p class="" style="">It is important to recognize that the key sequencing mechanism defined below helps to protect only against an attacker who is able to view the contents of all requests or responses in an insecure session but who is not able to alter the contents of those requests (in this case, the mechanism prevents the attacker from interjecting HTTP requests into the session, e.g., termination requests or responses). However, the key sequencing mechanism does not provide any protection when the attacker is able to alter the contents of insecure requests or responses.</p>
    </div>
    <div class="indent">
<h3>12.2 <a name="keys-intro">Introduction</a>
</h3>
      <p class="" style="">The HTTP requests of each session MAY be spread across a series of different socket connections. This would enable an unauthorized user that obtains the session ID and request ID of a session and then use their own socket connection to interject &lt;body/&gt; request elements into the session and receive the corresponding responses.</p>
      <p class="" style="">The key sequencing mechanism below protects against such attacks by enabling a connection manager to detect &lt;body/&gt; request elements interjected by a third party.</p>
    </div>
    <div class="indent">
<h3>12.3 <a name="keys-generate">Generating the Key Sequence</a>
</h3>
      <p class="" style="">Prior to requesting a new session, the client MUST select an unpredictable counter (&quot;n&quot;) and an unpredictable value (&quot;seed&quot;). The client then processes the &quot;seed&quot; through a cryptographic hash and converts the resulting 160 bits to a hexadecimal string K(1). It does this &quot;n&quot; times to arrive at the initial key K(n). The hashing algorithm MUST be SHA-1 as defined in <span class="ref">RFC 3174</span>  [<a href="#nt-id2604470">11</a>].</p>
      <p class="caption">Example 25. Creating the key sequence</p>
<div class="indent"><pre>
        K(1) = hex(SHA-1(seed))
        K(2) = hex(SHA-1(K(1)))
        ...
        K(n) = hex(SHA-1(K(n-1)))
      </pre></div>
    </div>
    <div class="indent">
<h3>12.4 <a name="keys-use">Use of Keys</a>
</h3>
      <p class="" style="">The client MUST set the 'newkey' attribute of the first request in the session to the value K(n).</p>
      <p class="caption">Example 26. Session Request with Initial Key</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 104

&lt;body content='text/xml; charset=utf-8'
      hold='1'
      rid='3197423130'
      to='jabber.org'
      wait='60'
      xml:lang='en'
      newkey='ca393b51b682f61f98e7877d61146407f3d0a770'
      xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
    <p class="" style="">The client MUST set the 'key' attribute of all subsequent requests to the value of the next key in the generated sequence (decrementing from K(n-1) towards K(1) with each request sent).</p>
    <p class="caption">Example 27. Request with Key</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 88

&lt;body rid='3197423131'
      sid='SomeSID'
      key='bfb06a6f113cd6fd3838ab9d300fdb4fe3da2f7d'
      xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
      <p class="" style="">The connection manager MAY verify the key by calculating the SHA-1 hash of the key and comparing it to the 'newkey' attribute of the previous request (or the 'key' attribute if the 'newkey' attribute was not set). If the values do not match (or if it receives a request without a 'key' attribute and the 'newkey' or 'key' attribute of the previous request was set), then the connection manager MUST NOT process the element, MUST terminate the session, and MUST return an HTTP 401 (Unauthorized) error.</p>
      <p class="caption">Example 28. Invalid Key Sequence Error</p>
<div class="indent"><pre>
HTTP/1.1 401 Unauthorized
Content-Type: text/xml; charset=utf-8
Content-Length: 0</pre></div>
    </div>
    <div class="indent">
<h3>12.5 <a name="keys-switch">Switching to Another Key Sequence</a>
</h3>
      <p class="" style="">A client SHOULD choose a high value for &quot;n&quot; when generating the key sequence. However, if the session lasts long enough that the client arrives at the last key in the sequence K(1) then the client MUST switch to a new key sequence.</p>
      <p class="" style="">The client MUST:</p>
      <ol start="" type="">
        <li>Choose new values for &quot;seed&quot; and &quot;n&quot;.</li>
        <li>Generate a new key sequence using the algorithm defined above.</li>
        <li>Set the 'key' attribute of the request to the next value in the old sequence (i.e. K(1), the last value).</li>
        <li>Set the 'newkey' attribute of the request to the value K(n) from the new sequence.</li>
      </ol>
      <p class="caption">Example 29. New Key Sequence</p>
<div class="indent"><pre>
POST /webclient HTTP/1.1
Host: httpcm.jabber.org
Content-Type: text/xml; charset=utf-8
Content-Length: 188

&lt;body rid='3197423132'
      sid='SomeSID'
      key='6f825e81f4532b2c5fa2d12457d8a1f22e8f838e'
      newkey='113f58a37245ec9637266cf2fb6e48bfeaf7964e'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;message to='contact@example.com'
           xmlns='jabber:client'&gt;
    &lt;body&gt;Hi there!&lt;/body&gt;
  &lt;/message&gt;
&lt;/body&gt;</pre></div>
    </div>
  <h2>13.
       <a name="errorstatus">Error and Status Codes</a>
</h2>
    <p class="" style="">There are four types of error and status reporting in HTTP responses:</p>
    <p class="caption">Table 1: Error Condition Types</p>
<table border="1" cellpadding="3" cellspacing="0">
      <tr class="body">
<th colspan="" rowspan="">Condition Type</th>
<th colspan="" rowspan="">Description</th>
</tr>
      <tr class="body">
<td align="" colspan="" rowspan=""><span style="font-weight: bold">HTTP Conditions</span></td>
<td align="" colspan="" rowspan="">The connection manager responds to an invalid client request with a standard HTTP error. These are used for binding syntax errors, possible attacks, etc. Note that constrained clients are unable to differentiate between HTTP errors.</td>
</tr>
      <tr class="body">
<td align="" colspan="" rowspan=""><span style="font-weight: bold">Terminal Binding Conditions</span></td>
<td align="" colspan="" rowspan="">These error conditions may be read by constrained clients. They are used for connection manager problems, abstracting stream errors, and communication problems between the connection manager and the XMPP server.</td>
</tr>
      <tr class="body">
<td align="" colspan="" rowspan=""><span style="font-weight: bold">Recoverable Binding Conditions</span></td>
<td align="" colspan="" rowspan="">These report communication problems between the connection manager and the client. They do not terminate the session. Clients recover from these errors by resending the last two &lt;body/&gt; wrapper elements.</td>
</tr>
      <tr class="body">
<td align="" colspan="" rowspan=""><span style="font-weight: bold">XMPP Stanza Conditions</span></td>
<td align="" colspan="" rowspan="">XMPP errors relating to XML stanzas within &lt;body/&gt; wrapper elements are, in general, defined in the appropriate RFC or JEP. They do not terminate the session. An example of such usage is shown above in relation to <span style="font-weight: bold">Non-SASL Authentication</span>.</td>
</tr>
    </table>
    <p class="" style="">Full descriptions are provided below.</p>
    <div class="indent">
<h3>13.1 <a name="errorstatus-http">HTTP Conditions</a>
</h3>
      <p class="" style="">The following HTTP error and status codes are used in particular ways by this protocol (other HTTP error and status codes may be used as appropriate). Upon receiving an HTTP error (200, 400, 401, 403), the HTTP client MUST consider the HTTP session to be null and void.</p>
      <p class="" style="">Note: These are pure HTTP codes as defined in the HTTP specification, and are not to be confused with the HTTP-style error codes traditionally used in Jabber protocols and documented in <span class="ref">Error Condition Mappings</span>  [<a href="#nt-id2604874">12</a>].</p>
      <p class="caption">Table 2: HTTP Error and Status Codes</p>
<table border="1" cellpadding="3" cellspacing="0">
        <tr class="body">
          <th colspan="" rowspan="">Code</th>
          <th colspan="" rowspan="">Name</th>
          <th colspan="" rowspan="">Purpose</th>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">200</td>
          <td align="" colspan="" rowspan="">OK</td>
          <td align="" colspan="" rowspan="">Response to valid client request.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">400</td>
          <td align="" colspan="" rowspan="">Bad Request</td>
          <td align="" colspan="" rowspan="">Inform client that the format of an HTTP header or binding element is unacceptable (e.g., syntax error).</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">401</td>
          <td align="" colspan="" rowspan="">Unauthorized</td>
          <td align="" colspan="" rowspan="">Inform client that (1) 'sid' is not valid, (2) 'rid' is larger than the upper limit of the expected window, (3) connection manager is unable to resend response, (4) 'key' sequence is invalid.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">403</td>
          <td align="" colspan="" rowspan="">Forbidden</td>
          <td align="" colspan="" rowspan="">Inform client that it has broken the session rules (polling too-frequently, too many simultaneous connections).</td>
        </tr>
      </table>
    </div>
    <div class="indent">
<h3>13.2 <a name="errorstatus-terminal">Terminal Binding Conditions</a>
</h3>
      <p class="" style="">In any response it sends to the client, the connection manager MAY return a fatal error by setting a 'type' attribute of the &lt;body/&gt; element to &quot;terminate&quot;. These binding errors imply that the HTTP session is terminated. (Note: Many of these conditions correspond to the relevant XMPP stream error conditions specified in <span style="font-weight: bold">XMPP Core</span>, but actual XMPP stream error conditions experienced between the connection manager and the server are contained only in the &quot;remote-stream-error&quot; condition as described below.)</p>
      <p class="caption">Example 30. Remote connection failed error</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 68

&lt;body type='terminate'
      condition='remote-connection-failed'
      xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
      <p class="" style="">The following values of the 'condition' attribute are defined:</p>
      <p class="caption">Table 3: Binding Error Conditions</p>
<table border="1" cellpadding="3" cellspacing="0">
        <tr class="body">
          <th colspan="" rowspan="">Condition</th>
          <th colspan="" rowspan="">Purpose</th>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">host-gone</td>
          <td align="" colspan="" rowspan="">The target hostname specified in the 'to' attribute is no longer serviced by the connection manager.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">host-unknown</td>
          <td align="" colspan="" rowspan="">The target hostname specified in the 'to' attribute is unknown to the connection manager.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">improper-addressing</td>
          <td align="" colspan="" rowspan="">The initialization element lacks a 'to' attribute (or the attribute has no value) but the connection manager requires one.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">internal-server-error</td>
          <td align="" colspan="" rowspan="">The connection manager has experienced an internal error that prevents it from servicing the request.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">other-request</td>
          <td align="" colspan="" rowspan="">Another request being processed at the same time as this request caused the session to terminate.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">remote-connection-failed</td>
          <td align="" colspan="" rowspan="">The connection manager was unable to connect to, or has lost its connection to, the XMPP server.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">remote-stream-error</td>
          <td align="" colspan="" rowspan="">Encapsulates an XMPP stream error. The content of the binding is a copy of the content of the &lt;stream:error/&gt; element received from the XMPP server.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">see-other-uri</td>
          <td align="" colspan="" rowspan="">The connection manager does not operate at this URI (e.g., the connection manager accepts only SSL/TLS connections at some https: URI rather than the http: URI requested by the client). The client may try POSTing to the URI in the content of the &lt;uri/&gt; child element.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">system-shutdown</td>
          <td align="" colspan="" rowspan="">The connection manager is being shut down. All active HTTP sessions are being terminated. No new sessions can be created.</td>
        </tr>
        <tr class="body">
          <td align="" colspan="" rowspan="">undefined-condition</td>
          <td align="" colspan="" rowspan="">The error is not one of those defined herein; the connection manager SHOULD include application-specific information in the content of the &lt;body/&gt; wrapper element.</td>
        </tr>
      </table>
      <p class="" style="">The following is an example of a &quot;see-other-uri&quot; condition:</p>
      <p class="caption">Example 31. See other URI error</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 68

&lt;body condition='see-other-uri'
      type='terminate'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;uri&gt;https://secure.jabber.org/xmppcm&lt;/uri&gt;
&lt;/body&gt;</pre></div>
      <p class="" style="">The following is an example of a &quot;remote-stream-error&quot; condition:</p>
      <p class="caption">Example 32. Remote error</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 68

&lt;body condition='remote-stream-error'
      type='terminate'
      xmlns='http://jabber.org/protocol/httpbind'&gt;
  &lt;xml-not-well-formed xmlns='urn:ietf:params:xml:ns:xmpp-streams'/&gt;
  &lt;text xmlns='urn:ietf:params:xml:ns:xmpp-streams'
        xml:lang='en'&gt;
    Some special application diagnostic information!
  &lt;/text&gt;
  &lt;escape-your-data xmlns='application-ns'/&gt;
&lt;/body&gt;</pre></div>
      <p class="" style="">Naturally, the client MAY report binding errors to the connection manager as well, although this is unlikely.</p>
    </div>
    <div class="indent">
<h3>13.3 <a name="errorstatus-recover">Recoverable Binding Conditions</a>
</h3>
      <p class="" style="">In any response it sends to the client, the connection manager MAY return a recoverable error by setting a 'type' attribute of the &lt;body/&gt; element to &quot;error&quot;. These errors do not imply that the HTTP session is terminated.</p>
      <p class="" style="">If it decides to recover from the error, then the client MUST repeat the HTTP request and the previous HTTP request. The content of both requests MUST be identical to the &lt;body/&gt; elements of the original requests. This allows the server to recover a session after the previous request was lost due to a communication failure.</p>
      <p class="caption">Example 33. Recoverable error</p>
<div class="indent"><pre>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: 68

&lt;body type='error'
      xmlns='http://jabber.org/protocol/httpbind'/&gt;</pre></div>
    </div>
    <div class="indent">
<h3>13.4 <a name="errorstatus-stanza">XMPP Stanza Conditions</a>
</h3>
      <p class="" style="">Application-level error conditions will normally be generated by a third entity (e.g., an IM contact) and routed to the client through the connection manager; therefore they are out of scope for the transport binding defined herein and are described in the appropriate RFC or JEP.</p>
      <p class="" style="">However, it is possible that a connection manager will receive a stanza for delivery to a client even though the client connection is no longer active (e.g., before the connection manager is able to inform a server that the connection has died). In this case, the connection manager would return an error to the server; it is RECOMMENDED that the connection manager proceed as follows, since the situation is similar to that addressed by point #2 of Section 11.1 of <span style="font-weight: bold">XMPP IM</span>:</p>
      <ol start="" type="">
        <li>If the delivered stanza was &lt;presence/&gt;, silently drop the stanza and do not return an error to the sender.</li>
        <li>If the delivered stanza was &lt;iq/&gt;, return a &lt;service-unavailable/&gt; error to the sender.</li>
        <li>If the delivered stanza was &lt;message/&gt;, return a &lt;recipient-unavailable/&gt; error to the sender.</li>
      </ol>
      <p class="" style="">When a server receives a &lt;message/&gt; stanza of type &quot;error&quot; containing a &lt;recipient-unavailable/&gt; condition from a connection manager, it SHOULD store the message for later delivery if offline storage is enabled, otherwise route the error stanza to the sender.</p>
    </div>
  <h2>14.
       <a name="security">Security Considerations</a>
</h2>
    <p class="" style="">Communications SHOULD occur over an encrypted channel. Negotiation of channel encryption SHOULD occur at the HTTP layer, not the application layer; such negotiation SHOULD follow the protocol defined in <span class="ref">RFC 2817</span>  [<a href="#nt-id2605576">13</a>].</p>
    <p class="" style="">The session identifier (SID) and initial request identifier (RID) are security-critical and therefore MUST be both unpredictable and nonrepeating (see <span class="ref">RFC 1750</span>  [<a href="#nt-id2605612">14</a>] for recommendations regarding randomness of SIDs and initial RIDs for security purposes).</p>
  <h2>15.
       <a name="iana">IANA Considerations</a>
</h2>
    <p class="" style="">This JEP requires no interaction with the <span class="ref">Internet Assigned Numbers Authority (IANA)</span>  [<a href="#nt-id2605661">15</a>].</p>
  <h2>16.
       <a name="registrar">Jabber Registrar Considerations</a>
</h2>
    <div class="indent">
<h3>16.1 <a name="registrar-ns">Protocol Namespaces</a>
</h3>
      <p class="" style="">Upon advancement of this proposal to a status of Draft, the <span class="ref">Jabber Registrar</span>  [<a href="#nt-id2605714">16</a>] shall add 'http://jabber.org/protocol/httpbind' to its registry of protocol namespaces.</p>
    </div>
  <h2>17.
       <a name="schema">XML Schema</a>
</h2>
    <p class="caption"></p>
<div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    xmlns:stream='http://etherx.jabber.org/streams'
    targetNamespace='http://jabber.org/protocol/httpbind'
    xmlns='http://jabber.org/protocol/httpbind'
    elementFormDefault='qualified'&gt;

  &lt;xs:import namespace='http://etherx.jabber.org/streams'
             schemaLocation='http://etherx.jabber.org/streams.xsd'/&gt;

  &lt;xs:element name='body'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:choice xmlns:stream='http://etherx.jabber.org/streams'&gt;
        &lt;xs:element ref='stream:features'
                minOccurs='0'
                maxOccurs='1'/&gt;
        &lt;xs:any namespace='urn:ietf:params:xml:ns:xmpp-tls'
                minOccurs='0'
                maxOccurs='1'/&gt;
        &lt;xs:any namespace='urn:ietf:params:xml:ns:xmpp-sasl'
                minOccurs='0'
                maxOccurs='1'/&gt;
        &lt;xs:any namespace='urn:ietf:params:xml:ns:xmpp-streams'
                minOccurs='0'
                maxOccurs='1'/&gt;
        &lt;xs:any namespace='jabber:client'
                minOccurs='0'
                maxOccurs='unbounded'/&gt;
        &lt;xs:element name='uri'
                minOccurs='0'
                maxOccurs='1'
                type='xs:string'/&gt;
      &lt;/xs:choice&gt;
      &lt;xs:attribute name='authid' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='condition' use='optional'&gt;
        &lt;xs:simpleType&gt;
          &lt;xs:restriction base='xs:NCName'&gt;
            &lt;xs:enumeration value='host-gone'/&gt;
            &lt;xs:enumeration value='host-unknown'/&gt;
            &lt;xs:enumeration value='improper-addressing'/&gt;
            &lt;xs:enumeration value='internal-server-error'/&gt;
            &lt;xs:enumeration value='remote-connection-failed'/&gt;
            &lt;xs:enumeration value='remote-stream-error'/&gt;
            &lt;xs:enumeration value='see-other-uri'/&gt;
            &lt;xs:enumeration value='system-shutdown'/&gt;
            &lt;xs:enumeration value='undefined-condition'/&gt;
          &lt;/xs:restriction&gt;
        &lt;/xs:simpleType&gt;
      &lt;/xs:attribute&gt;
      &lt;xs:attribute name='content' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='hold' type='xs:byte' use='optional'/&gt;
      &lt;xs:attribute name='inactivity' type='xs:byte' use='optional'/&gt;
      &lt;xs:attribute name='key' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='newkey' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='polling' type='xs:byte' use='optional'/&gt;
      &lt;xs:attribute name='requests' type='xs:byte' use='optional'/&gt;
      &lt;xs:attribute name='rid' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='sid' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='to' type='xs:string' use='optional'/&gt;
      &lt;xs:attribute name='type' type='xs:string' use='optional'&gt;
        &lt;xs:simpleType&gt;
          &lt;xs:restriction base='xs:NCName'&gt;
            &lt;xs:enumeration value='error'/&gt;
            &lt;xs:enumeration value='terminate'/&gt;
          &lt;/xs:restriction&gt;
        &lt;/xs:simpleType&gt;
      &lt;/xs:attribute&gt;
      &lt;xs:attribute name='wait' type='xs:byte' use='optional'/&gt;
      &lt;xs:attribute name='xml:lang' type='xs:string' use='optional'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

&lt;/xs:schema&gt;
    </pre></div>
  <p><hr></p>
<a name="notes"></a><h2>Notes</h2>
<p>
<a name="nt-id2596359">1</a>. RFC 3920: Extensible Messaging and Presence Protocol (XMPP): Core &lt;<a href="http://www.ietf.org/rfc/rfc3920.txt">http://www.ietf.org/rfc/rfc3920.txt</a>&gt;.</p>
<p>
<a name="nt-id2596381">2</a>. RFC 793: Transmission Control Protocol &lt;<a href="http://www.ietf.org/rfc/rfc0793.txt">http://www.ietf.org/rfc/rfc0793.txt</a>&gt;.</p>
<p>
<a name="nt-id2596396">3</a>. RFC 2068: Hypertext Transport Protocol -- HTTP/1.1 &lt;<a href="http://www.ietf.org/rfc/rfc2068.txt">http://www.ietf.org/rfc/rfc2068.txt</a>&gt;.</p>
<p>
<a name="nt-id2596296">4</a>. RFC 1945: Hypertext Transfer Protocol -- HTTP/1.0 &lt;<a href="http://www.ietf.org/rfc/rfc1945.txt">http://www.ietf.org/rfc/rfc1945.txt</a>&gt;.</p>
<p>
<a name="nt-id2596329">5</a>. RFC 2965: HTTP State Management Mechanism &lt;<a href="http://www.ietf.org/rfc/rfc2965.txt">http://www.ietf.org/rfc/rfc2965.txt</a>&gt;.</p>
<p>
<a name="nt-id2601972">6</a>. JEP-0025: Jabber HTTP Polling &lt;<a href="http://www.jabber.org/jeps/jep-0025.html">http://www.jabber.org/jeps/jep-0025.html</a>&gt;.</p>
<p>
<a name="nt-id2601912">7</a>. RFC 3921: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence &lt;<a href="http://www.ietf.org/rfc/rfc3921.txt">http://www.ietf.org/rfc/rfc3921.txt</a>&gt;.</p>
<p>
<a name="nt-id2602267">8</a>. JEP-0114: Jabber Component Protocol &lt;<a href="http://www.jabber.org/jeps/jep-0114.html">http://www.jabber.org/jeps/jep-0114.html</a>&gt;.</p>
<p>
<a name="nt-id2602565">9</a>. Extensible Markup Language (XML) 1.0 (Third Edition) &lt;<a href="http://www.w3.org/TR/REC-xml/">http://www.w3.org/TR/REC-xml/</a>&gt;.</p>
<p>
<a name="nt-id2602849">10</a>. JEP-0078: Non-SASL Authentication &lt;<a href="http://www.jabber.org/jeps/jep-0078.html">http://www.jabber.org/jeps/jep-0078.html</a>&gt;.</p>
<p>
<a name="nt-id2604470">11</a>. RFC 3174: US Secure Hash Algorithm 1 (SHA1) &lt;<a href="http://www.ietf.org/rfc/rfc3174.txt">http://www.ietf.org/rfc/rfc3174.txt</a>&gt;.</p>
<p>
<a name="nt-id2604874">12</a>. JEP-0086: Error Condition Mappings &lt;<a href="http://www.jabber.org/jeps/jep-0086.html">http://www.jabber.org/jeps/jep-0086.html</a>&gt;.</p>
<p>
<a name="nt-id2605576">13</a>. RFC 2817: Upgrading to TLS Within HTTP/1.1 &lt;<a href="http://www.ietf.org/rfc/rfc2817.txt">http://www.ietf.org/rfc/rfc2817.txt</a>&gt;.</p>
<p>
<a name="nt-id2605612">14</a>. RFC 1750: Randomness Recommendations for Security &lt;<a href="http://www.ietf.org/rfc/rfc1750.txt">http://www.ietf.org/rfc/rfc1750.txt</a>&gt;.</p>
<p>
<a name="nt-id2605661">15</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p>
<p>
<a name="nt-id2605714">16</a>. The Jabber Registrar maintains a list of reserved Jabber protocol namespaces as well as registries of parameters used in the context of protocols approved by the Jabber Software Foundation. For further information, see &lt;<a href="http://www.jabber.org/registrar/">http://www.jabber.org/registrar/</a>&gt;.</p>
<p><hr></p>
<a name="revs"></a><h2>Revision History</h2>
<div class="indent">
<h4>Version 0.8 (2004-10-26)</h4>
<div class="indent">Specified that wait attribute must be included in the session creation response. (ip)
    </div>
<h4>Version 0.7 (2004-08-12)</h4>
<div class="indent">Defined appropriate XMPP stanza error conditions. (psa/ip)
    </div>
<h4>Version 0.6 (2004-07-19)</h4>
<div class="indent">Added xml:lang attribute to the session request; added recoverable binding error conditions. (ip)
    </div>
<h4>Version 0.5 (2004-05-07)</h4>
<div class="indent">Protocol refactored to enable simultaneous requests (request identifier attribute, wait attribute, hold attribute, requests attribute) and recovery of broken connections; added content attribute; removed all wrapper types except 'terminate'; updated error handling; made key mechanism optional (should use SSL/TLS instead). (ip/psa)
    </div>
<h4>Version 0.4 (2004-02-23)</h4>
<div class="indent">Fixed typos; removed &quot;resource-constraint&quot; binding error; added HTTP 403 error to table. (psa/ip)
    </div>
<h4>Version 0.3 (2004-02-19)</h4>
<div class="indent">Added 'authid' attribute to enable communication of XMPP stream ID (used in digest authentication); specified that Content-Types other than &quot;text/xml&quot; are allowed to support older HTTP clients; specified business rule for connection manager queueing of client requests; changed &lt;packet/&gt; to &lt;body/&gt; to support older HTTP clients; changed 'to' attribute on initialization element from MAY to SHOULD; recommended inclusion of unavailable presence in termination element sent from client; described architectural assumptions; specified binding-specific error handling. (psa/ip)
    </div>
<h4>Version 0.2 (2004-01-13)</h4>
<div class="indent">Added 'to' attribute on the initialization element; specified that 'text/html' is allowable for backwards-compatibility. (dss/psa)
    </div>
<h4>Version 0.1 (2003-11-06)</h4>
<div class="indent">Initial version. (dss/psa)
    </div>
</div>
<p><hr></p>
<p>END</p>
</body>
</html>
