<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0301: In-Band Real Time Text</title><link rel="stylesheet" type="text/css" href="../xmpp.css" /><link href="../prettify.css" type="text/css" rel="stylesheet" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><script type="text/javascript" src="../prettify.js"></script><meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0" /><meta name="DC.Title" content="In-Band Real Time Text" /><meta name="DC.Creator" content="Mark Rejhon" /><meta name="DC.Creator" content="Gunnar Hellstrom" /><meta name="DC.Description" content="This is a specification for real-time text transmitted in-band over an XMPP session.&#10;  Real-time text is text transmitted instantly while it is being typed or&#10;  created." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2013-07-31" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0301" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright &#xA9; 1999 - 2013 by the XMPP Standards Foundation (XSF)." /></head><body onload="prettyPrint()"><h1>XEP-0301: In-Band Real Time Text</h1><table><tr valign="top"><td><strong>Abstract:</strong></td><td>This is a specification for real-time text transmitted in-band over an XMPP session.
  Real-time text is text transmitted instantly while it is being typed or
  created.</td></tr><tr valign="top"><td><strong>Authors:</strong></td><td>Mark Rejhon, Gunnar Hellstrom</td></tr><tr valign="top"><td><strong>Copyright:</strong></td><td>© 1999 - 2013 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</td></tr><tr valign="top"><td><strong>Status:</strong></td><td>Proposed</td></tr><tr valign="top"><td><strong>Type:</strong></td><td>Standards Track</td></tr><tr valign="top"><td><strong>Version:</strong></td><td>0.11</td></tr><tr valign="top"><td><strong>Last Updated:</strong></td><td>2013-07-31</td></tr></table><hr /><p style="color:red">NOTICE: This document is currently within Last Call or under consideration by the XMPP Council for advancement to the next stage in the XSF standards process. The Last Call ends on 2013-06-28. Please send your feedback to the <a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a> discussion list.</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#introduction">Introduction</a><br />2.  <a href="#requirements">Requirements</a><br />   
      2.1.  <a href="#fluid_realtime_text">Fluid Real-Time Text</a><br />   
      2.2.  <a href="#inband_transmission">In-Band Transmission</a><br />   
      2.3.  <a href="#flexible_and_interoperable">Flexible and Interoperable</a><br />   
      2.4.  <a href="#accessible">Accessible</a><br />3.  <a href="#glossary">Glossary</a><br />4.  <a href="#protocol">Protocol</a><br />   
      4.1.  <a href="#rtt_element">RTT Element</a><br />   
      4.2.  <a href="#rtt_attributes">RTT Attributes</a><br />      
      4.2.1.  <a href="#seq">seq</a><br />      
      4.2.2.  <a href="#event">event</a><br />      
      4.2.3.  <a href="#id">id</a><br />   
      4.3.  <a href="#processing_rules">Processing Rules</a><br />   
      4.4.  <a href="#body_element">Body Element</a><br />      
      4.4.1.  <a href="#backwards_compatible">Backwards Compatible</a><br />   
      4.5.  <a href="#transmission_interval">Transmission Interval</a><br />   
      4.6.  <a href="#realtime_text_actions">Real-Time Text Actions</a><br />      
      4.6.1.  <a href="#action_elements">Action Elements</a><br />      
      4.6.2.  <a href="#attribute_values">Attribute Values</a><br />      
      4.6.3.  <a href="#list_of_action_elements">List of Action Elements</a><br />        
      4.6.3.1.  <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a><br />        
      4.6.3.2.  <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a><br />        
      4.6.3.3.  <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a><br />   
      4.7.  <a href="#keeping_realtime_text_synchronized">Keeping Real-Time Text Synchronized</a><br />      
      4.7.1.  <a href="#staying_in_sync">Staying In Sync</a><br />      
      4.7.2.  <a href="#recovery_from_loss_of_sync">Recovery From Loss of Sync</a><br />      
      4.7.3.  <a href="#message_refresh">Message Refresh</a><br />   
      4.8.  <a href="#accurate_processing_of_action_elements">Accurate Processing of Action Elements</a><br />      
      4.8.1.  <a href="#unicode_character_counting">Unicode Character Counting</a><br />      
      4.8.2.  <a href="#guidelines_for_senders">Guidelines for Senders</a><br />      
      4.8.3.  <a href="#guidelines_for_recipients">Guidelines for Recipients</a><br />5.  <a href="#determining_support">Determining Support</a><br />6.  <a href="#guidelines_for_initiating_realtime_text">Guidelines for Initiating Real-Time Text</a><br />   
      6.1.  <a href="#activating_realtime_text">Activating Real-Time Text</a><br />   
      6.2.  <a href="#deactivating_realtime_text">Deactivating Real-Time Text</a><br />7.  <a href="#implementation_notes">Implementation Notes</a><br />   
      7.1.  <a href="#text_presentation">Text Presentation</a><br />      
      7.1.1.  <a href="#avoid_bursty_text_presentation">Avoid Bursty Text Presentation</a><br />      
      7.1.2.  <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a><br />      
      7.1.3.  <a href="#time_critical_and_low_latency_methods">Time Critical and Low Latency Methods</a><br />      
      7.1.4.  <a href="#lowbandwidth_and_lowprecision_text_smoothing">Low-Bandwidth and Low-Precision Text Smoothing</a><br />   
      7.2.  <a href="#optional_remote_cursor">Optional Remote Cursor</a><br />   
      7.3.  <a href="#sending_realtime_text">Sending Real-Time Text</a><br />      
      7.3.1.  <a href="#monitoring_message_changes_instead_of_key_presses">Monitoring Message Changes Instead Of Key Presses</a><br />      
      7.3.2.  <a href="#monitoring_key_presses_directly">Monitoring Key Presses Directly</a><br />      
      7.3.3.  <a href="#appendonly_realtime_text">Append-Only Real-Time Text</a><br />      
      7.3.4.  <a href="#simple_realtime_text">Simple Real-Time Text</a><br />   
      7.4.  <a href="#receiving_realtime_text">Receiving Real-Time Text</a><br />   
      7.5.  <a href="#other_guidelines">Other Guidelines</a><br />      
      7.5.1.  <a href="#message_length">Message Length</a><br />      
      7.5.2.  <a href="#usage_with_chat_states">Usage with Chat States</a><br />      
      7.5.3.  <a href="#usage_with_last_message_correction">Usage with Last Message Correction</a><br />      
      7.5.4.  <a href="#usage_with_multiuser_chat_and_simultaneous_logins">Usage with Multi-User Chat and Simultaneous Logins</a><br />        
      7.5.4.1.  <a href="#multiuser_chat">Multi-User Chat</a><br />        
      7.5.4.2.  <a href="#simultaneous_logins">Simultaneous Logins</a><br />      
      7.5.5.  <a href="#stale_messages">Stale Messages</a><br />      
      7.5.6.  <a href="#performance_efficiency">Performance &amp; Efficiency</a><br />8.  <a href="#use_cases">Use Cases</a><br />   
      8.1.  <a href="#introductory_examples_of_realtime_text">Introductory Examples of Real-Time Text</a><br />   
      8.2.  <a href="#example_of_multiple_messages">Example of Multiple Messages</a><br />   
      8.3.  <a href="#examples_of_message_edits">Examples of Message Edits</a><br />      
      8.3.1.  <a href="#deleting_text_from_message">Deleting Text From Message</a><br />      
      8.3.2.  <a href="#inserting_text_into_message">Inserting Text Into Message</a><br />      
      8.3.3.  <a href="#deleting_and_replacing_text_in_message">Deleting and Replacing Text In Message</a><br />      
      8.3.4.  <a href="#multiple_message_edits">Multiple Message Edits</a><br />   
      8.4.  <a href="#examples_of_key_press_intervals">Examples of Key Press Intervals</a><br />      
      8.4.1.  <a href="#comparison_with_and_without_intervals">Comparison With and Without Intervals</a><br />      
      8.4.2.  <a href="#full_message_including_key_press_intervals">Full Message Including Key Press Intervals</a><br />9.  <a href="#interoperability_considerations">Interoperability Considerations</a><br />   
      9.1.  <a href="#rfc_4103_and_t140">RFC 4103 and T.140</a><br />   
      9.2.  <a href="#total_conversation_combination_with_audio_and_video">Total Conversation – Combination with Audio and Video</a><br />10.  <a href="#internationalization_considerations">Internationalization Considerations</a><br />11.  <a href="#security_considerations">Security Considerations</a><br />   
      11.1.  <a href="#privacy">Privacy</a><br />   
      11.2.  <a href="#encryption">Encryption</a><br />   
      11.3.  <a href="#congestion_considerations">Congestion Considerations</a><br />12.  <a href="#iana_considerations">IANA Considerations</a><br />13.  <a href="#xmpp_registrar_considerations">XMPP Registrar Considerations</a><br />   
      13.1.  <a href="#protocol_namespaces">Protocol Namespaces</a><br />   
      13.2.  <a href="#namespace_versioning">Namespace Versioning</a><br />14.  <a href="#xml_schema">XML Schema</a><br />15.  <a href="#acknowledgments">Acknowledgments</a></p><p><a href="#appendices">Appendices</a><br />    <a href="#appendix-docinfo">A: Document Information</a><br />    <a href="#appendix-authorinfo">B: Author Information</a><br />    <a href="#appendix-legal">C: Legal Notices</a><br />    <a href="#appendix-xmpp">D: Relation to XMPP</a><br />    <a href="#appendix-discuss">E: Discussion Venue</a><br />    <a href="#appendix-conformance">F: Requirements Conformance</a><br />    <a href="#appendix-notes">G: Notes</a><br />    <a href="#appendix-revs">H: Revision History</a></p></div><hr /><h2>1.
       <a name="introduction" id="introduction">Introduction</a></h2>
    <p>This document defines a specification for real-time text transmitted in-band over an XMPP network.</p>
    <p>Real-time text is text transmitted instantly while it is being typed or created. The recipient can immediately read the sender's text as it is written, without waiting. It allows text to be used as conversationally as a telephone conversation, including in situations where speech is not practical (e.g. environments that must be quiet, environments too noisy to hear, restrictions on phone use, situations where speaking is a privacy or security concern, and/or when participant(s) are deaf or hard of hearing). It is also used for transmission of live speech transcription.</p>
    <p>Real-time text is found in various implementations:</p>
    <ul>
      <li>The 'talk' command on UNIX systems since the 1970's.</li>
      <li>Session Initiation Protocol (SIP), utilizing <span class="ref"><span class="strong"><a href="http://tools.ietf.org/html/rfc4103">IETF RFC 4103</a></span></span>
   [<a href="#nt-id347410">1</a>] real-time text.</li>
      <li>Instant messaging enhancements, including a <span class="ref"><span class="strong"><a href="http://tap.gallaudet.edu/rtt/">Gallaudet University</a></span></span>
   [<a href="#nt-id347433">2</a>] collaboration.</li>
      <li>Next generation emergency services (<span class="ref"><span class="strong"><a href="http://tools.ietf.org/html/rfc6443">IETF RFC 6443</a></span></span>
   [<a href="#nt-id347455">3</a>]).</li>
    </ul>
    <p>For a visual animation of real-time text, see <span class="ref"><span class="strong"><a href="http://www.realtimetext.org">Real-Time Text Taskforce</a></span></span>
   [<a href="#nt-id347479">4</a>].</p>
    <h2>2.
       <a name="requirements" id="requirements">Requirements</a></h2>
        <div class="indent"><h3>2.1 <a name="fluid_realtime_text" id="fluid_realtime_text">Fluid Real-Time Text</a></h3>
    <ol>
      <li>Allow reliable transmission of real-time text with a low latency.</li>
      <li>Support message editing in real-time, including text insertions and deletions.</li>
      <li>Support transmission and reproduction of the original intervals between key presses, to preserve look-and-feel of typing independently of transmission intervals.</li>
    </ol>
    </div>
    <div class="indent"><h3>2.2 <a name="inband_transmission" id="inband_transmission">In-Band Transmission</a></h3>
    <ol>
      <li>Be backwards compatible with XMPP clients that do not support real-time text.</li>
      <li>Be compatible with multi-user chat (MUC) and simultaneous logins.</li>
      <li>Minimize reliance on out-of-band transmission protocols, for simpler network traversal.</li>
    </ol>
    </div>
    <div class="indent"><h3>2.3 <a name="flexible_and_interoperable" id="flexible_and_interoperable">Flexible and Interoperable</a></h3>
    <ol>
      <li>Allow seamless integration of real-time text into instant messaging clients, with minimal user interface modifications.</li>
      <li>Be able to function securely over intermittent and unreliable connections, including mobile phones.</li>
      <li>Allow use within gateways to interoperate with other real-time text protocols, including RFC 4103 and <span class="ref"><span class="strong"><a href="http://www.itu.int/rec/T-REC-T.140">ITU-T T.140</a></span></span>
   [<a href="#nt-id347570">5</a>].</li>
      <li>Be usable in an international setting.</li>
    </ol>
    </div>
    <div class="indent"><h3>2.4 <a name="accessible" id="accessible">Accessible</a></h3>
    <ol>
      <li>Allow XMPP applications to be able to implement <span class="ref"><span class="strong"><a href="http://www.itu.int/rec/T-REC-F.703">ITU-T Rec. F.703</a></span></span>
   [<a href="#nt-id347606">6</a>] Total Conversation standard for simultaneous voice, video, and real-time text.</li>
      <li>Be a candidate technology for use with next generation emergency services (e.g. 9-1-1 and 1-1-2).</li>
      <li>Be suitable for transcription services and (when coupled with voice at user's choice) for TTY/text telephone alternatives, relay services, and captioned telephone systems.</li>
    </ol>
    </div>
<h2>3.
       <a name="glossary" id="glossary">Glossary</a></h2>
    <p><span class="strong">action element</span> – An XML element that represents a single real-time message edit, such as text insertion or deletion.</p>
    <p><span class="strong">character</span> - A single Unicode code point. See <a href="#unicode_character_counting">Unicode Character Counting</a>.</p>
    <p><span class="strong">real-time</span> – A conversational latency of less than 1 second, as defined by <span class="ref"><span class="strong"><a href="http://www.itu.int/rec/T-REC-F.700">ITU-T Rec. F.700</a></span></span>
   [<a href="#nt-id347668">7</a>], section 2.1.2.1.</p>
    <p><span class="strong">real-time text</span> – Text transmitted instantly while it is being typed or created, to allow recipient(s) to immediately read the sender's text as it is written, without waiting.</p>
    <p><span class="strong">real-time message</span> – Recipient's real-time view of the sender's message still being typed or created.</p>
    <p><span class="strong">RTT</span> – Acronym for real-time text.</p>
    <p><span class="strong">simultaneous login</span> – Multiple simultaneous sessions, on multiple clients, using the same login (Jabber Identifier).</p>
    <h2>4.
       <a name="protocol" id="protocol">Protocol</a></h2>
        <div class="indent"><h3>4.1 <a name="rtt_element" id="rtt_element">RTT Element</a></h3>
    <p>Real-time text is transmitted via an &lt;rtt/&gt; child element of a &lt;message/&gt; stanza. The &lt;rtt/&gt; element is transmitted at regular intervals by the sender client while a message is being composed. This allows the recipient to see the latest message text from the sender, without waiting for the full message to be sent in a &lt;body/&gt; element.</p>
    <p>This is a basic example of a <span class="strong">real-time message</span> "Hello, my Juliet!” transmitted in real-time while it is being typed, before a final message delivery in a &lt;body/&gt; element (to remain <a href="#backwards_compatible">Backwards Compatible</a>):</p>
    <p><span class="strong">Example 1: Introductory Example</span></p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='juliet@capulet.lit' from='romeo@montague.lit/orchard' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='0' event='new'&gt;
    &lt;t&gt;Hello, &lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='juliet@capulet.lit' from='romeo@montague.lit/orchard' type='chat' id='a02'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='1'&gt;
    &lt;t&gt;my J&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='juliet@capulet.lit' from='romeo@montague.lit/orchard' type='chat' id='a03'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='2'&gt;
    &lt;t&gt;uliet!&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='juliet@capulet.lit' from='romeo@montague.lit/orchard' type='chat' id='a04'&gt;
  &lt;body&gt;Hello, my Juliet!&lt;/body&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>The &lt;rtt/&gt; element contains one or more child elements that represent <a href="#realtime_text_actions">Real-Time Text Actions</a> such as text being appended, inserted, or deleted. Example 1 illustrates only the &lt;t/&gt; <span class="strong">action element</span>, which appends text to the end of a message.</p>
    <p>Transmission of the &lt;rtt/&gt; element occurs at a regular <a href="#transmission_interval">Transmission Interval</a> whenever the sender is actively composing a message. If there are no changes to the message since the last transmission, no transmission occurs.</p>
    <p>There MUST NOT be more than one &lt;rtt/&gt; element per &lt;message/&gt; stanza.</p>
    <p>The namespace of the &lt;rtt/&gt; element is “urn:xmpp:rtt:0”.</p>
    </div>
    <div class="indent"><h3>4.2 <a name="rtt_attributes" id="rtt_attributes">RTT Attributes</a></h3>
        <div class="indent"><h3>4.2.1 <a name="seq" id="seq">seq</a></h3>
    <p>This REQUIRED attribute is a counter to maintain synchronization of real-time text. Senders MUST increment this value by 1 for each subsequent edit to the same real-time message, including when appending new text. Receiving clients MUST monitor this seq value as a lightweight verification on the synchronization of real-time text messages. The bounds of <span class="em"><span class="strong">seq</span></span> is 31-bits, the range of positive values for a signed 32-bit integer. See <a href="#keeping_realtime_text_synchronized">Keeping Real-Time Text Synchronized</a>.</p>
    </div>
    <div class="indent"><h3>4.2.2 <a name="event" id="event">event</a></h3>
    <p>This attribute signals events for real-time text.</p>
        <div class="indent"><p class="caption"><a name="table-1" id="table-1"></a>Table 1: </p><table border="1" cellpadding="3" cellspacing="0">
          <tr class="body">
            <th>event</th>
            <th>Description</th>
            <th>Action Elements</th>
            <th>Sender Support</th>
            <th>Recipient Support</th>
          </tr>
          <tr class="body">
            <td>new</td>
            <td>Begin a new real-time message.</td>
            <td>Yes</td>
            <td><span class="strong">REQUIRED</span></td>
            <td><span class="strong">REQUIRED</span></td>
          </tr>
          <tr class="body">
            <td>reset</td>
            <td>Re-initialize the real-time message.</td>
            <td>Yes</td>
            <td>RECOMMENDED</td>
            <td><span class="strong">REQUIRED</span></td>
          </tr>
          <tr class="body">
            <td>edit</td>
            <td>Modify existing real-time message.</td>
            <td>Yes</td>
            <td>OPTIONAL</td>
            <td><span class="strong">REQUIRED</span></td>
          </tr>
          <tr class="body">
            <td>init</td>
            <td>Signals activation of real-time text.</td>
            <td>No</td>
            <td>OPTIONAL</td>
            <td>RECOMMENDED</td>
          </tr>
          <tr class="body">
            <td>cancel</td>
            <td>Signals deactivation of real-time text.</td>
            <td>No</td>
            <td>OPTIONAL</td>
            <td>RECOMMENDED</td>
          </tr>
        </table></div>
    <p>If the <span class="em"><span class="strong">event</span></span> attribute is omitted, <span class="em"><span class="strong">event='edit'</span></span> is assumed as the default. When <a href="#action_elements">Action Elements</a> are used (e.g. text appends, insertions and deletions), the &lt;rtt/&gt; element MAY contain one or more of any action elements, in any order. When action elements are not allowed, the &lt;rtt/&gt; element MUST be empty. Recipient clients MUST ignore &lt;rtt/&gt; elements containing unrecognized <span class="em"><span class="strong">event</span></span> values.</p>
    </div>
    <div class="indent"><h3>4.2.3 <a name="id" id="id">id</a></h3>
    <p>This attribute is used only if Last Message Correction (XEP-0308) is implemented along with this specification. See <a href="#usage_with_last_message_correction">Usage with Last Message Correction</a> to enable real-time text during editing of the previous message.</p>
    </div>
</div>
    <div class="indent"><h3>4.3 <a name="processing_rules" id="processing_rules">Processing Rules</a></h3>
    <ul>
      <li><p><span class="strong">Initialize a new real-time message: &lt;rtt event='new'/&gt; and &lt;rtt event='reset'/&gt;</span><br />
        Sender clients MUST use an &lt;rtt/&gt; element containing either <span class="strong">event='new'</span> or <span class="strong">event='reset'</span> in the first transmission of a new real-time message. Recipient clients MUST initialize a new blank real-time message for display, and then process all <a href="#action_elements">Action Elements</a> (e.g. text insertions and deletions) included within the &lt;rtt/&gt; element. If a real-time message already exists from the same sender in the same chat session, its content MUST be seamlessly replaced (i.e. cleared prior to immediately processing action elements).</p></li>
      <li><p><span class="strong">Both &lt;rtt event='new'/&gt; and &lt;rtt event='reset'/&gt; are logically identical to recipients, except for presentation:</span><br />
        For recipients, these differ only for optional presentation purposes (e.g. highlighting newly started incoming messages). Senders SHOULD use <span class="em"><span class="strong">event='new'</span></span> when sending the first text of a new message (e.g. the first key presses), and only use <span class="em"><span class="strong">event='reset'</span></span> when doing <a href="#message_refresh">Message Refresh</a> or <a href="#simple_realtime_text">Simple Real-Time Text</a>. See <a href="#keeping_realtime_text_synchronized">Keeping Real-Time Text Synchronized</a>.</p></li>
      <li><p><span class="strong">Sending modifications of a real-time message: Outgoing &lt;rtt event='edit'/&gt; or &lt;rtt/&gt;<br /></span>Sender clients SHOULD transmit this element at a regular <a href="#transmission_interval">Transmission Interval</a> while the message is being modified. The <span class="em"><span class="strong">seq</span></span> attribute MUST increment by 1 for every consecutive modification transmitted. See <a href="#sending_realtime_text">Sending Real-Time Text</a>.</p></li>
      <li><p><span class="strong">Receiving modifications of a real-time message: Incoming &lt;rtt event='edit'/&gt; or &lt;rtt/&gt;<br /></span>Recipient clients must verify that the <span class="em"><span class="strong">seq</span></span> attribute increments by 1 in consecutively received &lt;rtt/&gt; elements from the same sender. If <span class="strong">seq</span> increments as expected, the <a href="#action_elements">Action Elements</a> (e.g. text insertions and deletions) included with this element MUST be processed to modify the existing real-time message. Otherwise, if <span class="em"><span class="strong">seq</span></span> does not increment as expected, or if no real-time message already exists, the real-time message is considered out of sync and all subsequent modifications MUST be ignored until a new real-time message is initialized via <span class="em"><span class="strong">event='new'</span></span> or <span class="em"><span class="strong">event='reset'</span></span>. See <a href="#keeping_realtime_text_synchronized">Keeping Real-Time Text Synchronized</a>.</p></li>
      <li><p><span class="strong">Committing a real-time message: Delivery of a &lt;body/&gt; element</span><br />
        A real-time message is considered complete upon receiving &lt;body/&gt;. See <a href="#body_element">Body Element</a>.</p></li>
      <li><p><span class="strong">Starting real-time text: &lt;rtt event='init'/&gt;</span><br />
        Clients MAY use this value to signal activation of real-time text without first starting a real-time message, since the sender may not start composing immediately. The <span class="em"><span class="strong">seq</span></span> attribute is ignored by recipient clients. See <a href="#guidelines_for_initiating_realtime_text">Guidelines for Initiating Real-Time Text</a>.</p></li>
      <li><p><span class="strong">Ending real-time text: &lt;rtt event='cancel'/&gt;</span><br />
        Clients MAY use this value to signal deactivation of real-time text. Clients receiving this element SHOULD also discontinue sending &lt;rtt/&gt; elements for the remainder of the same one-to-one chat session (until <span class="em"><span class="strong">event='init'</span></span> is used again), and handle any unfinished real-time messages appropriately (e.g. clearing or saving the message). The <span class="em"><span class="strong">seq</span></span> attribute is ignored by recipient clients. See <a href="#guidelines_for_initiating_realtime_text">Guidelines for Initiating Real-Time Text</a>.</p></li>
      <li><p><span class="strong">Starting value for seq attribute:</span><br />
        Sender clients MAY use any new starting value for <span class="em"><span class="strong">seq</span></span> when initializing a real-time message using <span class="em"><span class="strong">event='new'</span></span> or <span class="em"><span class="strong">event='reset'</span></span>. Recipient clients receiving such elements MUST use this <span class="em"><span class="strong">seq</span></span> value as the new starting value. A random starting value is RECOMMENDED to improve reliability of <a href="#keeping_realtime_text_synchronized">Keeping Real-Time Text Synchronized</a> during <a href="#usage_with_multiuser_chat_and_simultaneous_logins">Usage with Multi-User Chat and Simultaneous Logins</a>.</p></li>
    </ul>
    </div>
    <div class="indent"><h3>4.4 <a name="body_element" id="body_element">Body Element</a></h3>
    <p>The real-time message is considered complete upon receipt of a standard &lt;body/&gt; element (as qualified by the 'jabber:client' namespace in <span class="ref"><a href="http://tools.ietf.org/html/rfc6121">XMPP IM</a></span>  [<a href="#nt-id348347">8</a>]). The delivered text within &lt;body/&gt; is considered the final message text, and supersedes the real-time message. In the ideal case, the text within &lt;body/&gt; is redundant since it is identical to the final contents of the real-time message.</p>
    <p>Sender clients MAY transmit the &lt;body/&gt; element in the same or separate &lt;message/&gt; stanza as the one containing the final &lt;rtt/&gt; element for the real-time message. To continue sending real-time text in subsequent &lt;message/&gt; stanzas, the sender client MUST first initialize a new real-time message according to <a href="#processing_rules">Processing Rules</a>.</p>
        <div class="indent"><h3>4.4.1 <a name="backwards_compatible" id="backwards_compatible">Backwards Compatible</a></h3>
    <p>This real-time text standard simply provides early delivery of text before the &lt;body/&gt; element. The &lt;body/&gt; element continues to follow the XMPP IM specification. In particular, XMPP implementations need to ignore XML elements they do not understand. Clients, that do not support real-time text, will continue to behave normally, displaying complete lines of messages as they are delivered.</p>
    </div>
</div>
    <div class="indent"><h3>4.5 <a name="transmission_interval" id="transmission_interval">Transmission Interval</a></h3>
    <p>For the best balance between interoperability and usability, the default transmission interval of &lt;rtt/&gt; elements for a continuously-changing message SHOULD be approximately <span class="strong">700 milliseconds</span>. This interval makes it possible for clients to meet ITU-T Rec. F.700 Section A.3.2.1 for good quality real-time text conversation in many network environments. If a different transmission interval needs to be used, the interval SHOULD be <span class="strong">between 300 and 1000 milliseconds</span>.</p>
    <p>A longer interval will lead to a less optimal user experience. Conversely, a much shorter interval can lead to <a href="#congestion_considerations">Congestion Considerations</a>. To provide fluid real-time text, one or more of the following methods can be used:</p>
    <ul>
      <li><a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a> for natural typing display, independently of the transmission interval.</li>
      <li>Use of <a href="#time_critical_and_low_latency_methods">Time Critical and Low Latency Methods</a>, for real-time captioning/speech transcription.</li>
      <li>For other options or reduced-precision options, see <a href="#lowbandwidth_and_lowprecision_text_smoothing">Low-Bandwidth and Low-Precision Text Smoothing</a>.</li>
    </ul>
    </div>
    <div class="indent"><h3>4.6 <a name="realtime_text_actions" id="realtime_text_actions">Real-Time Text Actions</a></h3>
    <p>The &lt;rtt/&gt; element MAY contain one or more <span class="strong">action elements</span> representing real-time text operations, including text being appended, inserted, or deleted.</p>
    <p>Many chat clients allow a sender to edit their message before sending (via a Send button, or pressing Enter). The seamless inclusion of real-time text functionality, in existing client software, needs to preserve the sender's existing expectation of being able to edit their messages. In a chat session with real-time text, the recipient can see the sender compose and edit their message before it is completed.</p>
        <div class="indent"><h3>4.6.1 <a name="action_elements" id="action_elements">Action Elements</a></h3>
    <p>This is a short summary of action elements that operate on a real-time message.</p>
        <div class="indent"><p class="caption"><a name="table-2" id="table-2"></a>Table 2: </p><table border="1" cellpadding="3" cellspacing="0">
          <tr class="body">
            <th>Action</th>
            <th>Element</th>
            <th>Description</th>
            <th>Sender Support</th>
            <th>Recipient Support</th>
          </tr>
          <tr class="body">
            <td>Insert Text</td>
            <td>&lt;t p='#'&gt;text&lt;/t&gt;</td>
            <td>Insert specified <span class="em"><span class="strong">text</span></span> at position <span class="em"><span class="strong">p</span></span> in message.</td>
            <td><span class="strong">REQUIRED</span></td>
            <td><span class="strong">REQUIRED</span></td>
          </tr>
          <tr class="body">
            <td>Erase Text</td>
            <td>&lt;e p='#' n='#'/&gt;</td>
            <td>Remove <span class="em"><span class="strong">n</span></span> characters before position <span class="em"><span class="strong">p</span></span> in message<span class="em">.</span></td>
            <td>RECOMMENDED</td>
            <td><span class="strong">REQUIRED</span></td>
          </tr>
          <tr class="body">
            <td>Wait Interval</td>
            <td>&lt;w n='#'/&gt;</td>
            <td>Wait <span class="em"><span class="strong">n</span></span> milliseconds.</td>
            <td>RECOMMENDED</td>
            <td>RECOMMENDED</td>
          </tr>
        </table></div>
    <p>These elements are kept compact in order to save bandwidth, since a single &lt;rtt/&gt; element can contain a large number of action elements (e.g. during <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>). See <a href="#list_of_action_elements">List of Action Elements</a> for details.</p>
    </div>
    <div class="indent"><h3>4.6.2 <a name="attribute_values" id="attribute_values">Attribute Values</a></h3>
    <ul>
      <li><p>For <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a>:<br />
        The <span class="em"><span class="strong">n</span></span> attribute is a length value, in number of characters. If <span class="em"><span class="strong">n</span></span> is omitted, the default value of <span class="em"><span class="strong">n</span></span> MUST be 1.</p></li>
      <li><p>For <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a> and <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a>:<br />
        The <span class="em"><span class="strong">p</span></span> attribute is an absolute position value, as a character position index into the real-time message, where 0 represents the beginning of the message. If <span class="em"><span class="strong">p</span></span> is omitted, the default value of <span class="em"><span class="strong">p</span></span> MUST point to the end of the message (i.e. <span class="em"><span class="strong">p</span></span> is set to the current length of the real-time message).</p></li>
      <li><p>For the purpose of this specification, the word "character" represents a single Unicode code point. See <a href="#unicode_character_counting">Unicode Character Counting</a>.</p></li>
      <li><p>Senders MUST NOT use negative values for any attribute, nor use <span class="em"><span class="strong">p</span></span> values bigger than the current message length. However, recipients receiving such values MUST clip negative values to 0, and clip excessively high <span class="em"><span class="strong">p</span></span> values to the current length of the real-time message. Modifications only occur within the boundaries of the current real-time message.</p></li>
    </ul>
    </div>
    <div class="indent"><h3>4.6.3 <a name="list_of_action_elements" id="list_of_action_elements">List of Action Elements</a></h3>
    <p>Recipients MUST be able to process all &lt;t/&gt; and &lt;e/&gt; action elements for incoming &lt;rtt/&gt; transmissions, even if senders do not use all of these for outgoing &lt;rtt/&gt; transmissions (e.g. <a href="#simple_realtime_text">Simple Real-Time Text</a>). Support for &lt;w/&gt; is RECOMMENDED for both senders and recipients, in order to accommodate <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>. Recipients MUST ignore unexpected or unsupported elements within &lt;rtt/&gt;, while continuing to process subsequent action elements. Compatibility is ensured via <a href="#namespace_versioning">Namespace Versioning</a>. Action elements are immediate child elements of the &lt;rtt/&gt; element, and are never nested. See examples in <a href="#use_cases">Use Cases</a>.</p>
        <div class="indent"><h3>4.6.3.1 <a name="element_t_insert_text" id="element_t_insert_text">Element &lt;t/&gt; – Insert Text</a></h3>
    <p>Supports the transmission of text, including key presses, and text block inserts.<br />
    <span class="em">Note: Text can be any</span> <span class="em">subset of text allowed in the &lt;body/&gt; element of a &lt;message/&gt;. If &lt;t/&gt; is empty or blank, no text modification takes place.</span></p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;t&gt;text&lt;/t&gt;</pre></div></p>
    <p>Append specified <span class="em"><span class="strong">text</span></span> at the end of message. (<span class="em"><span class="strong">p</span></span> defaults to message length).<br />
    <span class="em">Note: This action element is the minimum support REQUIRED for sender clients (i.e. speech transcription, chat bots, and <a href="#simple_realtime_text">Simple Real-Time Text</a> are still possible without supporting additional action elements).</span></p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;t p='#'&gt;text&lt;/t&gt;</pre></div></p>
    <p>Inserts specified <span class="em"><span class="strong">text</span></span> at position <span class="em"><span class="strong">p</span></span> in the message text.</p>
    


    </div>
    <div class="indent"><h3>4.6.3.2 <a name="element_e_erase_text" id="element_e_erase_text">Element &lt;e/&gt; – Erase Text</a></h3>
    <p>Supports the behavior of backspace key presses. Text is removed towards beginning of the message. This element is also used for all delete operations, including the backspace key, the delete key, and text block deletes.<br />
    <span class="em">Note: Excess backspaces MUST be ignored by the receiving client. Thus, text is backspaced only to the beginning of the message, in situations where n is larger than p.</span></p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;e/&gt;</pre></div></p>
    <p>Remove 1 character from end of message. (<span class="em"><span class="strong">n</span></span> defaults to 1, and <span class="em"><span class="strong">p</span></span> defaults to message length)</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;e p='#'/&gt;</pre></div></p>
    <p>Remove 1 character before character position <span class="em"><span class="strong">p</span></span> in message. (<span class="em"><span class="strong">n</span></span> defaults to 1)</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;e n='#'/&gt;</pre></div></p>
    <p>Remove <span class="em"><span class="strong">n</span></span> characters from end of message. (<span class="em"><span class="strong">p</span></span> defaults to message length)</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;e n='#' p='#'/&gt;</pre></div></p>
    <p>Remove <span class="em"><span class="strong">n</span></span> characters before character position <span class="em"><span class="strong">p</span></span> in message.</p>
    </div>
    <div class="indent"><h3>4.6.3.3 <a name="element_w_wait_interval" id="element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a></h3>
    <p>Allow for the transmission of intervals, between real-time text actions, to recreate the pauses between key presses. See <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;w n='#'/&gt;</pre></div></p>
    <p>Wait <span class="em"><span class="strong">n</span></span> milliseconds before processing the next action element. This pause MAY be approximate, and not necessarily be of millisecond precision. Sender clients SHOULD NOT send large <span class="em"><span class="strong">n</span></span> values that exceed the average <a href="#transmission_interval">Transmission Interval</a>. Recipient clients MAY selectively shorten or ignore the pauses (<span class="em"><span class="strong">n</span></span>) in &lt;w/&gt; action elements to avoid lag in a chat session. Situations such as network congestion can result in a surge of &lt;w/&gt; elements where the total of pauses exceeds a transmission interval cycle. See <a href="#receiving_realtime_text">Receiving Real-Time Text</a>.</p>
    </div>
</div>
</div>
    <div class="indent"><h3>4.7 <a name="keeping_realtime_text_synchronized" id="keeping_realtime_text_synchronized">Keeping Real-Time Text Synchronized</a></h3>
    <p>During a chat session, real-time text needs to be identical on both the sender and recipient ends. A missing &lt;rtt/&gt; transmission can represent missing text or missing edits. Also, recipients can connect after the sender has already started composing a message. To address this, a <a href="#message_refresh">Message Refresh</a> mechanism allows recipient clients to recover the sender's real-time message that is actively in-progress. This synchronizes real-time text in many situations, including:</p>
    <ul>
      <li>After recipient client reconnections (e.g. due to wireless reception, due to user restarting client).</li>
      <li>After recipient client discarded <a href="#stale_messages">Stale Messages</a> (e.g. sender resumes composing hours later).</li>
      <li><a href="#simultaneous_logins">Simultaneous Logins</a> (e.g. user switching between devices/clients or between windows/tabs in a client).</li>
      <li>During <a href="#multiuser_chat">Multi-User Chat</a> (e.g. participants joining/leaving while other participants are composing).</li>
      <li>After message stanzas are lost in transit (e.g. <a href="#congestion_considerations">Congestion Considerations</a>).</li>
    </ul>
    <p>Recipient clients MUST keep track of separate real-time messages on a per-contact basis, including tracking independent <span class="em"><a href="#seq">seq</a></span> values. Recipient clients MAY track incoming &lt;rtt/&gt; elements per bare JID &lt;localpart@domain.tld&gt; to keep only one real-time message per contact. The remainder of this section automatically handles conflicting &lt;rtt/&gt; elements (e.g. typing coming concurrently from separate <a href="#simultaneous_logins">Simultaneous Logins</a>, contrary to the common case of one typist per contact). Alternatively, recipient clients MAY track incoming &lt;rtt/&gt; elements per full JID &lt;localpart@domain.tld/resource&gt; and/or per &lt;thread/&gt;, to keep multiple separate real-time messages for the same contact. For more information about &lt;thread/&gt;, see <span class="ref"><a href="http://xmpp.org/extensions/xep-0201.html">Best Practices for Message Threads</a></span>  [<a href="#nt-id349068">9</a>].</p>
        <div class="indent"><h3>4.7.1 <a name="staying_in_sync" id="staying_in_sync">Staying In Sync</a></h3>
    <p>By following <a href="#processing_rules">Processing Rules</a>, the recipient client creates a new real-time message when receiving &lt;rtt event='new'/&gt; or &lt;rtt event='reset'/&gt;. Thereafter, when receiving text modifications (i.e. &lt;rtt event='edit'/&gt; or &lt;rtt/&gt; without an <span class="em"><a href="#event">event</a></span> attribute):</p>
    <ol>
      <li>There MUST be an existing real-time message (created via &lt;rtt event='new'/&gt; or &lt;rtt event='reset'/&gt;);</li>
      <li>Senders MUST increment the <span class="em"><a href="#seq">seq</a></span> attribute in steps of 1, for consecutively transmitted text modifications.</li>
      <li>Recipients MUST verify that the <span class="em"><a href="#seq">seq</a></span> attribute is incrementing by 1, for consecutively received text modifications.</li>
    </ol>
    </div>
    <div class="indent"><h3>4.7.2 <a name="recovery_from_loss_of_sync" id="recovery_from_loss_of_sync">Recovery From Loss of Sync</a></h3>
    <p>Loss of sync occurs during receiving text modifications if the <span class="em"><a href="#seq">seq</a></span> attribute does not increment by 1 as expected, or if no real-time message exists. In this case:</p>
    <ul>
      <li>Recipients MUST keep the real-time message unchanged (if any exists); and</li>
      <li>Recipients MUST ignore subsequent text modifications (i.e. &lt;rtt event='edit'/&gt; or &lt;rtt/&gt; without an <span class="em"><a href="#event">event</a></span> attribute); and</li>
      <li>An indication can be used to show the loss of sync (e.g. color coding, modified chat state message).</li>
    </ul>
    <p>Recovery occurs when the recipient receives the following:</p>
    <ul>
      <li>A &lt;body/&gt; element. The <a href="#body_element">Body Element</a> supersedes the real-time message.</li>
      <li>An &lt;rtt/&gt; element with an <span class="em"><a href="#event">event</a></span> attribute of 'new' or 'reset' (e.g. new message, or <a href="#message_refresh">Message Refresh</a>).</li>
    </ul>
    </div>
    <div class="indent"><h3>4.7.3 <a name="message_refresh" id="message_refresh">Message Refresh</a></h3>
    <p>A message refresh is the sender's partially composed text being (re)transmitted via &lt;rtt event='reset'/&gt;. The recipient client(s) can seamlessly redisplay the real-time message as a result. This allows real-time text to resume quickly, without waiting for senders to start a new message:</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;rtt event='reset' seq='#' xmlns='urn:xmpp:rtt:0'&gt;
  &lt;t&gt;This is a retransmission of the entire real-time message.&lt;/t&gt;
&lt;/rtt&gt;</pre></div></p>
    <p>The message refresh SHOULD be transmitted at intervals during active typing or composing. The RECOMMENDED interval is 10 seconds. This interval is frequent enough to minimize user waiting time, while being infrequent enough to not cause a significant bandwidth overhead. This interval can be varied, or be set to a longer time period, in order to reduce average bandwidth (e.g. long messages, infrequent or minor message changes). To save bandwidth, message refreshes SHOULD NOT occur continuously while the sender is idle. To allow quicker resumption of real-time text, sender clients MAY adjust the timing of the message refresh to occur right after any of the following additional events:</p>
    <ul>
      <li>When the recipient starts sending messages from a different full JID (e.g. switched clients);</li>
      <li>When the recipient presence changes to a more available state (e.g. &lt;show/&gt; value of 'chat');</li>
      <li>When the sender resumes composing after an extended pause (e.g. recipient may have cleared <a href="#stale_messages">Stale Messages</a>);</li>
      <li>When the conversation is unlocked (e.g. section 5.1 of XMPP IM);</li>
    </ul>
    <p>If the recipient already has an existing real-time message from the sender, <a href="#processing_rules">Processing Rules</a> require that the real-time message MUST be seamlessly replaced. Thus, if the recipient is successfully <a href="#staying_in_sync">Staying In Sync</a>, the recipient user sees no visible effect since the text contained within &lt;rtt event='reset'/&gt; is a duplicate of the existing real-time message. If the recipient client was out of sync (<a href="#recovery_from_loss_of_sync">Recovery From Loss of Sync</a>) or it has no real-time message, the recipient user sees the real-time message immediately “catch up”.</p>
    <p>Note: The use of &lt;rtt event='reset'/&gt; is not limited to message refresh, as it can contain any number of <a href="#action_elements">Action Elements</a> in any order. Sender clients MAY combine a message refresh with additional action elements (e.g. re-transmitting a whole message in one <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a>, followed by some additional action elements, such as additional typing or backspacing, to seamlessly allow <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>).</p>
    </div>
</div>
    <div class="indent"><h3>4.8 <a name="accurate_processing_of_action_elements" id="accurate_processing_of_action_elements">Accurate Processing of Action Elements</a></h3>
    <p>Real-time text is generated based on text normally allowed to be transmitted within the &lt;body/&gt; element.</p>
    <p>Incorrectly generated <a href="#action_elements">Action Elements</a> and <a href="#attribute_values">Attribute Values</a> can lead to inconsistencies between the sender and recipient during real-time editing. The Unicode characters of the real-time text need to be transmitted unaltered from the sender to the recipient, without unexpected modifications after sender pre-processing. This is the chain between the sender's creation of real-time text, to the recipient's processing of real-time text. Unaltered transmission of Unicode characters is possible with sender pre-processing, as long as the transmission from the sender to the recipient remains standards-compliant, including compliant XML processors and compliant XMPP servers.</p>
    <p>If unexpected Unicode inconsistencies occur during real-time message editing, the recipient client will normally recover the message upon receiving a <a href="#body_element">Body Element</a> or a <a href="#message_refresh">Message Refresh</a>.</p>
        <div class="indent"><h3>4.8.1 <a name="unicode_character_counting" id="unicode_character_counting">Unicode Character Counting</a></h3>
    <p>For this specification, a "character" represents a single Unicode code point. This is the same definition used in section 1.1 of <span class="ref"><span class="strong"><a href="http://tools.ietf.org/html/rfc5198">IETF RFC 5198</a></span></span>
   [<a href="#nt-id349370">10</a>]. For platform-independent interoperability of <a href="#action_elements">Action Elements</a>, calculations on <a href="#attribute_values">Attribute Values</a> (<span class="em"><span class="strong">p</span></span> and <span class="em"><span class="strong">n</span></span>) MUST be based on counts of Unicode code points.</p>
    <p>Many platforms use different internal encodings (i.e. string formats) that are different from the transmission encoding (UTF-8). These factors need to be considered:</p>
    <ul>
      <li><p>Multiple Unicode code points (e.g. combining marks, accents) can form a combining character sequence. This can occur in situations where there isn't a visually equivalent composite character of a single code point (e.g. when doing Unicode normalization).<br />
        <span class="em">Action elements operate on Unicode code points individually.</span></p></li>
      <li><p>Unicode code points U+10000 through U+10FFFF are represented as a surrogate pair in some Unicode encodings (e.g. UTF-16).<br />
        <span class="em">Action elements operate on Unicode code points as a whole, not on separate components of a surrogate pair.</span></p></li>
      <li><p>XMPP transmission uses UTF-8, which uses a variable number of bytes per Unicode code point.<br /><span class="em">Action elements operate on Unicode code points as a whole, not on separate bytes.</span></p></li>
    </ul>
    <p>Lengths and positions in <a href="#attribute_values">Attribute Values</a> are relative to the internal Unicode text of the real-time message, independently of the directionality of actual displayed text. As a result, any valid Unicode text direction can be used with real-time text (right-to-left, left-to-right, and bidirectional). One way for implementers to visualize this, is to simply visualize Unicode text as an array of individual code points, and treat <a href="#attribute_values">Attribute Values</a> as array indexes.</p>
    </div>
    <div class="indent"><h3>4.8.2 <a name="guidelines_for_senders" id="guidelines_for_senders">Guidelines for Senders</a></h3>
    <p>Sender clients MUST generate real-time text (<a href="#action_elements">Action Elements</a> and <a href="#attribute_values">Attribute Values</a>) based on the plain text version of the sender's message with pre-processing completed. This is separate from and concurrent to any displayed presentation of the same message (e.g. formatting, emoticon graphics, <span class="ref"><a href="http://xmpp.org/extensions/xep-0071.html">XHTML-IM</a></span>  [<a href="#nt-id349501">11</a>]).</p>
    <p>Pre-processing before generating real-time text includes Unicode normalization, conversion of emoticons graphics to text, removal of illegal characters, line-break conversion, and any other necessary text modifications. For Unicode normalization, sender clients SHOULD ensure the message is in <span class="ref"><span class="strong"><a href="http://www.unicode.org/reports/tr15/">Unicode Normalization Form C</a></span></span>
   [<a href="#nt-id349515">12</a>] ("NFC"), as recommended within section 3 of RFC 5198, and within many other standards such as Canonical XML 1.0.</p>
    <p>If Unicode combining character sequences (e.g. letter with multiple accents) are used for <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a>, then complete combining character sequences SHOULD be sent. In situations where modifications are required to an existing combining character sequence (e.g. adding an additional accent), an <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a> SHOULD be used to delete the existing combining character sequence, before transmitting a complete replacement sequence via the &lt;t/&gt; element. (However, recipients SHOULD NOT assume this behavior from sending clients. See <a href="#guidelines_for_recipients">Guidelines for Recipients</a>.)</p>
    <p>For the purpose of calculating <a href="#attribute_values">Attribute Values</a>, any line breaks MUST be treated as a single character. Conversion of line breaks into a single LINE FEED U+000A is REQUIRED for XML processors, according to section 2.11 of <span class="ref"><span class="strong"><a href="http://www.w3.org/TR/xml/">XML</a></span></span>
   [<a href="#nt-id349576">13</a>].</p>
    </div>
    <div class="indent"><h3>4.8.3 <a name="guidelines_for_recipients" id="guidelines_for_recipients">Guidelines for Recipients</a></h3>
    <p>For <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a>, text MUST be obtained using compliant XML processing (including entities converted to characters). Recipient clients SHOULD ensure that the received text is in Unicode Normalization Form C ("NFC"). After this, recipient clients MUST NOT do any other modifications to resulting real-time messages. This is to allow accurate processing of subsequent <a href="#action_elements">Action Elements</a> and <a href="#attribute_values">Attribute Values</a> (the recipient client can separately process/modify a copy of the same real-time message text, if necessary for the purpose of display presentation).</p>
    <p>It is possible for sender clients to send <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a> with an incomplete combining character sequence (e.g. combining mark(s) without a Unicode base character). This is valid when extending an existing combining character sequence into a longer valid complete combining character sequence (e.g. adding an additional accent mark). It is also possible for senders to send <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a> to remove code points from an existing combining character sequence, into a shorter valid complete combining character sequence (e.g. removing an accent mark). In all cases, recipient clients MUST process these elements in accordance to <a href="#action_elements">Action Elements</a>.</p>
    </div>
</div>
<h2>5.
       <a name="determining_support" id="determining_support">Determining Support</a></h2>
    <p>If a client supports this real-time text protocol, it MUST advertise that fact in its responses to <span class="ref"><a href="http://xmpp.org/extensions/xep-0030.html">Service Discovery</a></span>  [<a href="#nt-id349681">14</a>] information requests ("disco#info") by returning a feature of <span class="strong">urn:xmpp:rtt:0</span></p>
    <p><span class="strong">Example 1. A disco#info query</span></p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;iq from='romeo@montague.lit/orchard'
    id='disco1'
    to='juliet@capulet.lit/balcony'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;

</pre></div></p>
    <p><span class="strong">Example 2. A disco#info response</span></p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;iq from='juliet@capulet.lit/balcony'
    id='disco1'
    to='romeo@montague.lit/orchard'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;feature var='urn:xmpp:rtt:0'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;

</pre></div></p>
    <p>In order for an application to determine whether an entity supports this protocol, where possible it SHOULD use the dynamic, presence-based profile of service discovery defined in <span class="ref"><a href="http://xmpp.org/extensions/xep-0115.html">Entity Capabilities</a></span>  [<a href="#nt-id349732">15</a>]. However, if an application has not received entity capabilities information from an entity, it SHOULD use explicit service discovery instead.</p>
    <p>See <a href="#guidelines_for_initiating_realtime_text">Guidelines for Initiating Real-Time Text</a> for more information, including implicit discovery.</p>
    <h2>6.
       <a name="guidelines_for_initiating_realtime_text" id="guidelines_for_initiating_realtime_text">Guidelines for Initiating Real-Time Text</a></h2>
    <p>Some clients can choose to send outgoing real-time text at all times by default. Other clients might choose to do user-initiated activation (e.g. via a button). These guidelines provide interoperability between clients that use different methods of initiating real-time text.</p>
        <div class="indent"><h3>6.1 <a name="activating_realtime_text" id="activating_realtime_text">Activating Real-Time Text</a></h3>
    <p>In the simplest case, sender clients MAY simply begin transmitting real-time text (i.e. send &lt;rtt/&gt; elements) upon determining support.</p>
    <p>For one-to-one chats, it can be beneficial for clients to easily synchronize the enabling/disabling of real-time text. Upon receiving incoming real-time text, recipient clients MAY automatically do an appropriate response, such as:</p>
    <ul>
      <li>Activate immediately (begin transmitting &lt;rtt/&gt; elements too); or</li>
      <li>Activate after user confirmation prompt (for <a href="#privacy">Privacy</a> considerations); or</li>
      <li>Deny (transmit &lt;rtt event='cancel'/&gt;); or</li>
      <li>Ignore (discard incoming &lt;rtt/&gt; elements); or</li>
      <li>Display only incoming real-time text (e.g. <a href="#multiuser_chat">Multi-User Chat</a> participants control their own outgoing real-time text).</li>
    </ul>
    <p>To prevent transmission loops, senders SHOULD NOT transmit &lt;rtt event='init'/&gt; automatically in response to incoming &lt;rtt event='init'/&gt;. Upon sending any &lt;rtt/&gt; elements (except &lt;rtt event='cancel'/&gt;), real-time text is considered activated on the sender side and it is not necessary to transmit &lt;rtt event='init'/&gt; again for the chat session while real-time text is active.</p>
    <p>For any client, the preferred first &lt;rtt/&gt; element to send is &lt;rtt <a href="#event">event</a>='init'/&gt; as it can quickly signal activation of real-time text, without waiting for the sender to begin composing a new message, and since it is usable regardless of discovery. Also, if the sender was already composing a message when activating real-time text, <a href="#message_refresh">Message Refresh</a> handles this situation.</p>
    <p>While explicit discovery is strongly RECOMMENDED (see <a href="#determining_support">Determining Support</a>), the sender client MAY implicitly request and discover the use of real-time text, by sending &lt;rtt event='init'/&gt; upon activation. Senders SHOULD NOT send any further &lt;rtt/&gt; elements, until support is confirmed either by incoming &lt;rtt/&gt; elements or via discovery. Implicit discovery makes it possible to use real-time text as an enhancement to <span class="ref"><a href="http://xmpp.org/extensions/xep-0085.html">Chat State Notifications</a></span>  [<a href="#nt-id349869">16</a>] (XEP-0085 Section 5.1), during all situations where it can be used (e.g. when an actively-composing recipient appears invisible/offline to the sender). See <a href="#usage_with_chat_states">Usage with Chat States</a>.</p>
    </div>
    <div class="indent"><h3>6.2 <a name="deactivating_realtime_text" id="deactivating_realtime_text">Deactivating Real-Time Text</a></h3>
    <p>Real-time text MAY be deactivated by transmitting &lt;rtt <a href="#event">event</a>='cancel'/&gt;, or simply by ending the chat session. Recipient clients SHOULD respond to deactivation with appropriate response(s), including:</p>
    <ul>
      <li>Stop transmitting &lt;rtt/&gt; elements as well (not applicable to <a href="#multiuser_chat">Multi-User Chat</a>); and</li>
      <li>Handle the sender's unfinished incoming real-time message; and</li>
      <li>Inform the recipient user that sender ended real-time text (or denied/cancelled, if no real-time text was received).</li>
    </ul>
    <p>Any client MAY also send an &lt;rtt event='cancel'/&gt; when ending the chat session (e.g. user closes a chat window) or when deactivating real-time text while continuing the chat session. Clients receiving &lt;rtt event='cancel'/&gt; do not need to also transmit &lt;rtt event='cancel'/&gt; back.</p>
    <p>Senders deactivating real-time text while in the middle of composing a message can continue composing their message without real-time text being sent. Completed messages continue to be transmitted normally via the <a href="#body_element">Body Element</a>. Recipients that no longer receive further real-time updates, MAY handle the incomplete sender's real-time message appropriately (e.g. clearing/greying-out/saving the message, or using <a href="#stale_messages">Stale Messages</a> handling).</p>
    <p>After deactivation, any client MAY reactivate real-time text again using &lt;rtt event='init'/&gt;.</p>
    </div>
<h2>7.
       <a name="implementation_notes" id="implementation_notes">Implementation Notes</a></h2>
        <div class="indent"><h3>7.1 <a name="text_presentation" id="text_presentation">Text Presentation</a></h3>
        <div class="indent"><h3>7.1.1 <a name="avoid_bursty_text_presentation" id="avoid_bursty_text_presentation">Avoid Bursty Text Presentation</a></h3>
    <p>If a long <a href="#transmission_interval">Transmission Interval</a> is used without <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>, then incoming text will appear in intermittent bursts if the display of text is not smoothed. This hurts user experience of real-time text.</p>
    </div>
    <div class="indent"><h3>7.1.2 <a name="preserving_key_press_intervals" id="preserving_key_press_intervals">Preserving Key Press Intervals</a></h3>
    <p>For high quality presentation of real-time text, the original look-and-feel of typing can be preserved independently of the transmission interval. This is achieved using <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> between other <a href="#action_elements">Action Elements</a>. Sender clients can transmit the length of pauses between key presses, and send multiple key presses in a single &lt;message/&gt; stanza. Recipient clients that process &lt;w/&gt; elements are able to display the sender's typing smoothly without sudden bursts of text. See <a href="#examples_of_key_press_intervals">Examples of Key Press Intervals</a>.</p>
    <p>When key press intervals are preserved at high precision, all subtleties of typing are preserved, including the 'mood' (calm typing versus panicked or emphatic typing, etc.). Much as Voice over IP (VoIP) allows accurate packet transmission of sound, this spec allows accurate packet transmission of original typing look-and-feel. This enables the real-time feel of typing over virtually any network connection, without requiring frequent transmission intervals. Look and feel of typing is also preserved over variable latency connections including <span class="ref"><a href="http://xmpp.org/extensions/xep-0206.html">XMPP Over BOSH</a></span>  [<a href="#nt-id350054">17</a>], mobile phone, satellite and long international connections with heavy packet-bursting tendencies.</p>
    </div>
    <div class="indent"><h3>7.1.3 <a name="time_critical_and_low_latency_methods" id="time_critical_and_low_latency_methods">Time Critical and Low Latency Methods</a></h3>
    <p>There are specialized situations such as live transcriptions and captioning (e.g. transcription service, closed captioning provider, captioned telephone, Communication Access Realtime Translation (CART), relay services) that demand low latency transmission. Such systems typically use voice recognition and/or stenotype machines, which output text in word or phrase bursts rather than a character at a time. It can be acceptable for senders with bursty output to immediately transmit word or phrase bursts of text without buffering, as long as the average stanza rate is not excessive. This eliminates any lag caused by the <a href="#transmission_interval">Transmission Interval</a>. It is not necessary to transmit <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> for real-time transcription.</p>
    </div>
    <div class="indent"><h3>7.1.4 <a name="lowbandwidth_and_lowprecision_text_smoothing" id="lowbandwidth_and_lowprecision_text_smoothing">Low-Bandwidth and Low-Precision Text Smoothing</a></h3>
    <p>Some software platforms (e.g. JavaScript, BOSH, mobile devices) may have low-precision timers that impact <a href="#transmission_interval">Transmission Interval</a> and/or <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>. Clients can optimize for bandwidth, performance and/or screen repaints by eliminating, merging, or ignoring <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> selectively, especially those containing shorter intervals. In addition, it is acceptable for the transmission interval of &lt;rtt/&gt; to vary, either intentionally for optimizations, or due to precision limitation, preferably within the range recommended by <a href="#transmission_interval">Transmission Interval</a>. Compression can also be used to reduce bandwidth (e.g. TLS compression or <span class="ref"><a href="http://xmpp.org/extensions/xep-0138.html">Stream Compression</a></span>  [<a href="#nt-id350154">18</a>]).</p>
    <p>Clients can choose to implement alternate text-smoothing methods, such as adaptive-rate character-at-a-time output, and/or word buffering for incoming real-time text. Word buffering prevents most typing mistakes from being displayed, which can be a useful mode of operation for certain recipients who may dislike watching the sender's typing mistakes.</p>
    </div>
</div>
    <div class="indent"><h3>7.2 <a name="optional_remote_cursor" id="optional_remote_cursor">Optional Remote Cursor</a></h3>
    <p>Recipient clients can choose to display a remote cursor within incoming real-time messages. A remote cursor is a separate cursor/caret indicator within incoming real-time messages, separate of the user's local cursor for outgoing messages. This can improve usability of real-time text, since it becomes easier for a recipient to observe the sender's real-time message edits. For clients that do not implement a remote cursor, skip this section.</p>
    <p><a href="#action_elements">Action Elements</a> use only absolute positioning (relative positions are not used by this specification), so clients do not need to remember the position value from previous action elements. Recipient software can calculate the remote cursor position as follows:</p>
    <ul>
      <li><p>Upon receiving <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a>, the cursor position is the <span class="em"><span class="strong">p</span></span> attribute plus the length of the text being inserted. The cursor position is put at the end of the inserted text.<br />
        <span class="em">This allows normal forward cursor movement during text insertion.</span></p></li>
      <li><p>Upon receiving <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a>, the cursor position is the <span class="em"><span class="strong">p</span></span> attribute minus the <span class="em"><span class="strong">n</span></span> attribute.<br />
        <span class="em">This allows normal backwards cursor movement to a backspace key.</span></p></li>
      <li><p>Upon receiving an empty <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a> (e.g. &lt;t p='#'/&gt; or &lt;t p='#'&gt;&lt;/t&gt;), the cursor position is the <span class="strong">p</span> attribute and no text modification is done. Senders can send these elements when only the cursor position has changed (e.g. arrow keys, mouse repositioning). These are non-operative elements on recipients that do not implement a remote cursor.</p></li>
    </ul>
    </div>
    <div class="indent"><h3>7.3 <a name="sending_realtime_text" id="sending_realtime_text">Sending Real-Time Text</a></h3>
    <p>This section lists several possible methods of generating real-time text for transmission. For most situations, the preferred methodology is <a href="#monitoring_message_changes_instead_of_key_presses">Monitoring Message Changes Instead Of Key Presses</a>.</p>
        <div class="indent"><h3>7.3.1 <a name="monitoring_message_changes_instead_of_key_presses" id="monitoring_message_changes_instead_of_key_presses">Monitoring Message Changes Instead Of Key Presses</a></h3>
    <p>Experience has found that the most reliable method for generating real-time text, is to monitor for <span class="strong">text changes</span> to the sender’s message entry field, instead of key press events. Text change events have the following advantages:</p>
    <ul>
      <li>It captures all typing, including edits and deletes.</li>
      <li>It captures copy &amp; paste operations, as well as edits made via a pointing device.</li>
      <li>It captures all automatic text changes (e.g. spell checker, auto-correct, macros, transcription, assistive devices).</li>
      <li>It captures characters requiring multiple key presses to compose (e.g. accents, combining marks).</li>
      <li>It makes no assumptions about different keyboards or input method editors (e.g. Chinese).</li>
      <li>Text change events are more portable across platforms, including on mobile phones.</li>
    </ul>
    <p>During a text change event, the sender’s current message text can be compared to the old message text from the previous text change event. The difference in text, between consecutive text change events, is typically a one character difference (e.g. key press) or one text block difference (e.g. auto-correct, cut, paste). In order to calculate what text changes took place, the first changed character and the last changed character are determined. From this, it is simple to generate <a href="#action_elements">Action Elements</a> for a single text block deletion and/or insertion. In addition, if <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a> is supported, then <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> records the time elapsed between text change events.</p>
    <p>Sender software can do the following:</p>
    <ol>
      <li><p>Monitor for text changes in the sender’s message. Whenever a text change event occurs, compute action element(s) and append these action element(s) to a buffer. Repeating this step during every text change event, is equivalent to recording a small sequence of typing.</p></li>
      <li><p>During every <a href="#transmission_interval">Transmission Interval</a>, all buffered action elements are transmitted in &lt;rtt/&gt; element in a &lt;message/&gt; stanza. This is equivalent to transmitting a small sequence of typing at a time.</p></li>
      <li><p>If there are no message changes occurring, no unnecessary transmission takes place.</p></li>
    </ol>
    </div>
    <div class="indent"><h3>7.3.2 <a name="monitoring_key_presses_directly" id="monitoring_key_presses_directly">Monitoring Key Presses Directly</a></h3>
    <p>Real-time text can be generated via monitoring key presses. However, this does not have the advantages of <a href="#monitoring_message_changes_instead_of_key_presses">Monitoring Message Changes Instead Of Key Presses</a>. Care needs be taken with automatic changes to the message, generated by means other than key presses. This includes spell check auto-correct, copy and pastes, transcription, input method editors, and multiple key presses required to compose a character (i.e. accents). Key press events can miss these text changes, and this can potentially cause incorrect real-time text to be transmitted.</p>
    </div>
    <div class="indent"><h3>7.3.3 <a name="appendonly_realtime_text" id="appendonly_realtime_text">Append-Only Real-Time Text</a></h3>
    <p>The use of <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a> without any attributes, simply appends text to the end of a message, while the use of <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a> without any attributes, simply erases text from the end of the message. This sending method can also be useful for special-purpose clients where mid-message editing capabilities are not used (e.g. simple transcription, news tickers, relay services, captioned telephone).</p>
    </div>
    <div class="indent"><h3>7.3.4 <a name="simple_realtime_text" id="simple_realtime_text">Simple Real-Time Text</a></h3>
    <p>It is possible for sender clients to use <a href="#message_refresh">Message Refresh</a> to simply re-transmit the whole real-time message, as a method of transmitting text changes. The advantage is very simple implementation. Disadvantages can include the lack of <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>, and extra bandwidth consumption that can occur with longer messages, unless stream compression is used. The below illustrates transmission of the real-time message “<span class="strong">Hello there!</span>” at a regular <a href="#transmission_interval">Transmission Interval</a> while the sender is typing.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;Hel&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='b02'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='456002' event='reset'&gt;
    &lt;t&gt;Hello th&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='c03'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='789003' event='reset'&gt;
    &lt;t&gt;Hello there!&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    <p>Note: The <span class="em"><span class="strong">seq</span></span> attribute can be restarted at any value with &lt;rtt event='reset'/&gt; and &lt;rtt event='new'/&gt;. See <a href="#processing_rules">Processing Rules</a>.</p>
    </div>
</div>
    <div class="indent"><h3>7.4 <a name="receiving_realtime_text" id="receiving_realtime_text">Receiving Real-Time Text</a></h3>
    <p>In order to allow <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a> in incoming real-time text, recipient clients can do the following:</p>
    <ol>
      <li><p>Upon receiving <a href="#action_elements">Action Elements</a> in incoming &lt;rtt/&gt; elements, they are added to a queue in the order they are received. This provides immunity to variable network conditions, since the queueing action will smooth out incoming transmission (e.g. receiving new &lt;rtt/&gt; while still processing action elements from a delayed &lt;rtt/&gt;).</p></li>
      <li><p>The recipient client processes action elements in the queue in sequential order, including pauses from <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a>, if supported. This is equivalent to playing back the sender's original typing.</p></li>
    </ol>
    <p>If <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> is supported, excess lag in incoming real-time text can occur when delayed &lt;rtt/&gt; elements get delivered (e.g. congestion, intermittent wireless reception). To avoid delayed presentation of real-time text, the recipient client needs to speed up processing of action elements. This can be accomplished through a variety of techniques, such as shortening the pauses (<span class="em"><span class="strong">n</span></span> value) in &lt;w/&gt; elements, ignoring excess &lt;w/&gt; elements, immediately outputting action elements that are still queued, and/or keeping action elements from a limited number of &lt;rtt/&gt; elements queued (immediately outputting any prior action elements). This allows lagged real-time text to catch up more quickly.</p>
    <p>Upon receiving a <a href="#body_element">Body Element</a> indicating a completed message, it is acceptable for the full message text from &lt;body/&gt; to be displayed immediately in place of the real-time message, and discard any unprocessed action elements. This prevents any delay in displaying the final message delivery, however, this may cause a sudden surge of text in some situations.</p>
    <p>If the &lt;w/&gt; element is not supported, receiving clients can use an alternate text-smoothing method in order to <a href="#avoid_bursty_text_presentation">Avoid Bursty Text Presentation</a> (e.g. time-smoothed progressive output of received real-time text).</p>
    </div>
    <div class="indent"><h3>7.5 <a name="other_guidelines" id="other_guidelines">Other Guidelines</a></h3>
        <div class="indent"><h3>7.5.1 <a name="message_length" id="message_length">Message Length</a></h3>
    <p>A large sequence of action elements can result in an &lt;rtt/&gt; larger than the size of a message &lt;body/&gt;. This can occur normally during fast typing when <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a> during small messages. However, if the &lt;rtt/&gt; element becomes unusually large (e.g. macros, multiple copy and pastes, leading to an &lt;rtt/&gt; exceeding one kilobyte) a <a href="#message_refresh">Message Refresh</a> can instead be used, in order to save bandwidth. (Stream compression is another approach.)</p>
    <p>Clients can limit the length of the text input for the sender's message, in order to keep the size of &lt;message/&gt; stanzas reasonable, including during <a href="#message_refresh">Message Refresh</a>. Also, large &lt;rtt/&gt; elements might occur in situations such as large copy and pastes. To keep message stanza sizes reasonable, &lt;rtt/&gt; can be transmitted in a separate &lt;message/&gt; than the one containing &lt;body/&gt;.</p>
    <p>For clients that send continuous real-time text (e.g. news ticker, captioning, speech transcription, TTY/text telephone gateway), a <a href="#body_element">Body Element</a> can be sent and then a new real-time message started immediately after, every time a message reaches a specific size. This allows continuous real-time text without real-time messages becoming excessively large.</p>
    </div>
    <div class="indent"><h3>7.5.2 <a name="usage_with_chat_states" id="usage_with_chat_states">Usage with Chat States</a></h3>
    <p>Real-time text can be used in conjunction with Chat State Notifications (XEP-0085). It is best to handle XEP-0301 and XEP-0085 transmissions in separate &lt;message/&gt; stanzas. Chat states such as &lt;composing/&gt; or &lt;active/&gt; are sent separately from &lt;rtt/&gt; elements.</p>
    <p>Chat states are handled as specified by XEP-0085. The continuous transmission of real-time text corresponds to a &lt;composing/&gt; chat state. Therefore, the timing of the &lt;composing/&gt; chat state coincides with the beginning of continuous &lt;rtt/&gt; transmission. </p>
    </div>
    <div class="indent"><h3>7.5.3 <a name="usage_with_last_message_correction" id="usage_with_last_message_correction">Usage with Last Message Correction</a></h3>
    <p>It is possible to use <span class="ref"><a href="http://xmpp.org/extensions/xep-0308.html">Last Message Correction</a></span>  [<a href="#nt-id350697">19</a>] (XEP-0308) with real-time text. If XEP-0308 is implemented in concert with this specification, the following rules apply:</p>
    <ul>
      <li><p>For all &lt;rtt/&gt; elements transmitted during composing a new message, the <span class="em"><a href="#id">id</a></span> attribute of &lt;rtt/&gt; is not used.</p></li>
      <li><p>For all &lt;rtt/&gt; elements transmitted during editing of the previous message, the <span class="em"><span class="strong">id</span></span> attribute of &lt;rtt/&gt; matches the <span class="em"><span class="strong">id</span></span> attribute of the old &lt;message/&gt; stanza containing the &lt;body/&gt; text being edited (see 'Business Rules' in XEP-0308). This enables recipient clients to display real-time text while the sender is editing the previously-delivered message.</p></li>
      <li><p>Senders clients need to transmit a <a href="#message_refresh">Message Refresh</a> when transmitting &lt;rtt/&gt; for a different message than the previously transmitted &lt;rtt/&gt; (i.e. the value of the <span class="em"><span class="strong">id</span></span> attribute changes, <span class="em"><span class="strong">id</span></span> becomes included, or <span class="em"><span class="strong">id</span></span> becomes not included). This keeps real-time text synchronized when beginning to edit a previously delivered message versus continuing to compose a new message.</p></li>
      <li><p>The XEP-0301 and XEP-0308 protocols operate concurrently via separate message stanzas. Thus, a message stanza never simultaneously includes both &lt;rtt/&gt; and &lt;replace/&gt;.</p></li>
      <li><p>The <a href="#body_element">Body Element</a> delivers a finished new message or a finished message correction (&lt;replace/&gt; is used with &lt;body/&gt; in accordance to XEP-0308).</p></li>
    </ul>
    </div>
    <div class="indent"><h3>7.5.4 <a name="usage_with_multiuser_chat_and_simultaneous_logins" id="usage_with_multiuser_chat_and_simultaneous_logins">Usage with Multi-User Chat and Simultaneous Logins</a></h3>
    <p>The in-band nature of this real-time text specification makes it possible to seamlessly integrate real-time text into <span class="ref"><a href="http://xmpp.org/extensions/xep-0045.html">Multi-User Chat</a></span>  [<a href="#nt-id350816">20</a>] (MUC), as well as concurrent simultaneous logins.</p>
        <div class="indent"><h3>7.5.4.1 <a name="multiuser_chat" id="multiuser_chat">Multi-User Chat</a></h3>
    <p>For simplicity, clients can implement real-time text only for one-to-one chat, and not for MUC. However, it can be appropriate to support &lt;rtt/&gt; elements in MUC, even if not all participants support real-time text. Participants that enable real-time text during group chat need to keep track of multiple concurrent real-time messages on a per-participant basis. Participants, with real-time text, will see real-time text coming from each participant that has real-time text enabled. Participant clients without real-time text (whether unsupported or turned off) will simply see group chat function normally on a line-by-line basis, since it is <a href="#backwards_compatible">Backwards Compatible</a>.</p>
    <p>Participants that turn off real-time text for themselves, can simply ignore incoming &lt;rtt/&gt; and not transmit outgoing &lt;rtt/&gt;. Participant clients in MUC receiving an incoming &lt;rtt <a href="#event">event</a>=’cancel’/&gt; needs to keep outgoing transmission unaffected during <a href="#deactivating_realtime_text">Deactivating Real-Time Text</a> (otherwise, one participant could deny real-time text between other willing participants).</p>
    <p>To minimize on-screen clutter of multiple idle real-time messages, clients can hide idle messages, clear old <a href="#stale_messages">Stale Messages</a>, and/or prioritize the display of the most useful real-time messages. Prominent visibility of real-time text can be assigned to recent typists and/or moderators (e.g. classroom teacher, convention speaker). For the same participant logged in multiple times in the same room, see <a href="#simultaneous_logins">Simultaneous Logins</a>. In situations of simultaneous typing by a large number of participants, see <a href="#congestion_considerations">Congestion Considerations</a>.</p>
    </div>
    <div class="indent"><h3>7.5.4.2 <a name="simultaneous_logins" id="simultaneous_logins">Simultaneous Logins</a></h3>
    <p>In situations where there are multiple sessions from the same JID (i.e. simultaneous logins on multiple clients/devices), transmitting of &lt;rtt/&gt; works in one-to-many situations without any special software support. For many-to-one situations where there is incoming &lt;rtt/&gt; from multiple sessions under the same JID, <a href="#keeping_realtime_text_synchronized">Keeping Real-Time Text Synchronized</a> will pause the real-time message upon conflicting &lt;rtt/&gt;, and resume during the next <a href="#message_refresh">Message Refresh</a>, presumably from the active session. This provides a seamless system-switching experience. A good implementation of <a href="#message_refresh">Message Refresh</a> will improve user experience, regardless of whether or not the client follows <span class="ref"><a href="http://xmpp.org/extensions/xep-0296.html">Best Practices for Resource Locking</a></span>  [<a href="#nt-id350945">21</a>]. Clients can choose to distinguish the &lt;rtt/&gt; streams (via full JID and/or via &lt;thread/&gt;) and keep multiple concurrent real-time messages similar in manner to <a href="#multiuser_chat">Multi-User Chat</a>, with the <a href="#stale_messages">Stale Messages</a> being timed-out.</p>
    </div>
</div>
    <div class="indent"><h3>7.5.5 <a name="stale_messages" id="stale_messages">Stale Messages</a></h3>
    <p>There are situations where senders pause typing indefinitely. This can result in recipients displaying a real-time message for an extended time period. It may also be a screen clutter concern during <a href="#multiuser_chat">Multi-User Chat</a>. In addition, it may be a resource-consumption concern, as part of <a href="#congestion_considerations">Congestion Considerations</a>.</p>
    <p>It is acceptable for recipients to clear (and/or save) incoming real-time messages that have been idle for an extended time period. There is no specific time-out period defined by this specification. For <a href="#multiuser_chat">Multi-User Chat</a>, the time-out period might be shorter because of the need to reduce screen clutter. For one-to-one chat sessions, the time-out period might need to be longer to allow reasonable interruptions (i.e. sender pausing during a long phone call or other interruption).</p>
    <p>Senders that resume composing a message (i.e. continues a partially-composed message hours later) can do a <a href="#message_refresh">Message Refresh</a>, which allows recipients to redisplay the real-time message.</p>
    </div>
    <div class="indent"><h3>7.5.6 <a name="performance_efficiency" id="performance_efficiency">Performance &amp; Efficiency</a></h3>
    <p>With real-time text, frequent screen updates can occur. Screen updates are a potential performance bottleneck, since fast typists type many key presses per second. Optimizing screen updates is more important on slower platforms. The real-time message might be implemented as a separate window or separate display element.</p>
    <p>Battery life considerations are closely related to performance, as the addition of real-time text can have an impact on battery life. If <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a> is supported, then support for <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> needs to be implemented in a battery-efficient manner. The <a href="#transmission_interval">Transmission Interval</a> can vary dynamically to optimize for battery life and wireless reception. For devices where screen updates are an unavoidable, inefficient bottleneck, see <a href="#lowbandwidth_and_lowprecision_text_smoothing">Low-Bandwidth and Low-Precision Text Smoothing</a> to reduce the number of screen updates per second.</p>
    </div>
</div>
<h2>8.
       <a name="use_cases" id="use_cases">Use Cases</a></h2>
    <p>Most of these examples are deliberately kept simple. In complete software implementations supporting key press intervals, transmissions will most resemble the last example, <a href="#full_message_including_key_press_intervals">Full Message Including Key Press Intervals</a>. For simplicity, these examples use a bare JID, even in situations where a full JID might be more appropriate.</p>
        <div class="indent"><h3>8.1 <a name="introductory_examples_of_realtime_text" id="introductory_examples_of_realtime_text">Introductory Examples of Real-Time Text</a></h3>
    <p>All three examples shown below result in the same real-time message "<span class="strong">HELLO</span>" created by writing "<span class="strong">HLL</span>", backspacing two times, and then "<span class="strong">ELLO</span>". The action elements are <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a> and <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a>.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;HLL&lt;/t&gt;
    &lt;e/&gt;&lt;e/&gt;
    &lt;t&gt;ELLO&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>The example above sends the misspelled "<span class="strong">HLL</span>", then <span class="strong">&lt;e/&gt;&lt;e/&gt;</span> backspaces 2 times, then sends "<span class="strong">HELLO</span>".</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;HLL&lt;/t&gt;
    &lt;e n='2'/&gt;
    &lt;t&gt;ELLO&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>The example above shows that <span class="strong">&lt;e n='2'/&gt;</span> does the same thing as <span class="strong">&lt;e/&gt;&lt;e/&gt;</span>.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;HLL&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='b02'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123002'&gt;
    &lt;e n='2'/&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='c03'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123003'&gt;
    &lt;t&gt;ELLO&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>The example above splits the same real-time text over multiple &lt;message/&gt; stanzas, which would occur if the typing was occurring more slowly, over several <a href="#transmission_interval">Transmission Interval</a> cycles.</p>
    </div>
    <div class="indent"><h3>8.2 <a name="example_of_multiple_messages" id="example_of_multiple_messages">Example of Multiple Messages</a></h3>
    <p>The example below represents a short chat session of three separate messages:<br />
    Bob says: "Hello Alice"<br />
    Bob says: "This is Bob"<br />
    Bob says: "How are you?"</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='alice@example.com' from='bob@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;Hello&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;
 
&lt;message to='alice@example.com' from='bob@example.com/home' type='chat' id='b02'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123002'&gt;
    &lt;t&gt; Alice&lt;/t&gt;
  &lt;/rtt&gt;
  &lt;body&gt;Hello Alice&lt;/body&gt;
&lt;/message&gt;
 
 
&lt;message to='alice@example.com' from='bob@example.com/home' type='chat' id='c03'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='456001' event='new'&gt;
    &lt;t&gt;This i&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;
 
&lt;message to='alice@example.com' from='bob@example.com/home' type='chat' id='d04'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='456002'&gt;
    &lt;t&gt;s Bob&lt;/t&gt;
  &lt;/rtt&gt;
  &lt;body&gt;This is Bob&lt;/body&gt;
&lt;/message&gt;
 
 
&lt;message to='alice@example.com' from='bob@example.com/home' type='chat' id='e05'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='789001' event='new'&gt;
    &lt;t&gt;How a&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;
 
&lt;message to='alice@example.com' from='bob@example.com/home' type='chat' id='f06'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='789002'&gt;
    &lt;t&gt;re yo&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;
 
&lt;message to='alice@example.com' from='bob@example.com/home' type='chat' id='g07'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='789003'&gt;
    &lt;t&gt;u?&lt;/t&gt;
  &lt;/rtt&gt;
  &lt;body&gt;How are you?&lt;/body&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>The example above represents moderate typing speed during a normal <a href="#transmission_interval">Transmission Interval</a>, such as 700 milliseconds between &lt;message/&gt; stanzas for continuous typing. It illustrates the following:</p>
    <ul>
      <li>The <span class="em"><a href="#event">event</a></span> attribute equals 'new' for the start of every new message.</li>
      <li>The <span class="em"><a href="#seq">seq</a></span> attribute increments within the same message.</li>
      <li>The <span class="em"><a href="#seq">seq</a></span> attribute randomizes when beginning a new message.</li>
    </ul>
    </div>
    <div class="indent"><h3>8.3 <a name="examples_of_message_edits" id="examples_of_message_edits">Examples of Message Edits</a></h3>
    <p>These examples illustrate real-time message editing via <a href="#action_elements">Action Elements</a>.<br />
    Note: In most situations, during normal human typing speeds at a normal <a href="#transmission_interval">Transmission Interval</a>, smaller fragments of text will be spread over multiple &lt;rtt/&gt; elements, than these demonstration examples below. See <a href="#sending_realtime_text">Sending Real-Time Text</a>.</p>
        <div class="indent"><h3>8.3.1 <a name="deleting_text_from_message" id="deleting_text_from_message">Deleting Text From Message</a></h3>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;Hello Bob, this is Alice!&lt;/t&gt;
    &lt;e n='4' p='9'/&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>Final result of real-time message: "<span class="strong">Hello, this is Alice!</span>"<br />
    This example outputs "<span class="strong">Hello Bob, this is Alice!</span>" then <span class="strong">&lt;e n='4' p='9'/&gt;</span> erases 4 characters before character position index 9. The <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a> removes the text " <span class="strong">Bob</span>" including the preceding space character.</p>
    </div>
    <div class="indent"><h3>8.3.2 <a name="inserting_text_into_message" id="inserting_text_into_message">Inserting Text Into Message</a></h3>
    


    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;Hello, this is Alice!&lt;/t&gt;
    &lt;t p='5'&gt; Bob&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>Final result of real-time message: "<span class="strong">Hello Bob, this is Alice!</span>"<br />
    This is because this example outputs "<span class="strong">Hello, this is Alice!</span>" then the <span class="strong">&lt;t p='5'&gt;</span> inserts the specified text " <span class="strong">Bob</span>" at position 5, using <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a>.</p>
    </div>
    <div class="indent"><h3>8.3.3 <a name="deleting_and_replacing_text_in_message" id="deleting_and_replacing_text_in_message">Deleting and Replacing Text In Message</a></h3>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;Hello Bob, tihsd is Alice!&lt;/t&gt;
    &lt;e p='16' n='5'/&gt;
    &lt;t p='11'&gt;this&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>Final result of real-time message: "<span class="strong">Hello Bob, this is Alice!</span>"<br />
    This example outputs "<span class="strong">Hello Bob, tihsd is Alice!</span>", then <span class="strong">&lt;e p='16' n='5'/&gt;</span> erases 5 characters at position 16 in the string of text (which erases the mistyped word "<span class="strong">tihsd</span>"). Finally, <span class="strong">&lt;t p='11'&gt;this&lt;/t&gt;</span> inserts the text "<span class="strong">this</span>" place of the original misspelled word.</p>
    </div>
    <div class="indent"><h3>8.3.4 <a name="multiple_message_edits" id="multiple_message_edits">Multiple Message Edits</a></h3>
    <p>This is an example message containing multiple consecutive real-time message edits. This illustrates valid use of the &lt;rtt/&gt; element.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;Helo&lt;/t&gt;
    &lt;e/&gt;
    &lt;t&gt;lo...planet&lt;/t&gt;
    &lt;e n='6'/&gt;
    &lt;t&gt; World&lt;/t&gt;
    &lt;e n='3' p='8'/&gt;
    &lt;t p='5'&gt; there,&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>Resulting real-time message: "<span class="strong">Hello there, World</span>", completed in the following series of action elements:</p>
        <div class="indent"><p class="caption"><a name="table-3" id="table-3"></a>Table 3: </p><table border="1" cellpadding="3" cellspacing="0">
          <tr class="body">
            <th>Element</th>
            <th>Action</th>
            <th>Real -Time Message</th>
            <th>Cursor Position*</th>
          </tr>
          <tr class="body">
            <td>&lt;t&gt;Helo&lt;/t&gt;</td>
            <td>Output "Helo"</td>
            <td>Helo</td>
            <td>4</td>
          </tr>
          <tr class="body">
            <td>&lt;e/&gt;</td>
            <td>Erase 1 character from end of line.</td>
            <td>Hel</td>
            <td>3</td>
          </tr>
          <tr class="body">
            <td>&lt;t&gt;lo...planet&lt;/t&gt;</td>
            <td>Output "lo...planet" at end of line.</td>
            <td>Hello...planet</td>
            <td>14</td>
          </tr>
          <tr class="body">
            <td>&lt;e n='6'/&gt;</td>
            <td>Erase 6 characters from end of line</td>
            <td>Hello...</td>
            <td>8</td>
          </tr>
          <tr class="body">
            <td>&lt;t&gt; World&lt;/t&gt;</td>
            <td>Output " World" at end of line.</td>
            <td>Hello... World</td>
            <td>14</td>
          </tr>
          <tr class="body">
            <td>&lt;e n='3' p='8'/&gt;</td>
            <td>Erase 3 characters before position 8</td>
            <td>Hello World</td>
            <td>5</td>
          </tr>
          <tr class="body">
            <td>&lt;t p='5'&gt; there,&lt;/t&gt;</td>
            <td>Output " there," at position 5</td>
            <td>Hello there, World</td>
            <td>12</td>
          </tr>
        </table></div>
    <p>*The Cursor Position column is only relevant if the <a href="#optional_remote_cursor">Optional Remote Cursor</a> is implemented.</p>
    <p>This example does not illustrate <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>. Also, it is noted that most situations, during normal typing speeds at a normal <a href="#transmission_interval">Transmission Interval</a>, the above series of <a href="#action_elements">Action Elements</a> will normally be spread over multiple separate &lt;rtt/&gt; elements.</p>
    </div>
</div>
    <div class="indent"><h3>8.4 <a name="examples_of_key_press_intervals" id="examples_of_key_press_intervals">Examples of Key Press Intervals</a></h3>
        <div class="indent"><h3>8.4.1 <a name="comparison_with_and_without_intervals" id="comparison_with_and_without_intervals">Comparison With and Without Intervals</a></h3>
    <p>All examples shown below, result in the same real-time message “<span class="strong">HELLO</span>”. Only the last example follows <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;HELLO&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    <p>The above example outputs “<span class="strong">HELLO</span>” in a single action element (<a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a>).</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;H&lt;/t&gt;
    &lt;t&gt;E&lt;/t&gt;
    &lt;t&gt;L&lt;/t&gt;
    &lt;t&gt;L&lt;/t&gt;
    &lt;t&gt;O&lt;/t&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    <p>The above example outputs “<span class="strong">HELLO</span>” in separate action elements for each key press.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;H&lt;/t&gt;&lt;w n='101'/&gt;
    &lt;t&gt;E&lt;/t&gt;&lt;w n='110'/&gt;
    &lt;t&gt;L&lt;/t&gt;&lt;w n='125'/&gt;
    &lt;t&gt;L&lt;/t&gt;&lt;w n='103'/&gt;
    &lt;t&gt;O&lt;/t&gt;&lt;w n='110'/&gt;
  &lt;/rtt&gt;
&lt;/message&gt;</pre></div></p>
    <p>The above example outputs “<span class="strong">HELLO</span>” in separate action elements for each key press, while also <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>. The <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> specifies the number of milliseconds between key presses, to allow smooth presentation in recipient clients that support &lt;w/&gt; action elements.</p>
    </div>
    <div class="indent"><h3>8.4.2 <a name="full_message_including_key_press_intervals" id="full_message_including_key_press_intervals">Full Message Including Key Press Intervals</a></h3>
    <p>This example is a transmission of “Hello there!” while <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>. It illustrates a four-second typing sequence:</p>
    <ul>
      <li>The misspelled phrase “Hello tehre!” is typed;</li>
      <li>Optional transmission of cursor movements towards the typing mistake;</li>
      <li>Two backspaces to delete the typing mistake;</li>
      <li>Two correct key presses to correctly spell the word “there”.</li>
    </ul>
    <p>The use <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a>, between key presses, allows the receiving client to execute a small pause between action elements. This allows recipient clients to play back the sender's typing fluidly.</p>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='a01'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123001' event='new'&gt;
    &lt;t&gt;H&lt;/t&gt;
    &lt;w n='115'/&gt;&lt;t&gt;e&lt;/t&gt;
    &lt;w n='154'/&gt;&lt;t&gt;l&lt;/t&gt;
    &lt;w n='151'/&gt;&lt;t&gt;l&lt;/t&gt;
    &lt;w n='115'/&gt;&lt;t&gt;o&lt;/t&gt;
    &lt;w n='165'/&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='b02'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123002'&gt;
    &lt;w n='40'/&gt;&lt;t&gt; &lt;/t&gt;
    &lt;w n='161'/&gt;&lt;t&gt;t&lt;/t&gt;
    &lt;w n='137'/&gt;&lt;t&gt;e&lt;/t&gt;
    &lt;w n='135'/&gt;&lt;t&gt;h&lt;/t&gt;
    &lt;w n='134'/&gt;&lt;t&gt;r&lt;/t&gt;
    &lt;w n='93'/&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='c03'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123003'&gt;
    &lt;w n='109'/&gt;&lt;t&gt;e&lt;/t&gt;
    &lt;w n='115'/&gt;&lt;t&gt;!&lt;/t&gt;
    &lt;w n='330'/&gt;&lt;t p='11'/&gt;
    &lt;w n='108'/&gt;&lt;t p='10'/&gt;
    &lt;w n='38'/&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='d04'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123004'&gt;
    &lt;w n='109'/&gt;&lt;t p='9'/&gt;
    &lt;w n='111'/&gt;&lt;e p='9'/&gt;
    &lt;w n='106'/&gt;&lt;e p='8'/&gt;
    &lt;w n='138'/&gt;&lt;t p='7'&gt;h&lt;/t&gt;
    &lt;w n='209'/&gt;&lt;t p='8'&gt;e&lt;/t&gt;
    &lt;w n='27'/&gt;
  &lt;/rtt&gt;
&lt;/message&gt;

&lt;message to='bob@example.com' from='alice@example.com/home' type='chat' id='d04'&gt;
  &lt;rtt xmlns='urn:xmpp:rtt:0' seq='123005'&gt;
    &lt;w n='445'/&gt;&lt;t p='12'/&gt;
  &lt;/rtt&gt;
  &lt;body&gt;Hello there!&lt;/body&gt;
&lt;/message&gt;</pre></div></p>
    


    <p>This example also illustrates the following:</p>
    <ul>
      <li>Typing is done via <a href="#element_t_insert_text">Element &lt;t/&gt; – Insert Text</a>.</li>
      <li>Backspaces are done via <a href="#element_e_erase_text">Element &lt;e/&gt; – Erase Text</a>.</li>
      <li>There is a final transmission with a <a href="#body_element">Body Element</a>, when the message is finished.</li>
      <li>Intervals between key presses are done via <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a>.</li>
      <li>Each &lt;message/&gt; is delivered at a regular <a href="#transmission_interval">Transmission Interval</a>, typically 700 milliseconds.</li>
      <li>Cursor movements via empty &lt;t/&gt; elements. Sender transmission is not essential, but can be desirable for recipient clients supporting an <a href="#optional_remote_cursor">Optional Remote Cursor</a>.</li>
      <li>Recipient clients that do not support <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a> and/or <a href="#optional_remote_cursor">Optional Remote Cursor</a>, will still display this message normally.</li>
      <li>The total sum of all values in <a href="#element_w_wait_interval">Element &lt;w/&gt; – Wait Interval</a> in one &lt;message/&gt; equal the <a href="#transmission_interval">Transmission Interval</a> during periods of continuous typing. This also results in some &lt;w/&gt; interval elements being split between consecutive messages. Although not critical, it can further improve the fluidity of <a href="#receiving_realtime_text">Receiving Real-Time Text</a>.</li>
      <li>See <a href="#monitoring_message_changes_instead_of_key_presses">Monitoring Message Changes Instead Of Key Presses</a> for the best method of implementation.</li>
    </ul>
    </div>
</div>
<h2>9.
       <a name="interoperability_considerations" id="interoperability_considerations">Interoperability Considerations</a></h2>
    <p>There are other real-time text formats with interoperability considerations relating to the session setup level, the media transport level, and presentation level. Interoperability specifications between multiple real-time text formats can be found at Real-Time Text Taskforce (R3TF).</p>
    <p>Implementers ought to choose the most appropriate real-time text approach for the session control technology in use during a particular session. For example, clients that use XMPP can utilize this XEP-0301 specification, and clients that use SIP might utilize IETF RFC 4103, <span class="ref"><span class="strong"><a href="http://tools.ietf.org/html/rfc5194">IETF RFC 5194</a></span></span>
   [<a href="#nt-id351924">22</a>] and ITU-T T.140. Clients that run on multiple networks, might need to utilize multiple real-time text technologies. To interoperate between incompatible real-time text technologies, gateway servers can transcode between different real-time text technologies, along with other media such as audio and video. This can include TTY and textphones.</p>
        <div class="indent"><h3>9.1 <a name="rfc_4103_and_t140" id="rfc_4103_and_t140">RFC 4103 and T.140</a></h3>
    <p>In the SIP environment, real-time text is specified in IETF RFC 4103 and ITU-T T.140. SIP is a popular real-time session control protocol, and there are many implementations of real-time text controlled by SIP. This includes emergency services in some regions.</p>
    <p>Interoperability considerations include addressing translation, media negotiation and translation, and media transcoding. Transcoding is straightforward between this specification and T.140/RFC4103, except for editing in the middle of messages. Text insertions or deletions, occurring far back in the message, can cause a large number of erase operations in T.140 that consume time and bandwidth. T.140 specifies the use of ISO 6429 control codes for presentation characteristics, such as text color, that are not supported by this specification. During transcoding, these control codes needs to be filtered off in order to not disturb the presentation of text. Guidance on address translation and conveyance between XMPP and SIP can be found at <span class="ref"><span class="strong"><a href="http://tools.ietf.org/html/draft-ietf-stox-core">IETF stox</a></span></span>
   [<a href="#nt-id351970">23</a>].</p>
    </div>
    <div class="indent"><h3>9.2 <a name="total_conversation_combination_with_audio_and_video" id="total_conversation_combination_with_audio_and_video">Total Conversation – Combination with Audio and Video</a></h3>
    <p>According to ITU-T Rec. F.703, the “Total Conversation” standard defines the simultaneous use of audio, video, and real-time text. For convenience, real-time communication applications can be designed to have automatic negotiation of as many as possible of the three media preferred by the users.</p>
    <p>In the XMPP session environment, the Jingle protocol (<span class="ref"><a href="http://xmpp.org/extensions/xep-0166.html">Jingle</a></span>  [<a href="#nt-id352024">24</a>]) is available for negotiation and transport of the more time-critical, real-time audio and video media. Any combination of audio, video, and real-time text can be used together simultaneously.</p>
    </div>
<h2>10.
       <a name="internationalization_considerations" id="internationalization_considerations">Internationalization Considerations</a></h2>
    <p>The primary internationalization consideration involves real-time message editing using <a href="#action_elements">Action Elements</a>, where text is inserted and deleted using position and length values. For this, <a href="#accurate_processing_of_action_elements">Accurate Processing of Action Elements</a> including correct <a href="#unicode_character_counting">Unicode Character Counting</a> will ensure that all possible valid Unicode text can be used via this protocol. This includes text containing multiple scripts/languages, ideographic symbols (e.g. Chinese), right-to-left text (e.g. Arabic), and bidirectional text.</p>
    <p>For accessibility considerations, there is an <span class="ref"><span class="strong"><a href="http://www.fasttext.org">International Symbol of Real-Time Text</a></span></span>
   [<a href="#nt-id352073">25</a>] to alert users to the existence of this feature.</p>
    <h2>11.
       <a name="security_considerations" id="security_considerations">Security Considerations</a></h2>
        <div class="indent"><h3>11.1 <a name="privacy" id="privacy">Privacy</a></h3>
    <p>It is important for users to be made aware of real-time text (e.g. user consent, software notice, introductory explanation). Users of real-time text need to be aware that their typing is now visible in real-time to everyone in the current chat conversation. There can be potential security implications if users copy &amp; paste private information into their chat entry buffer (e.g. a shopping invoice) before editing out the private parts of the pasted text (e.g. a credit card number) and then sending the message. There can also be implications for chat clients that suddenly pop up a chat window upon incoming messages and takes keyboard focus unexpectedly, resulting in the sender typing sensitive information into the wrong window. These accidental privacy risks are also apparent for traditional chat (e.g. accidentally sending a message) but are more immediate for real-time text. With real-time message editing, recipients can watch all text changes that occur in the sender's text, before the sender finishes the message.</p>
    <p>Such risks can be avoided by good user interface design. In addition, implementation behaviors and improved education can be added to reduce privacy issues. Examples include showing an introduction upon first activation of feature, special handling for copy and pastes (i.e. preventing them, or prompting for confirmation), recipient confirmation of real-time text via <a href="#guidelines_for_initiating_realtime_text">Guidelines for Initiating Real-Time Text</a>, etc.</p>
    </div>
    <div class="indent"><h3>11.2 <a name="encryption" id="encryption">Encryption</a></h3>
    <p>Real-time text (&lt;rtt/&gt; elements) transmits the content contained within messages. Therefore, a client that encrypts &lt;body/&gt; also needs to encrypt &lt;rtt/&gt; as well:</p>
    <ul>
      <li><p>Encryption at the stream level (e.g. TLS) can be used normally with this specification. Stream-level encryption is the most common form of encryption.</p></li>
      <li><p>Encryption at the &lt;message/&gt; stanza level (e.g. XEP-0200) can be used for all stanzas containing either &lt;rtt/&gt; or &lt;body/&gt;. It is noted that real-time text can have a higher rate of message stanzas, contributing to additional overhead. See <a href="#congestion_considerations">Congestion Considerations</a>.</p></li>
      <li><p>Encryption at the &lt;body/&gt; level (e.g. deprecated XEP-0027) does not encrypt &lt;rtt/&gt;. In this case, &lt;rtt/&gt; needs to be encrypted separately. It is preferable to use a broader level of encryption, where possible.</p></li>
    </ul>
    <p>It is possible for the timing of individual key presses to be used as a timing attack on encryption. Protection against this is provided by buffering of key presses into a regular <a href="#transmission_interval">Transmission Interval</a>. As an additional measure of security, the risk of timing attacks can be further mitigated by padding &lt;rtt/&gt; elements to lengths not clearly related to the number of characters in the message. Alternatively, general XMPP protection mechanisms hiding length information can be applied on the complete message exchange instead of (or in concert with) &lt;rtt/&gt; specific protection mechanisms.</p>
    </div>
    <div class="indent"><h3>11.3 <a name="congestion_considerations" id="congestion_considerations">Congestion Considerations</a></h3>
    <p>The nature of real-time text can result in more frequent transmission of &lt;message/&gt; stanzas than would otherwise happen in a non-real-time text conversation. This can lead to increased network and server loading of XMPP networks.</p>
    <p>Transmission of real-time text can be throttled temporarily during poor network conditions. It is appropriate to use latency monitoring mechanisms (e.g. <span class="ref"><a href="http://xmpp.org/extensions/xep-0184.html">Message Delivery Receipts </a></span>  [<a href="#nt-id352243">26</a>] or <span class="ref"><a href="http://xmpp.org/extensions/xep-0198.html">Stream Management</a></span>  [<a href="#nt-id352266">27</a>]) in order to temporarily adjust the <a href="#transmission_interval">Transmission Interval</a> of real-time text beyond the recommended range. This results in lagged text (less real-time) but is better than failure during poor network conditions. The use of <a href="#message_refresh">Message Refresh</a> can also retransmit real-time text lost by poor network conditions, including stanzas dropped during a network issue or server error. These techniques are useful for mission-critical applications such as next generation emergency services (e.g. text to 9-1-1).</p>
    <p>Excess numbers of real-time messages (e.g. during a Denial of Service (DoS) scenario in <a href="#multiuser_chat">Multi-User Chat</a>) might cause local resource-consumption issues, which can be mitigated by accelerated time-out of <a href="#stale_messages">Stale Messages</a>. Also see <span class="ref"><a href="http://xmpp.org/extensions/xep-0205.html">Best Practices to Discourage Denial of Service Attacks</a></span>  [<a href="#nt-id352355">28</a>].</p>
    <p>According to multiple university studies worldwide (including <span class="ref"><span class="strong"><a href="http://seattle.intel-research.net/~davraham/pubs/Avrahami_CSCW_06.pdf">Carnegie Mellon University Study</a></span></span>
   [<a href="#nt-id352312">29</a>]), the average length of instant messages is under 40 characters. The additional incremental bandwidth overhead of real-time text can be very low for an existing XMPP client, especially one already using many extensions. Bandwidth can also be further mitigated using stream compression, to benefit bandwidth-constrained networks (e.g. GPRS, 3G, satellite).</p>
    </div>
<h2>12.
       <a name="iana_considerations" id="iana_considerations">IANA Considerations</a></h2>
    <p>This document requires no interaction with the Internet Assigned Numbers Authority (IANA).</p>
    <h2>13.
       <a name="xmpp_registrar_considerations" id="xmpp_registrar_considerations">XMPP Registrar Considerations</a></h2>
        <div class="indent"><h3>13.1 <a name="protocol_namespaces" id="protocol_namespaces">Protocol Namespaces</a></h3>
    <p>The XMPP Registrar should include "urn:xmpp:rtt:0" in its registry of protocol namespaces (see &lt;<a href="http://xmpp.org/registrar/namespaces.html">http://xmpp.org/registrar/namespaces.html</a>&gt;).</p>
    </div>
    <div class="indent"><h3>13.2 <a name="namespace_versioning" id="namespace_versioning">Namespace Versioning</a></h3>
    <p>If the protocol defined in this specification undergoes a revision that is not fully backwards-compatible with an older version, the XMPP Registrar shall increment the protocol version number found at the end of the XML namespaces defined herein, as described in Section 4 of XEP-0053.</p>
    </div>
<h2>14.
       <a name="xml_schema" id="xml_schema">XML Schema</a></h2>
    <p><p class="caption"></p><div class="indent"><pre class="prettyprint">&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:rtt:0'
    xmlns='urn:xmpp:rtt:0'
    elementFormDefault='qualified'&gt;

  &lt;xs:annotation&gt;
    &lt;xs:documentation&gt;
      The protocol documented by this schema is defined in
      XEP-0301: http://www.xmpp.org/extensions/xep-0301.html
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

  &lt;xs:element name='rtt'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:attribute name='seq' type='xs:unsignedInt' use='required'/&gt;
      &lt;xs:attribute name='event' use='optional' default='edit'&gt;
        &lt;xs:simpleType&gt;
          &lt;xs:restriction base='xs:string'&gt;
            &lt;xs:enumeration value='new'/&gt;
            &lt;xs:enumeration value='reset'/&gt;
            &lt;xs:enumeration value='edit'/&gt;
            &lt;xs:enumeration value='init'/&gt;
            &lt;xs:enumeration value='cancel'/&gt;
          &lt;/xs:restriction&gt;
        &lt;/xs:simpleType&gt;
      &lt;/xs:attribute&gt;
      &lt;xs:attribute name='id' type='xs:string' use='optional'&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref='t' minOccurs='0' maxOccurs='unbounded'/&gt;
        &lt;xs:element ref='e' minOccurs='0' maxOccurs='unbounded'/&gt;
        &lt;xs:element ref='w' minOccurs='0' maxOccurs='unbounded'/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='t' type='xs:string'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:attribute name='p' type='xs:unsignedInt' use='optional'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='e' type='empty'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:attribute name='p' type='xs:unsignedInt' use='optional'/&gt;
      &lt;xs:attribute name='n' type='xs:unsignedInt' use='optional' default='1'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='w' type='empty'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:attribute name='n' type='xs:unsignedInt' use='required'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:simpleType name='empty'&gt;
    &lt;xs:restriction base='xs:string'&gt;
      &lt;xs:enumeration value=''/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;</pre></div></p>
    <h2>15.
       <a name="acknowledgments" id="acknowledgments">Acknowledgments</a></h2>
    <p>The members of the Real-Time Text Taskforce (R3TF), <a href="">www.realtimetext.org</a>, made significant contributions to this specification. Mark Rejhon leads the Jabber/XMPP Taskgroup at R3TF. Members of R3TF who have contributed to this specification include Gunnar Hellstrom, Paul E. Jones, Gregg Vanderheiden, Barry Dingle, and Arnoud van Wijk. Others contributors include Bernard Aboba, Mark Grady, Darren Sturman, Christian Vogler, Norm Williams, and several members from the XMPP Standards Mailing List, including Kevin Smith, Peter Saint-Andre and many others.</p>
    <p>The technique of <a href="#preserving_key_press_intervals">Preserving Key Press Intervals</a>, otherwise called "natural typing", was created by Mark Rejhon, who is deaf. It is incorporated into this specification in compliance of the XSF's Intellectual Property Rights Policy at <a href="">http://xmpp.org/extensions/ipr-policy.shtml</a>.</p>
    

<hr /><a name="appendices" id="appendices"></a><h2>Appendices</h2><hr /><a name="appendix-docinfo" id="appendix-docinfo"></a><h3>Appendix A: Document Information</h3><p class="indent">
            Series: <a href="http://xmpp.org/extensions/">XEP</a><br />
            Number: 0301<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status: 
            <a href="http://xmpp.org/extensions/xep-0001.html#states-Proposed">Proposed</a><br />
            Type:
            <a href="http://xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.11<br />
            Last Updated: 2013-07-31<br />
                Approving Body: <a href="http://xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XMPP IM, XEP-0030<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: NOT_YET_ASSIGNED<br />
              Source Control: 
                <a class="standardsButton" href="http://gitorious.org/xmpp/xmpp/blobs/master/extensions/xep-0301.xml">HTML</a><br />
            This document in other formats: 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0301.xml">XML</a> 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0301.pdf">PDF</a></p><hr /><a name="appendix-authorinfo" id="appendix-authorinfo"></a><h3>Appendix B: Author Information</h3><div class="indent"><h3>Mark Rejhon</h3><p class="indent">
        Email:
        <a href="mailto:mark@realjabber.org">mark@realjabber.org</a><br />
        JabberID: 
        <a href="xmpp:markybox@gmail.com">markybox@gmail.com</a><br />
        URI: 
        <a href="http://www.realjabber.org">http://www.realjabber.org</a><br /></p><h3>Gunnar Hellstrom</h3><p class="indent">
        Email:
        <a href="mailto:gunnar.hellstrom@omnitor.se">gunnar.hellstrom@omnitor.se</a><br />
        URI: 
        <a href="http://www.omnitor.se">http://www.omnitor.se</a><br /></p></div><hr /><a name="appendix-legal" id="appendix-legal"></a><h3>Appendix C: Legal Notices</h3><div class="indent"><h4>Copyright</h4>This XMPP Extension Protocol is copyright © 1999 - 2013 by the <a href="http://xmpp.org/">XMPP Standards Foundation</a> (XSF).<h4>Permissions</h4>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h4>Disclaimer of Warranty</h4><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</span><h4>Limitation of Liability</h4>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h4>IPR Conformance</h4>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="http://xmpp.org/about-xmpp/xsf/xsf-ipr-policy/">http://xmpp.org/about-xmpp/xsf/xsf-ipr-policy/</a>&gt; or obtained by writing to XMPP Standards Foundation, 1899 Wynkoop Street, Suite 600, Denver, CO 80202 USA).</div><hr /><a name="appendix-xmpp" id="appendix-xmpp"></a><h3>Appendix D: Relation to XMPP</h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><hr /><a name="appendix-discuss" id="appendix-discuss"></a><h3>Appendix E: Discussion Venue</h3><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><hr /><a name="appendix-conformance" id="appendix-conformance"></a><h3>Appendix F: Requirements Conformance</h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><a name="appendix-notes" id="appendix-notes"></a><h3>Appendix G: Notes</h3><div class="indent"><p><a name="nt-id347410" id="nt-id347410">1</a>. RFC 4103: RTP Payload for Text Conversation &lt;<a href="http://tools.ietf.org/html/rfc4103">http://tools.ietf.org/html/rfc4103</a>&gt;.</p><p><a name="nt-id347433" id="nt-id347433">2</a>. Gallaudet University Technology Access Program collaboration project: Real-Time Text &lt;<a href="http://tap.gallaudet.edu/rtt/">http://tap.gallaudet.edu/rtt/</a>&gt;.</p><p><a name="nt-id347455" id="nt-id347455">3</a>. RFC 6443: Framework for Emergency Calling Using Internet Multimedia &lt;<a href="http://tools.ietf.org/html/rfc6443">http://tools.ietf.org/html/rfc6443</a>&gt;.</p><p><a name="nt-id347479" id="nt-id347479">4</a>. Real-Time Text Taskforce, a foundation for real-time text standardization &lt;<a href="http://www.realtimetext.org">http://www.realtimetext.org</a>&gt;.</p><p><a name="nt-id347570" id="nt-id347570">5</a>. ITU-T T.140: Protocol for multimedia application text conversation &lt;<a href="http://www.itu.int/rec/T-REC-T.140">http://www.itu.int/rec/T-REC-T.140</a>&gt;.</p><p><a name="nt-id347606" id="nt-id347606">6</a>. ITU-T Rec. F.703: Multimedia conversational services &lt;<a href="http://www.itu.int/rec/T-REC-F.703">http://www.itu.int/rec/T-REC-F.703</a>&gt;.</p><p><a name="nt-id347668" id="nt-id347668">7</a>. ITU-T Rec. F.700: Framework Recommendation for multimedia services &lt;<a href="http://www.itu.int/rec/T-REC-F.700">http://www.itu.int/rec/T-REC-F.700</a>&gt;.</p><p><a name="nt-id348347" id="nt-id348347">8</a>. RFC 6121: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence &lt;<a href="http://tools.ietf.org/html/rfc6121">http://tools.ietf.org/html/rfc6121</a>&gt;.</p><p><a name="nt-id349068" id="nt-id349068">9</a>. XEP-0201: Best Practices for Message Threads &lt;<a href="http://xmpp.org/extensions/xep-0201.html">http://xmpp.org/extensions/xep-0201.html</a>&gt;.</p><p><a name="nt-id349370" id="nt-id349370">10</a>. RFC 5198: Unicode Format for Network Interchange &lt;<a href="http://tools.ietf.org/html/rfc5198">http://tools.ietf.org/html/rfc5198</a>&gt;.</p><p><a name="nt-id349501" id="nt-id349501">11</a>. XEP-0071: XHTML-IM &lt;<a href="http://xmpp.org/extensions/xep-0071.html">http://xmpp.org/extensions/xep-0071.html</a>&gt;.</p><p><a name="nt-id349515" id="nt-id349515">12</a>. Unicode Standard Annex #15: Unicode Normalization Forms &lt;<a href="http://www.unicode.org/reports/tr15/">http://www.unicode.org/reports/tr15/</a>&gt;.</p><p><a name="nt-id349576" id="nt-id349576">13</a>. XML: Extensible Markup Language 1.0 (Fifth Edition) &lt;<a href="http://www.w3.org/TR/xml/">http://www.w3.org/TR/xml/</a>&gt;.</p><p><a name="nt-id349681" id="nt-id349681">14</a>. XEP-0030: Service Discovery &lt;<a href="http://xmpp.org/extensions/xep-0030.html">http://xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-id349732" id="nt-id349732">15</a>. XEP-0115: Entity Capabilities &lt;<a href="http://xmpp.org/extensions/xep-0115.html">http://xmpp.org/extensions/xep-0115.html</a>&gt;.</p><p><a name="nt-id349869" id="nt-id349869">16</a>. XEP-0085: Chat State Notifications &lt;<a href="http://xmpp.org/extensions/xep-0085.html">http://xmpp.org/extensions/xep-0085.html</a>&gt;.</p><p><a name="nt-id350054" id="nt-id350054">17</a>. XEP-0206: XMPP Over BOSH &lt;<a href="http://xmpp.org/extensions/xep-0206.html">http://xmpp.org/extensions/xep-0206.html</a>&gt;.</p><p><a name="nt-id350154" id="nt-id350154">18</a>. XEP-0138: Stream Compression &lt;<a href="http://xmpp.org/extensions/xep-0138.html">http://xmpp.org/extensions/xep-0138.html</a>&gt;.</p><p><a name="nt-id350697" id="nt-id350697">19</a>. XEP-0308: Last Message Correction &lt;<a href="http://xmpp.org/extensions/xep-0308.html">http://xmpp.org/extensions/xep-0308.html</a>&gt;.</p><p><a name="nt-id350816" id="nt-id350816">20</a>. XEP-0045: Multi-User Chat &lt;<a href="http://xmpp.org/extensions/xep-0045.html">http://xmpp.org/extensions/xep-0045.html</a>&gt;.</p><p><a name="nt-id350945" id="nt-id350945">21</a>. XEP-0296: Best Practices for Resource Locking &lt;<a href="http://xmpp.org/extensions/xep-0296.html">http://xmpp.org/extensions/xep-0296.html</a>&gt;.</p><p><a name="nt-id351924" id="nt-id351924">22</a>. RFC 5194: Framework for Real-Time Text over IP Using the Session Initiation Protocol (SIP) &lt;<a href="http://tools.ietf.org/html/rfc5194">http://tools.ietf.org/html/rfc5194</a>&gt;.</p><p><a name="nt-id351970" id="nt-id351970">23</a>. Interworking between the Session Initiation Protocol (SIP) and the Extensible Messaging and Presence Protocol (XMPP): Addresses and Error Conditions &lt;<a href=" http://tools.ietf.org/html/draft-ietf-stox-core">http://tools.ietf.org/html/draft-ietf-stox-core</a>&gt;.</p><p><a name="nt-id352024" id="nt-id352024">24</a>. XEP-0166: Jingle &lt;<a href="http://xmpp.org/extensions/xep-0166.html">http://xmpp.org/extensions/xep-0166.html</a>&gt;.</p><p><a name="nt-id352073" id="nt-id352073">25</a>. The International Symbol of Real-Time Text &lt;<a href="http://www.fasttext.org">http://www.fasttext.org</a>&gt;.</p><p><a name="nt-id352243" id="nt-id352243">26</a>. XEP-0184: Message Delivery Receipts &lt;<a href="http://xmpp.org/extensions/xep-0184.html">http://xmpp.org/extensions/xep-0184.html</a>&gt;.</p><p><a name="nt-id352266" id="nt-id352266">27</a>. XEP-0198: Stream Management &lt;<a href="http://xmpp.org/extensions/xep-0198.html">http://xmpp.org/extensions/xep-0198.html</a>&gt;.</p><p><a name="nt-id352355" id="nt-id352355">28</a>. XEP-0205: Best Practices to Discourage Denial of Service Attacks &lt;<a href="http://xmpp.org/extensions/xep-0205.html">http://xmpp.org/extensions/xep-0205.html</a>&gt;.</p><p><a name="nt-id352312" id="nt-id352312">29</a>. Communication Characteristcs of Instant Messaging: Effects and Predictions of Interpersonal Relationships &lt;<a href="http://seattle.intel-research.net/~davraham/pubs/Avrahami_CSCW_06.pdf">http://seattle.intel-research.net/~davraham/pubs/Avrahami_CSCW_06.pdf</a>&gt;.</p></div><hr /><a name="appendix-revs" id="appendix-revs"></a><h3>Appendix H: Revision History</h3><p>Note: Older versions of this specification might be available at <a href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a></p><div class="indent"><h4>Version 0.11 (2013-07-31)</h4><div class="indent"><p>Changes recommended by Kevin Smith during Last Call. One section moved (activation/deactivation guidelines).</p> (MDR)
    </div><h4>Version 0.10 (2013-06-24)</h4><div class="indent"><p>Changes from Last Call feedback.</p> (MDR)
    </div><h4>Version 0.9 (2013-05-18)</h4><div class="indent"><p>Minor corrections and clarifications.</p> (MDR)
    </div><h4>Version 0.8 (2013-04-08)</h4><div class="indent"><p>Several clarifications made to several sections. 
    Removed references to proprietary products. New "Processing Rules" section added.
    Set a default &lt;rtt/&gt; event attribute value of 'edit', if no event
    attribute is specified.</p> (MDR)
    </div><h4>Version 0.7 (2012-08-08)</h4><div class="indent"><p>Simplifications and grammatical corrections. Some sections (1, 6.2, 6.4) shortened with simpler language.</p> (MDR)
    </div><h4>Version 0.6 (2012-07-28)</h4><div class="indent"><p>Changes and improvements in preparation for advance to Draft.  Unified
    &lt;e/&gt; element (Erase Text) to handle all possible text deletions. 
    Clarify the Unicode terminology used in this specification, and move
    section 4.5.4 downwards to section 4.7 to improve reading
    order.</p> (MDR)
    </div><h4>Version 0.5 (2012-07-22)</h4><div class="indent"><p>Minor corrections and clarifications.</p> (MDR)
    </div><h4>Version 0.4 (2012-07-20)</h4><div class="indent"><p>Spelling, grammar, and clarification edits, including section clarifications recommended from public discussion. Interop with XEP-0308 message correction.</p> (MDR)
    </div><h4>Version 0.3 (2012-06-07)</h4><div class="indent"><p>Edits recommended from public discussion.</p> (MDR)
    </div><h4>Version 0.2 (2012-03-18)</h4><div class="indent"><p>Lots of edits. Simplifications, improvements and corrections. Forward and backward compatible with version 0.1.</p> (MDR)
    </div><h4>Version 0.1 (2011-06-29)</h4><div class="indent"><p>Initial published version.</p> (psa)
    </div><h4>Version 0.0.3 (2011-06-25)</h4><div class="indent"><p>Third draft, recommended edits.</p> (MDR)
    </div><h4>Version 0.0.2 (2011-06-15)</h4><div class="indent"><p>Second draft.</p> (MDR)
    </div><h4>Version 0.0.1 (2011-02-21)</h4><div class="indent"><p>First draft.</p> (MDR)
    </div></div><hr /><p>END</p></body></html>
