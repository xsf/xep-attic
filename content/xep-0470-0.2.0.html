<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>XEP-0470: Pubsub Attachments</title><style type="text/css">
/* don't mind this hack */
nav#toc h2:before {
display: none;
content: "XEP-0470";
}
        </style><link rel="stylesheet" type="text/css" href="xmpp.css"><link href="prettify.css" type="text/css" rel="stylesheet"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><script type="text/javascript" src="prettify.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0"><meta name="DC.Title" content="Pubsub Attachments"><meta name="DC.Creator" content="JÃ©rÃ´me Poisson"><meta name="DC.Description" content="This specification provides a way to attach elements to a pubsub item."><meta name="DC.Publisher" content="XMPP Standards Foundation"><meta name="DC.Contributor" content="XMPP Extensions Editor"><meta name="DC.Date" content="2022-08-25"><meta name="DC.Type" content="XMPP Extension Protocol"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="XEP-0470"><meta name="DC.Language" content="en"><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright Â© 1999 â€“ 2020 by the XMPP Standards Foundation (XSF)."></head><body onload="prettyPrint()"><h1>XEP-0470: Pubsub Attachments</h1><div class="docmeta-wrap"><dl id="docmeta" class="compact"><dt>Abstract</dt><dd>This specification provides a way to attach elements to a pubsub item.</dd><dt>Author</dt><dd>JÃ©rÃ´me Poisson</dd><dt>Copyright</dt><dd>Â© 1999 â€“ 2021 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</dd><dt>Status</dt><dd><p>Experimental</p><div id="status-notice" class="experimental standards track">WARNING: This Standards-Track document is Experimental. Publication as an XMPP Extension Protocol does not imply approval of this proposal by the XMPP Standards Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems are advised to carefully consider whether it is appropriate to deploy implementations of this protocol before it advances to a status of Draft.</div></dd><dt>Type</dt><dd>Standards Track</dd><dt>Version</dt><dd>0.2.0 (2022-08-25)</dd></dl><div class="timeline-wrap"><div class="timeline-head">Document Lifecycle</div><ol class="timeline"><li class="current">Experimental</li><li>Proposed</li><li>Stable</li><li>Final</li></ol></div></div><nav id="toc"><a href="#top"><h2>Table of Contents</h2></a><ol class="toc"><li><a href="#intro">Introduction</a></li><li><a href="#reqs">Requirements</a></li><li><a href="#glossary">Glossary</a></li><li><a href="#usecases">Use Cases</a><ol><li><a href="#basic">Basic Usage</a><ol><li><a href="#sect-idm126">Explanations</a></li></ol></li><li><a href="#full-compliance">Full-Compliance</a></li><li><a href="#auto-create">Automatic Node Creation</a></li><li><a href="#node-creation-rejection">Manual Node Creation Rejection</a></li><li><a href="#validity-check">Checking Validity of Attachments Items</a></li><li><a href="#summary-node">Summary Node</a></li><li><a href="#noticed">Noticed Attachment</a><ol><li><a href="#noticed-foreword">Foreword: "noticed" instead of "like" or "favourite"</a></li><li><a href="#noticed_overview">Attachment Overview</a></li><li><a href="#noticed_summarizing">Summarizing</a></li></ol></li><li><a href="#reactions">Reactions Attachment</a><ol><li><a href="#reactions_overview">Attachment Overview</a></li><li><a href="#reactions_summarizing">Summarizing</a></li></ol></li></ol></li><li><a href="#rules">Business Rules</a></li><li><a href="#disco">discovering support</a></li><li><a href="#security">Security Considerations</a></li><li><a href="#iana">IANA Considerations</a></li><li><a href="#registrar">XMPP Registrar Considerations</a></li><li><a href="#schema">XML Schema</a></li></ol><h6><a href="#appendices">Appendices</a></h6><ol class="toc-appendices"><li><a href="#appendix-docinfo">Document Information</a></li><li><a href="#appendix-authorinfo">Author Information</a></li><li><a href="#appendix-legal">Legal Notices</a></li><li><a href="#appendix-xmpp">Relation to XMPP</a></li><li><a href="#appendix-discuss">Discussion Venue</a></li><li><a href="#appendix-conformance">Requirements Conformance</a></li><li><a href="#appendix-notes">Notes</a></li><li><a href="#appendix-revs">Revision History</a></li><li><a href="#appendix-biblatex">Bib(La)Tex Entry</a></li></ol></nav><h2 id="intro">1.
       Introduction<a class="anchor-link" href="#intro"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
    <p class="" style="">It is nowadays common to attach informations to messages or other items in various social networks: famous example are "like" (or "favourite") and "reactions" features.</p>
    <p class="" style="">While there are ways to attach informations to &lt;message/&gt; stanzas with extensions such as <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0422.html">Message Fastening (XEP-0422)</a></span>  [<a href="#nt-idm58">2</a>] or <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0444.html">Message Reactions (XEP-0444)</a></span>  [<a href="#nt-idm39">1</a>], this is not the case for pubsub items</p>
    <p class="" style="">Some software use comments as a work-around for <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0277.html">Microblogging Over XMPP (XEP-0277)</a></span>  [<a href="#nt-idm67">3</a>], by posting a single "â™¥" character to notify a "like". This has the advantage to work out of the box even if no specific implementation is done to manage this, but this has a couple of disadvantages:</p>
    <ul class="" style="">
        <li class="" style="">it only works with <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0277.html">Microblogging Over XMPP (XEP-0277)</a></span>  [<a href="#nt-idm67">3</a>], it is not possible to like other kind of items;</li>
        <li class="" style="">it's polluting comments with an information which should be separated;</li>
        <li class="" style="">it doesn't handle uniqueness: a "like" should be doable only once per entity, but by using comments one can like thousand of times, and it's the receiving client which must ignore duplicates;</li>
        <li class="" style="">it doesn't scale: if thousand of people like a blog post, all comments must be retrieved and counted;</li>
        <li class="" style="">it's mixing metadata and content intended for human user;</li>
        <li class="" style="">this behaviour is found in the wild, but not standardized anywhere;</li>
    </ul>
    <p class="" style="">This XEP proposes an alternative and generic solution, which can work with any kind of pubsub item.</p>
<h2 id="reqs">2.
       Requirements<a class="anchor-link" href="#reqs"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
  <p class="" style="">The design goal of this XEP are:</p>
  <ul class="" style="">
      <li class="" style="">work with any kind of pubsub item, not only <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0277.html">Microblogging Over XMPP (XEP-0277)</a></span>  [<a href="#nt-idm67">3</a>]</li>
      <li class="" style="">handle uniqueness of attachment per JID</li>
      <li class="" style="">have an extensible mechanism for future use</li>
      <li class="" style="">re-use pubsub subscription and access control mechanism</li>
      <li class="" style="">suitable to implement feature similar to commonly seen "like/favourite" and "reactions".</li>
      <li class="" style="">optionally have a way to "group" or "summarize" informations: get a summary of all attachment without needing to retrieve each of them individually.</li>
  </ul>
  <p class="" style="">To facilitate the bootstrapping of this XEP, it is also designed to work in a basic way with generic pubsub service. However, some implementation work is necessary to offer the full potential of the XEP (and notably to be able to scale).</p>
<h2 id="glossary">3.
       Glossary<a class="anchor-link" href="#glossary"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
    <ul class="" style="">
        <li class="" style=""><strong>like/favourite</strong>: a common way to indicate interest in item</li>
        <li class="" style=""><strong>reactions</strong>: attaching one or more emoji(s) to an item</li>
        <li class="" style=""><strong>attachment node</strong>: node where attached data of an item are published</li>
        <li class="" style=""><strong>summary node</strong>: node managed by pubsub service which keep a summary of all attachment of target items</li>
        <li class="" style=""><strong>target item</strong>: item to which metadata is attached</li>
        <li class="" style=""><strong>target node</strong>: pubsub node where target items are published</li>
        <li class="" style=""><strong>attachment item</strong>: item of the attachment node containing attachments by a specific JID</li>
        <li class="" style=""><strong>summary item</strong>: item of the summary node linked to a target item</li>
        <li class="" style=""><strong>attachment</strong>: child element of the &lt;attachments&gt; element, describing a metadata attached to a target item</li>
    </ul>
<h2 id="usecases">4.
       Use Cases<a class="anchor-link" href="#usecases"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
    <div class="indent"><h3 id="basic">4.1 Basic Usage<a class="anchor-link" href="#basic"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
        <p class="" style="">Romeo wants to indicate to Juliet that he has noticed her post about the balcony restoration. This <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0277.html">Microblogging Over XMPP (XEP-0277)</a></span>  [<a href="#nt-idm67">3</a>] item has been published on the PEP service of Juliet at service juliet@capulet.lit on the node 'urn:xmpp:microblog:0' and the item has the ID 'balcony-restoration-afd1'.</p>
    <p class="" style="">To do so he publishes the following item to the suitable attachment node:</p>
  <figure class="code-example" id="example-1"><figcaption><strong>Example 1.</strong> Romeo Indicates To Juliet That He Has Noticed Her Publication<a class="anchor-link" href="#example-1"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
  &lt;iq from='romeo@montague.lit/123'
    id='attachment_1'
    to='juliet@capulet.lit'
    type='set'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;publish node='urn:xmpp:pubsub-attachments:1/xmpp:juliet@capulet.lit?;node=urn%3Axmpp%3Amicroblog%3A0;item=balcony-restoration-afd1'&gt;
      &lt;item id='romeo@montague.lit'&gt;
        &lt;attachments&gt;
          &lt;noticed timestamp="2022-07-11T12:07:24Z" /&gt;
        &lt;/attachments&gt;
      &lt;/item&gt;
    &lt;/publish&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></figure>
<p class="" style="">Few seconds later, Romeo reacts with some emojis, it does that with the following item, and his client takes care of keeping the &lt;noticed&gt; element above:</p>
  <figure class="code-example" id="example-2"><figcaption><strong>Example 2.</strong> Romeo Add Reactions To Juliet Publication<a class="anchor-link" href="#example-2"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
  &lt;iq from='romeo@montague.lit/123'
    id='attachment_2'
    to='juliet@capulet.lit'
    type='set'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;publish node='urn:xmpp:pubsub-attachments:1/xmpp:juliet@capulet.lit?;node=urn%3Axmpp%3Amicroblog%3A0;item=balcony-restoration-afd1'&gt;
      &lt;item id='romeo@montague.lit'&gt;
        &lt;attachments&gt;
          &lt;noticed timestamp="2022-07-11T12:07:24Z" /&gt;
          &lt;reactions timestamp="2022-07-11T12:07:48Z"&gt;
            &lt;reaction&gt;ðŸ‘·&lt;/reaction&gt;
            &lt;reaction&gt;ðŸ”¨&lt;/reaction&gt;
          &lt;/reactions&gt;
        &lt;/attachments&gt;
      &lt;/item&gt;
    &lt;/publish&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></figure>
      <div class="indent"><h4 id="sect-idm126">4.1.1 Explanations<a class="anchor-link" href="#sect-idm126"><abbr title="Link to this point in the document">Â¶</abbr></a></h4>
        <p class="" style="">To attach metadata to a pubsub item, an "attachment node" MAY be created, either by the publisher of the target item, or by the pubsub service if it is fully-compliant with this XEP (see below).
          This node name is generated by merging the following strings:</p>
          <ul class="" style="">
            <li class="" style="">the namespace '<strong>urn:xmpp:pubsub-attachments:1</strong>'</li>
            <li class="" style="">a slash "<strong>/</strong>"</li>
            <li class="" style="">the <strong>XMPP URI</strong> of the target item as explained at <a href="https://xmpp.org/extensions/xep-0060.html#impl-ur">XEP-0060 Â§ Pubsub URIs</a></li>
          </ul>
        <p class="" style="">Thus, in the example above, the node name to use for the item "balcony-restoration-afd1" of the node "urn:xmpp:microblog:0" located at PEP service "juliet@capulet.lit" is: "urn:xmpp:pubsub-attachments:1/xmpp:juliet@capulet.lit?;node=urn%3Axmpp%3Amicroblog%3A0;item=balcony-restoration-afd1"</p>
        <p class="" style="">This node SHOULD have the same access model than the target node.</p>
        <p class="" style="">To publish to this node, an entity MUST use its own bare JID for the ID of the item. It is both to keep the uniqueness of the item per JID and to make the retrieval of attachment for a particular entity easy.</p>
        <p class="" style="">The entity willing to publish attachment tries directly to publish to the above mentioned node. If the node doesn't exist (and is not created on the fly by the pubsub service, see below), the pubsub service SHOULD answer with &lt;item-not-found&gt; error as explained in <a href="https://xmpp.org/extensions/xep-0060.html#publisher-publish-error-node">XEP-0060 Â§7.1.3.3 Node Does Not Exist</a>. If the node doesn't not exist, that means that it's not possible to attach metadata to the target item, the entity willing to publish the attachment MUST NOT try to create the node itself (that would result in wrong ownership of the node).</p>
        <p class="" style="">An attachment payload is build with a top level &lt;attachments&gt; element which has zero, one or more child elements. This specification defines 2 child elements, &lt;noticed&gt; and &lt;reactions&gt;, but future XEPs may add their own elements qualified by their own namespaces to extend the functionalities. Each child element MAY have an optional 'timestamp' attribute indicating when the element has been attached. The value of this attribute is a DateTime as specified in <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0082.html">XMPP Date and Time Profiles (XEP-0082)</a></span>  [<a href="#nt-idm144">4</a>].</p>
        <p class="" style="">Because there is one item per JID; to update, add or remove attachments an entity simply re-publish an item on the same node with its bare JID as ID. It is the responsibility of the publishing entity to republish all previously existing attachments (except those who need to be removed). If an XMPP client doesn't know a specific attachment, it MUST keep it and republish it when updating attachments.</p>
        <p class="" style="">All attachments of a specific JID can be deleted at once by retracting the item as specified at <a href="https://xmpp.org/extensions/xep-0060.html#publisher-delete">XEP-0060 Â§7.2 Delete an Item from a Node</a>. A client SHOULD NOT retract an attachment item if there are attachments it doesn't know, instead it SHOULD publish a new attachment item without the attachments which must be removed, and with the unknown attachments left in place.</p>
      </div> 
    </div>

    <div class="indent"><h3 id="full-compliance">4.2 Full-Compliance<a class="anchor-link" href="#full-compliance"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
      <p class="" style="">Previous section describes the basic usage of pubsub attachments, which works with generic pubsub service. However, even if it works out of the box, it relies on the goodwill of entities: an attacker or simply a bugged implementation could publish an item with wrong ID or somebody else bare JID, an item publisher client could miss the creation of attachment node, or give it bad access model, access model between attachment node and target node can become out of sync, etc.</p>
      <p class="" style="">To avoid these flaws, a pubsub service SHOULD implement the features described in this and following sections. If a pubsub service does so, it is said to be fully-compliant with pubsub attachments, and then and only then it can advertises the feature with <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0030.html">Service Discovery (XEP-0030)</a></span>  [<a href="#nt-idm154">5</a>]</p>
      <p class="" style="">To be fully compliant, a PEP or pubsub service MUST implement the following features, which are explained in details below:</p>
      <ul class="" style="">
        <li class="" style="">auto-create attachment node, and keep its publish_model and access_model synchronized</li>
        <li class="" style="">forbid manual creation of attachment or summary node</li>
        <li class="" style="">check validity of items published to attachment node, and notably the item ID</li>
        <li class="" style="">create and maintain a summary node</li>
        <li class="" style="">handle &lt;noticed&gt; and &lt;reactions&gt; attachments</li>
      </ul>
    </div>

    <div class="indent"><h3 id="auto-create">4.3 Automatic Node Creation<a class="anchor-link" href="#auto-create"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
      <p class="" style="">When an attachments item is published to a fully-compliant pubsub service, and if the attachment node doesn't exist, the service MUST create automatically the node as explained at <a href="https://xmpp.org/extensions/xep-0060.html#publisher-publish-autocreate">XEP-0060 Â§7.1.4 Automatic Node Creation</a>, except that instead of applying the default configuration, it MUST apply the same access_model and publish_model as for the target node. The service MAY also copy other configuration options if they differ from default, it is up to the implementation to decide which other options are relevant to copy.</p>
      <p class="" style="">If the &lt;iq/&gt; stanza of the publishing client includes publishing options as explained in <a href="https://xmpp.org/extensions/xep-0060.html#publisher-publish-options">XEP-0060 Â§ 7.1.5 Publishing Options</a>, they are ignored.</p>
      <p class="" style="">If later the target node configuration is updated and either access_model or pubsub_model are modified, the fully-compliant service MUST also update the attachment node pubsub_model and access_model accordingly.</p>
    </div>

    <div class="indent"><h3 id="node-creation-rejection">4.4 Manual Node Creation Rejection<a class="anchor-link" href="#node-creation-rejection"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
      <p class="" style="">If any user, including owner of target node or publisher of target item, tries to create manually an attachment node or a summary node, a fully-compliant service MUST reject it by returning a &lt;not-allowed/&gt; error.</p>
      <p class="" style="">A client can see if a node creation is necessary by using <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0030.html">Service Discovery (XEP-0030)</a></span>  [<a href="#nt-idm154">5</a>]: the presence of 'urn:xmpp:pubsub-attachments:1' feature in <em>disco#info</em> means that the service is fully-compliant, and that manual node creation MUST NOT be done.</p>
    </div>

    <div class="indent"><h3 id="validity-check">4.5 Checking Validity of Attachments Items<a class="anchor-link" href="#validity-check"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
      <p class="" style="">When an entity publish an items with attachments to an attachment node, a fully-compliant service MUST check that the item is valid by</p>
      <ol start="" class="" style="">
        <li class="" style="">Verifying that the item ID is equal to the bare jid of the item publisher</li>
        <li class="" style="">Verifying that the root element of the payload is an &lt;attachments&gt; element qualified by the 'urn:xmpp:pubsub-attachments:1' namespace</li>
      </ol>
      <p class="" style="">If any of these points are not met, the service MUST reject the item by returning a &lt;bad-request/&gt; error.</p>
      <p class="" style="">In addition to those 2 mandatory checks, a pubsub service MAY add implementation specific checks.</p>
    </div>

    <div class="indent"><h3 id="summary-node">4.6 Summary Node<a class="anchor-link" href="#summary-node"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
      <p class="" style="">As soon as a first attachment is received, a fully-compliant pubsub service MUST create a "summary node". A summary node is a node maintained by the service which group all attachments of a kind, allowing client to have a good overview of the data without needing to retrieve individually all items of the attachment nodes of all target items.</p>
      <p class="" style="">A summary node has the same access_model as the attachment node, but nobody is allowed to publish directly to it. The summary node is linked to the target node, and its name is made by joining the following element:</p>
      <ol start="" class="" style="">
        <li class="" style="">the '<strong>urn:xmpp:pubsub-attachments:summary:1</strong>' prefix</li>
        <li class="" style="">a slash "<strong>/</strong>"</li>
        <li class="" style="">the <strong>name of the target node</strong></li>
      </ol>
      <p class="" style="">Thus in the initial example, for the blog of Juliet, the summary node name would be 'urn:xmpp:pubsub-attachments:summary:1/urn:xmpp:microblog:0' and it would be located at the PEP service juliet@capulet.lit.</p>
      <p class="" style="">For each item of the target node which has attachments, the summary node MUST contain an item which MUST have the same ID. This item contain a &lt;summary&gt; element qualified with the namespace 'urn:xmpp:pubsub-attachments:summary:1'. This item has elements with names matching attachments elements names, and a summary data which depend of the attachment. This specifications explain below how to summarize &lt;noticed&gt; and &lt;reactions&gt; attachments, it is the up to other XEPs specifying other features to explain how to summarize their own attachments. If a service doesn't know how to summarize an attachment, it SHOULD ignore it.</p>
      <p class="" style="">If a target item has no attachment at all, or if all attachments have been removed, the node MAY either return an &lt;item-not-found&gt; error, or an empty &lt;summary&gt; element, whatever is simpler for the service implementation.</p>
      <p class="" style="">Summary node subscriptions are working as for normal pubsub nodes: when a new attachment is published, resulting in the corresponding summary item updated, an event is sent with the new item to every subscribers.</p>
  <figure class="code-example" id="example-3"><figcaption><strong>Example 3.</strong> Romeo Check Summary of Attachments of Juliet Blog<a class="anchor-link" href="#example-3"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
  &lt;iq from='romeo@montague.lit/123'
    id='attachment_3'
    to='juliet@capulet.lit'
    type='get'&gt;
    &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
      &lt;items node='urn:xmpp:pubsub-attachments:summary:1/urn:xmpp:microblog:0' /&gt;
    &lt;/pubsub&gt;
  &lt;/iq&gt;
  </pre></figure>
  <figure class="code-example" id="example-4"><figcaption><strong>Example 4.</strong> Fully-Compliant Pubsub Service Returns Summary Items<a class="anchor-link" href="#example-4"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
  &lt;iq from='juliet@capulet.lit'
    id='attachment_3'
    to='romeo@montague.lit/123'
    type='result'&gt;
    &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
      &lt;items node='urn:xmpp:pubsub-attachments:summary:1/urn:xmpp:microblog:0'&gt;
        &lt;item id='balcony-restoration-afd1'&gt;
          &lt;summary xmlns='urn:xmpp:pubsub-attachments:summary:1'&gt;
            &lt;noticed count="5" /&gt;
            &lt;reactions&gt;
              &lt;reaction count="2"&gt;ðŸ‘·&lt;/reaction&gt;
              &lt;reaction&gt;ðŸ”¨&lt;/reaction&gt;
              &lt;reaction&gt;ðŸ”§&lt;/reaction&gt;
              &lt;reaction&gt;ðŸš§&lt;/reaction&gt;
            &lt;/reactions&gt;
          &lt;/summary&gt;
        &lt;/item&gt;
        &lt;!-- ... --&gt;
      &lt;/items&gt;
    &lt;/pubsub&gt;
  &lt;/iq&gt;
  </pre></figure>
    </div>

    <div class="indent"><h3 id="noticed">4.7 Noticed Attachment<a class="anchor-link" href="#noticed"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
      <div class="indent"><h4 id="noticed-foreword">4.7.1 Foreword: "noticed" instead of "like" or "favourite"<a class="anchor-link" href="#noticed-foreword"><abbr title="Link to this point in the document">Â¶</abbr></a></h4>
        <p class="" style="">The &lt;noticed&gt; feature described here is similar to what is most often known as "like", and sometime "favourite". It has been decided to use "noticed" word to highlight a different spirit from its ancestors.</p>
        <p class="" style="">The "like" feature has been invented in mid 2000s on commercial social network. Over the years, this functionality has proven to be a borderline toxic problem. Among known issues, we can mention:</p>
        <ul class="" style="">
          <li class="" style="">It may cause addictive behaviour, people feeling need to get more "likes".</li>
          <li class="" style="">In contrast, the lack of like on a publication may lead to feelings of depression.</li>
          <li class="" style="">It is used as a marketing tool, to spy user tastes and interests. It can even be used to discover political orientation, sexual preferences or religious beliefs, which can be dangerous in some countries/locations.</li>
          <li class="" style="">It tend to diminish the quality of contents, by favoring metrics over contents themselves.</li>
          <li class="" style="">In some social networks, more likes means more visibility and having a better image, resulting in some people/organizations/companies buying fake likes.</li>
          <li class="" style="">The word "like" is ill-suited to bad news or dramatics events, when someone simply wants to show their support or empathy.</li>
        </ul>
        <p class="" style="">For all these reasons, it has been decided to use the word "noticed" which reflect better the way it is used by some people (notably observed on some social network built on top of the ActivityPub protocol): it is then used as way to say "I have seen" or "I've taken that into account".</p>
        <p class="" style="">However, and for compatibly reason with other protocols (especially to have the tools to make gateways), the summary feature of &lt;noticed&gt; attachment does count the number of elements. After reading this note, it is up to the various implementations to decide whether to show this number prominently, inconspicuously, or not at all.</p>
      </div>
      <div class="indent"><h4 id="noticed_overview">4.7.2 Attachment Overview<a class="anchor-link" href="#noticed_overview"><abbr title="Link to this point in the document">Â¶</abbr></a></h4>
        <p class="" style="">&lt;noticed&gt; element is attached by an entity to say that they have seen or taken into account something. On the client UI side, it is often published when user push a simple button or icon, and the attachment is often visible with the same icon displayed on the noticed item. If an icon is used, it is recommended to use something as neutral as possible, thus a heart icon SHOULD NOT be used to avoid misunderstanding between various implementations (also see <a href="#noticed-foreword">foreword</a> above). As for any attachment, an optional "timestamp" attribute MAY be set with a value of latest publication DateTime as specified in <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0082.html">XMPP Date and Time Profiles (XEP-0082)</a></span>  [<a href="#nt-idm144">4</a>].</p>


      </div>
      <div class="indent"><h4 id="noticed_summarizing">4.7.3 Summarizing<a class="anchor-link" href="#noticed_summarizing"><abbr title="Link to this point in the document">Â¶</abbr></a></h4>
        <p class="" style="">To summarize &lt;noticed&gt; attachments, a fully-compliant pubsub service just sum-up the total number of &lt;noticed&gt; elements found for the item, and put this number in "count" attribute of the summary  &lt;noticed&gt; element. In the example below, an item has been noticed 25 times.</p>

  <figure class="code-example" id="example-5"><figcaption><strong>Example 5.</strong> Example of Noticed Attachment Summary<a class="anchor-link" href="#example-5"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
  &lt;iq from='pubsub.example.net'
    id='attachment_4'
    to='juliet@capulet.lit/123'
    type='result'&gt;
    &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
      &lt;items node='urn:xmpp:pubsub-attachments:summary:1/urn:xmpp:example:0'&gt;
        &lt;item id='ball-event-ab1e'&gt;
          &lt;summary xmlns='urn:xmpp:pubsub-attachments:summary:1'&gt;
            &lt;noticed count="25" /&gt;
          &lt;/summary&gt;
        &lt;/item&gt;
      &lt;/items&gt;
    &lt;/pubsub&gt;
  &lt;/iq&gt;
  </pre></figure>
      </div>

    </div>

    <div class="indent"><h3 id="reactions">4.8 Reactions Attachment<a class="anchor-link" href="#reactions"><abbr title="Link to this point in the document">Â¶</abbr></a></h3>
      <div class="indent"><h4 id="reactions_overview">4.8.1 Attachment Overview<a class="anchor-link" href="#reactions_overview"><abbr title="Link to this point in the document">Â¶</abbr></a></h4>
        <p class="" style="">&lt;reactions&gt; element lets an entity attach various emojis to an item. Each emoji is put as the content of a single &lt;reaction&gt; element, and a client SHOULD ensure that any &lt;reaction&gt; element only appears once at most. As for any attachment, a "timestamp" attribute may be set with the DateTime of latest publication to the root &lt;reactions&gt; element. The protocol is similar to <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0444.html">Message Reactions (XEP-0444)</a></span>  [<a href="#nt-idm39">1</a>] which is used for &lt;message/&gt; stanza.</p>


      </div>
      <div class="indent"><h4 id="reactions_summarizing">4.8.2 Summarizing<a class="anchor-link" href="#reactions_summarizing"><abbr title="Link to this point in the document">Â¶</abbr></a></h4>
        <p class="" style="">To summarize &lt;reactions&gt; attachments, a fully-compliant pubsub service counts how many times each emoji is attached, ignoring duplicate from the same JID if any. If an emoji appears multiple times (from distinct bare JIDs), a 'count' attribute MUST be added to the &lt;reaction&gt; element with the number of time this reaction appear in all reactions as a value (if the same reaction appears several times for a single bare JID, it MUST be counted only once).</p>
        <p class="" style="">In following example, all emojis are attached only once to the item, except the woman dancing one which appears 22 times and the ballet shoes one which appears twice.</p>

  <figure class="code-example" id="example-6"><figcaption><strong>Example 6.</strong> Example of reactions Attachment Summary<a class="anchor-link" href="#example-6"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
  &lt;iq from='pubsub.example.net'
    id='attachment_5'
    to='juliet@capulet.lit/123'
    type='result'&gt;
    &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
      &lt;items node='urn:xmpp:pubsub-attachments:summary:1/urn:xmpp:example:0'&gt;
        &lt;item id='ball-event-ab1e'&gt;
          &lt;summary xmlns='urn:xmpp:pubsub-attachments:summary:1'&gt;
            &lt;reactions&gt;
              &lt;reaction count="22"&gt;ðŸ’ƒ&lt;/reaction&gt;
              &lt;reaction count="2"&gt;ðŸ©°&lt;/reaction&gt;
              &lt;reaction&gt;ðŸŽ‰&lt;/reaction&gt;
              &lt;reaction&gt;ðŸ¥³&lt;/reaction&gt;
              &lt;reaction&gt;ðŸŽˆ&lt;/reaction&gt;
            &lt;/reactions&gt;
          &lt;/summary&gt;
        &lt;/item&gt;
      &lt;/items&gt;
    &lt;/pubsub&gt;
  &lt;/iq&gt;
  </pre></figure>
      </div>

    </div>
<h2 id="rules">5.
       Business Rules<a class="anchor-link" href="#rules"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
  <ul class="" style="">
    <li class="" style="">Similarly to "like" in commercial software, the "noticed" attachment can be used to analyse user's tastes, political view, religious beliefs, sexual orientation, etc. It is recommended that implementers post a prominent notice warning users of potential abuses.</li>
    <li class="" style="">Emoji pictures may differ widely on various platforms where they are displayed. This has already led to misunderstanding of reactions, as a slightly different picture can be interpreted in a completely different way from what the reactions author meant. Here again, a prominent notice in implementations warning user is recommended.</li>
    <li class="" style="">As "reactions" attachment is similar to <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0444.html">Message Reactions (XEP-0444)</a></span>  [<a href="#nt-idm39">1</a>] which is used for &lt;message/&gt; stanza, non &lt;message/&gt; related <a href="https://xmpp.org/extensions/xep-0444.html#rules">business rules from there</a> apply for this attachment too. Notably:
    <p class="" style="">
      <em>
        A &lt;reaction&gt; element SHOULD only contain Unicode codepoints that
        can be displayed as a single emoji, as specified in the latest revision
        of the <a href="http://www.unicode.org/reports/tr51/">Unicode Technical Standard #51</a>  [<a href="#nt-idm247">6</a>].
    Receiving entities MAY ignore &lt;reaction&gt; elements that do not comply
    with this specification.
      </em>
    </p>
  </li>
  </ul>
<h2 id="disco">6.
       discovering support<a class="anchor-link" href="#disco"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
  <p class="" style="">If and only if a PEP or pubsub service is fully-compliant with the "Pubsub Attachments" protocol (as explained in <a href="full-compliance">Full-Compliance section</a>), it MUST advertise that fact by including the "urn:xmpp:pubsub-attachments:1" discovery feature in response to a <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0030.html">Service Discovery (XEP-0030)</a></span>  [<a href="#nt-idm154">5</a>] information request:</p>
  <figure class="code-example" id="example-7"><figcaption><strong>Example 7.</strong> service discovery information request<a class="anchor-link" href="#example-7"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq from='example.org'
    id='disco1'
    to='example.com'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
</pre></figure>
  <figure class="code-example" id="example-8"><figcaption><strong>Example 8.</strong> service discovery information response<a class="anchor-link" href="#example-8"><abbr title="Link to this point in the document">Â¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq from='example.com'
    id='disco1'
    to='example.org'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    â€¦
    &lt;feature var='urn:xmpp:pubsub-attachments:1'/&gt;
    â€¦
  &lt;/query&gt;
&lt;/iq&gt;
</pre></figure>
<h2 id="security">7.
       Security Considerations<a class="anchor-link" href="#security"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
  <p class="" style="">TODO</p>
<h2 id="iana">8.
       IANA Considerations<a class="anchor-link" href="#iana"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
  <p class="" style="">TODO</p>
<h2 id="registrar">9.
       XMPP Registrar Considerations<a class="anchor-link" href="#registrar"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
  <p class="" style="">TODO</p>
<h2 id="schema">10.
       XML Schema<a class="anchor-link" href="#schema"><abbr title="Link to this point in the document">Â¶</abbr></a></h2>
  <p class="" style="">TODO</p>
<hr><a name="appendices"></a><h2>Appendices</h2><h3 id="appendix-docinfo">Appendix A: Document Information<a class="anchor-link" href="#appendix-docinfo"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><dl class="compact"><dt>Series</dt><dd><a href="https://xmpp.org/extensions/">XEP</a></dd><dt>Number</dt><dd>0470</dd><dt>Publisher</dt><dd><a href="/xsf/">XMPP Standards Foundation</a></dd><dt>Status</dt><dd><a href="https://xmpp.org/extensions/xep-0001.html#states-Experimental">Experimental</a></dd><dt>Type</dt><dd><a href="https://xmpp.org/extensions/xep-0001.html#types-Standards%20Track">Standards Track</a></dd><dt>Version</dt><dd>0.2.0</dd><dt>Last Updated</dt><dd>2022-08-25</dd><dt>Approving Body</dt><dd><a href="https://xmpp.org/council/">XMPP Council</a></dd><dt>Dependencies</dt><dd>XMPP Core, <a href="xep-0001.html">XEP-0001</a>, <a href="xep-0060.html">XEP-0060</a></dd><dt>Supersedes</dt><dd>None</dd><dt>Superseded By</dt><dd>None</dd><dt>Short Name</dt><dd>pubsub-attachments</dd><dt>Source Control</dt><dd><a class="standardsButton" href="https://github.com/xsf/xeps/blob/master/xep-0470.xml">HTML</a></dd></dl><p>
          This document in other formats:
          <a class="standardsButton" href="https://xmpp.org/extensions/xep-0470.xml">XML</a>Â 
          <a class="standardsButton" href="https://xmpp.org/extensions/xep-0470.pdf">PDF</a></p><h3 id="appendix-authorinfo">Appendix B: Author Information<a class="anchor-link" href="#appendix-authorinfo"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><h5>JÃ©rÃ´me Poisson</h5><dl class="compact"><dt>Email</dt><dd><a href="mailto:goffi@goffi.org">goffi@goffi.org</a></dd><dt>JabberID</dt><dd><a href="xmpp:goffi@jabber.fr">goffi@jabber.fr</a></dd></dl><h3 id="appendix-legal">Appendix C: Legal Notices<a class="anchor-link" href="#appendix-legal"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><div class="indent"><h4>Copyright</h4><p>This XMPP Extension Protocol is copyright Â© 1999 â€“ 2020 by the <a href="https://xmpp.org/">XMPP Standards Foundation</a> (XSF).</p><h4>Permissions</h4><p>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.</p><h4>Disclaimer of Warranty</h4><p class="box info">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</p><h4>Limitation of Liability</h4><p>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.</p><h4>IPR Conformance</h4><p>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="https://xmpp.org/about/xsf/ipr-policy">https://xmpp.org/about/xsf/ipr-policy</a>&gt; or obtained by writing to XMPP Standards Foundation, P.O. Box 787, Parker, CO 80134 USA).</p><h4>Visual Presentation</h4><p>The HTML representation (you are looking at) is maintained by the XSF. It is based on the <a href="http://yaml.de">YAML CSS Framework</a>, which is licensed under the terms of the <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY-SA 2.0</a> license.</p></div><h3 id="appendix-xmpp">Appendix D: Relation to XMPP<a class="anchor-link" href="#appendix-xmpp"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><h3 id="appendix-discuss">Appendix E: Discussion Venue<a class="anchor-link" href="#appendix-discuss"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="https://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="https://xmpp.org/about/discuss.shtml">https://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><h3 id="appendix-conformance">Appendix F: Requirements Conformance<a class="anchor-link" href="#appendix-conformance"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><h3 id="appendix-notes">Appendix G: Notes<a class="anchor-link" href="#appendix-notes"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><div class="indent"><p><a name="nt-idm39">1</a>. XEP-0444: Message Reactions &lt;<a href="https://xmpp.org/extensions/xep-0444.html">https://xmpp.org/extensions/xep-0444.html</a>&gt;.</p><p><a name="nt-idm58">2</a>. XEP-0422: Message Fastening &lt;<a href="https://xmpp.org/extensions/xep-0422.html">https://xmpp.org/extensions/xep-0422.html</a>&gt;.</p><p><a name="nt-idm67">3</a>. XEP-0277: Microblogging over XMPP &lt;<a href="https://xmpp.org/extensions/xep-0277.html">https://xmpp.org/extensions/xep-0277.html</a>&gt;.</p><p><a name="nt-idm144">4</a>. XEP-0082: XMPP Date and Time Profiles &lt;<a href="https://xmpp.org/extensions/xep-0082.html">https://xmpp.org/extensions/xep-0082.html</a>&gt;.</p><p><a name="nt-idm154">5</a>. XEP-0030: Service Discovery &lt;<a href="https://xmpp.org/extensions/xep-0030.html">https://xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-idm247">6</a>. Unicode Technical Standard #51 &lt;<a href="http://www.unicode.org/reports/tr51/">http://www.unicode.org/reports/tr51/</a>&gt;.</p></div><h3 id="appendix-revs">Appendix H: Revision History<a class="anchor-link" href="#appendix-revs"><abbr title="Link to this point in the document">Â¶</abbr></a></h3><p>Note: Older versions of this specification might be available at <a href="https://xmpp.org/extensions/attic/">https://xmpp.org/extensions/attic/</a></p><ol class="revision-history"><li id="revision-history-v0.2.0"><div class="revision-head">Version <a href="https://xmpp.org/extensions/attic/xep-0470-0.2.0.html">0.2.0</a> (2022-08-25)<a class="anchor-link" href="#revision-history-v0.2.0"><abbr title="Link to this point in the document">Â¶</abbr></a></div>
      <ul class="" style="">
          <li class="" style="">
              Update reactions to be similar to <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0444.html">Message Reactions (XEP-0444)</a></span>  [<a href="#nt-idm39">1</a>]
          </li>
          <li class="" style="">
              Namespace bump
          </li>
      </ul>
  <div class="revision-author">jp</div></li><li id="revision-history-v0.1.0"><div class="revision-head">Version <a href="https://xmpp.org/extensions/attic/xep-0470-0.1.0.html">0.1.0</a> (2022-08-23)<a class="anchor-link" href="#revision-history-v0.1.0"><abbr title="Link to this point in the document">Â¶</abbr></a></div>Accepted by vote of Council on 2022-07-27.<div class="revision-author">XEP Editor (jsc)</div></li><li id="revision-history-v0.0.1"><div class="revision-head">Version <a href="https://xmpp.org/extensions/attic/xep-0470-0.0.1.html">0.0.1</a> (2022-07-11)<a class="anchor-link" href="#revision-history-v0.0.1"><abbr title="Link to this point in the document">Â¶</abbr></a></div><p class="" style="">First draft.</p><div class="revision-author">jp</div></li></ol><h3 id="appendix-biblatex">Appendix I: Bib(La)TeX Entry</h3><pre>
@report{poisson2022pubsub-attachments,
  title = {Pubsub Attachments},
  author = {Poisson, JÃ©rÃ´me},
  type = {XEP},
  number = {0470},
  version = {0.2.0},
  institution = {XMPP Standards Foundation},
  url = {https://xmpp.org/extensions/xep-0470.html},
  date = {2022-07-11/2022-08-25},
}</pre><p>END</p></body></html>
